var Util=function(){};Util.InitCarInfo=function(e){Util.mapCarInfo=new Map,Util.arrCarInfo=[],cc.loader.loadRes("carModel",function(r,t){for(var n=0;n<t.json.car.length;n++){var i=t.json.car[n];i.desc=i.descs[e],Util.mapCarInfo.set(i.model,i),Util.arrCarInfo.push(i)}})},Util.GetCarModelInfo=function(e){return Util.mapCarInfo.get(e)},Util.GetCarModelCount=function(){return Util.arrCarInfo.length},Util.GetCarModelInfoByIndex=function(e){return Util.arrCarInfo[e]},Util.GetUserGradeString=function(e){return LocalizeMng.GetText("txt_user_grade_"+e)},Util.FormatTime=function(e){var r=!1;e<0&&(e=Math.abs(e),r=!0);var t=Math.floor(e%3600/60)+"'"+(e%60).toFixed(3);return r&&(t="-"+t),t},Util.FormatTimeDiff=function(e){var r=Util.FormatTime(e);return e>0&&(r="+"+r),r},Util.Lerp=function(e,r,t){return e+(r-e)*(t=(t=t<0?0:t)>1?1:t)},Util.ParseCarModel_Season=function(e){return Math.floor(e/1e3)},Util.ParseCarModel_Grade=function(e){return Math.floor(e%1e3/100)},Util.ParseCarModel_Seq=function(e){return Math.floor(e%100)},Util.LoadTexture_Car=function(e,r,t,n,i,a){var o="";t==Def.CarImageType_Top()?(o=Def.ResrcPath_CarTopImg()+String(r)+"_"+String(n),i==Def.CarImageShape_Crash1()?o+="_c1":i==Def.CarImageShape_Crash2()&&(o+="_c2")):t==Def.CarImageType_Side()&&(o=Def.ResrcPath_CarSideImg()+String(r)+"_"+String(n)+"_side"),null!==a&&void 0!==a&&(a.active=!0),null!=e.spriteFrame&&(e.spriteFrame.active=!1),cc.loader.loadRes(o,function(r,t){e.spriteFrame=new cc.SpriteFrame(t),null!==a&&void 0!==a&&(a.active=!1),null!=e.spriteFrame&&(e.spriteFrame.active=!0)})},Util.GenerateEventCar=function(e){var r=e.requiredCarModel,t=Util.GetCarModelInfo(r),n=new Object;return n.owner=BCDUser.AccountName(),n.id=0,n.model=r,n.speed=Number(t.speed),n.color=0,n.level=1,n.winCount=0,n.marketKey=0,n},Util.ParseTokenSymbol=function(e){if(null==e||void 0==e)return"0.0000 EOS";var r=e.substring(0,e.length-4);return Number(r)},Util.MakeTokenSymbol=function(e){return e<0?"":e.toFixed(4)+" "+TOKEN_SYMBOL},Util.FormatTimeDate=function(e){var r=new Date(1e3*e);return r.getMonth()+1+"."+r.getDate()+"-"+r.getHours()+":"+r.getMinutes()},Util.FormatTimeLeft=function(e,r,t){if(e<0)return LocalizeMng.GetText("txt_time_out");var n=Math.floor(e/3600),i=Math.floor(e/60)%60,a=e%60;return r&&(a=Math.floor(a)),n<10&&(n="0"+n.toString()),i<10&&(i="0"+i.toString()),a<10&&(a="0"+a.toString()),t?n+":"+i+":"+a:n>0?n+":"+i+":"+a:i>0?i+":"+a:a},Util.CalcEventPrize=function(e,r,t){var n=0,i=Util.EventNeedEnterFee(e),a=e.grade==Def.EventGrade_Special_Trophy();if(!(0==i&&0==a&&e.prizeScopeCount>0)){if(a){if(r>0){var o=0;return 1==r?o=20:2==r?o=10:3==r?o=6:4==r||5==r?o=4:r>=6&&r<=10?o=2:r>=11&&r<=10+e.prizeScopeCount&&(o=1),e.prizeVar*o}return(54+e.prizeScopeCount)*e.prizeVar}var l=e.prizeAmount;if(e.grade==Def.EventGrade_Special_EnterFee_Acc()&&void 0!=t&&0==(l+=t*e.enterFeeOrTrophy))return LocalizeMng.GetText("txt_prize_accmulate");if(r>0){if(i)1==r?n=Def.EventPrizeRatio_EnterFee_1():2==r?n=Def.EventPrizeRatio_EnterFee_2():3==r&&(n=Def.EventPrizeRatio_EnterFee_3());else if(1==r)n=Def.EventPrizeRatio_1();else if(2==r)n=Def.EventPrizeRatio_2();else if(3==r)n=Def.EventPrizeRatio_3();else if(r>=4){var f=e.prizeType==Def.RewardType_Token()?Math.floor(.1*e.entryLimit):5;r<=f&&(n=e.prizeType==Def.RewardType_Token()?Def.EventPrizeRatio_ETC()/(f-3):.5*Def.EventPrizeRatio_ETC())}return n+=1e-7,Math.floor(l*n)}return l}var c=e.prizeScopeCount,u=10+c,d=u+c,s=d+c,p=s+c;if(e.prizeType==Def.RewardType_Token()){if(r>0){var v=e.prizeVar/1e4,C=2*v,_=2*C,g=2*_,m=1-(v+C+_+g);return 1==r?n=.35*m:2==r?n=.15*m:3==r?n=.11*m:r>=4&&r<=5?n=.07*m:r>=6&&r<=10?n=.05*m:r>10&&r<=u?n=g/c:r>u&&r<=d?n=_/c:r>d&&r<=s?n=C/c:r>s&&r<=p&&(n=v/c),n+=1e-7,Math.floor(e.prizeAmount*n)}return e.prizeAmount}if(e.prizeType==Def.RewardType_Piece()){var U=0;return r>0?r<=3?U=6:r<=10?U=5:r<=u?U=4:r<=d?U=3:r<=s?U=2:r<=p&&(U=1):U=53+10*e.prizeScopeCount,U}},Util.FormatEventPrize=function(e,r,t){if(e==Def.RewardType_Token()){if("string"==typeof r)return r;var n=String(r/1e4),i=n.indexOf(".");return i<n.length-5&&(n=n.substr(0,i+5)),n+" "+TOKEN_SYMBOL}return r=Math.floor(r),e==Def.RewardType_Piece()?0!=t&&void 0!=t?"T"+t+" Piece x "+r:"Piece x "+r:e==Def.RewardType_Fuel()?"Fuel x "+r:e==Def.RewardType_Car()?0!=t&&void 0!=t?"T"+t+" Car":"Car":void 0},Util.IsStringInteger=function(e){return!!/^[0-9.]*$/.test(e)},Util.AdjustScrollViewItems=function(e,r,t,n){var i=e.childrenCount;if(i>r)for(var a=r;a<i;a++)e.children[a].destroy();else if(i<r)for(a=i;a<r;a++){var o=cc.instantiate(n);o.x=o.y=0,o.parent=e}},Util.SetTransparentChildren=function(e){for(var r=0;r<e.childrenCount;r++)e.children[r].opacity=0},Util.SetGradeRes=function(e,r){for(var t=0;t<r.length;t++)r[t].node.active=t==e-1},Util.LoadTexture_CarPiece=function(e,r){var t=Def.ResrcPath_CarPieceImg()+String(r)+"_piece";cc.loader.loadRes(t,function(r,t){e.spriteFrame=new cc.SpriteFrame(t)})},Util.PadName=function(e,r,t){r.length>t?e.string=r.substr(0,t-1)+"..":e.string=r},Util.PadNumber=function(e,r){return(e+="").length>=r?e:new Array(r-e.length+1).join("0")+e},Util.PrintExpires=function(e,r){const t=[{},{r:228,g:105,b:5,a:255},{r:253,g:180,b:119,a:255},{r:255,g:255,b:255,a:255}];var n=(new Date).getTime()/1e3/60/60/24,i=r/1e3,a=Math.floor(n-i);a=Math.abs(a-20),e.node.active=!(a>3),a<=3&&(e.node.color=new cc.Color(t[a]),e.string=LocalizeMng.GetText("txt_expires_period")+Util.PadNumber(a,2))},Util.CheckPrice=function(e){return!(e<.001||null==e||void 0==e||isNaN(e))||(Def.uiMain.ShowToastPopupMsg("toastmsg_check_price"),!1)},Util.UserCarIsLastOne=function(){for(var e=0,r=0;r<BCDUser.GetCarCount();r++){0==BCDUser.GetCarInfo(r).marketKey&&e++}return e<=1},Util.CarNameByModel=function(e,r){var t=Util.GetCarModelInfo(e),n=String(t.name);return r>0&&n.length>r?n.substr(0,r-1)+"..":n},Util.SetBtnColor=function(e,r){e.normalColor=r,e.pressedColor=r;var t=r.getR()+20,n=r.getG()+20,i=r.getB()+20;t>255&&(t=255),n>255&&(n=255),i>255&&(i=255),e.hoverColor=new cc.Color(t,n,i,255)},Util.EventNeedEnterFee=function(e){return e.grade==Def.EventGrade_Special_EnterFee()||e.grade==Def.EventGrade_Special_EnterFee_Acc()};