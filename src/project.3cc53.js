window.__require=function e(t,a,i){function n(c,r){if(!a[c]){if(!t[c]){var l=c.split("/");if(l=l[l.length-1],!t[l]){var s="function"==typeof __require&&__require;if(!r&&s)return s(l,!0);if(o)return o(l,!0);throw new Error("Cannot find module '"+c+"'")}}var u=a[c]={exports:{}};t[c][0].call(u.exports,function(e){return n(t[c][1][e]||e)},u,u.exports,e,t,a,i)}return a[c].exports}for(var o="function"==typeof __require&&__require,c=0;c<i.length;c++)n(i[c]);return n}({BtnExpand:[function(e,t,a){"use strict";cc._RF.push(t,"49bde4x8+dEprefUejfwi6I","BtnExpand");cc.Class({extends:cc.Component,properties:{targetNormal:{default:null,type:cc.Node},targetSel:{default:null,type:cc.Node}},button:null,onLoad:function(){this.button=this.node.getComponent(cc.Button)},ChangeTargetToNormal:function(){this.button.target=this.targetNormal,this.targetNormal.active=!0,this.targetSel.active=!1,this.node.width=this.button.target.width},ChangeTargetToSel:function(){this.button.target=this.targetSel,this.targetNormal.active=!1,this.targetSel.active=!0,this.node.width=this.button.target.width}});cc._RF.pop()},{}],BtnHold:[function(e,t,a){"use strict";cc._RF.push(t,"58760WxtGlBA5ry4e+QlybD","BtnHold"),cc.Class({extends:cc.Component,properties:{myCar:{default:null,type:cc.Node},moveDir:{default:0,type:cc.Integer}},onLoad:function(){this.node.on(cc.Node.EventType.TOUCH_START,this.touchStart,this),this.node.on(cc.Node.EventType.TOUCH_END,this.touchEnd,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.touchEnd,this)},start:function(){},touchStart:function(){this.myCar.getComponent("MyCar").SetSteer(this.moveDir)},touchEnd:function(){this.myCar.getComponent("MyCar").SetSteer(0)}}),cc._RF.pop()},{}],CarMng:[function(e,t,a){"use strict";cc._RF.push(t,"543beS0V4NHhZN/Wepk9GmY","CarMng");cc.Class({extends:cc.Component,properties:{carResrcs:{default:[],type:cc.Node},spawnCount:{default:0,type:cc.Integer,serializable:!1,visible:!1},spawnInterval:{default:2,type:cc.Float,serializable:!1,visible:!1},latestLaneIndex:{default:2,type:cc.Integer,serializable:!1,visible:!1},carZIndexInitial:{default:0,type:cc.Integer,serializable:!1,visible:!1}},cars:null,carExists:null,replayMng:null,IsExistInLane:function(e){return this.carExists[e]},ResrcCount:function(){return this.carResrcs.length},FindCarBySpawnIndex:function(e){for(var t=0;t<this.cars.length;t++){var a=this.cars[t];if(a.SpawnIndex()==e)return a}return null},start:function(){this.ResetSpawnCars();for(var e=0;e<this.carResrcs.length;e++)this.carResrcs[e].active=!1;this.cars=[];for(e=0;e<10*this.carResrcs.length;e++){var t=this.carResrcs[e%this.carResrcs.length],a=cc.instantiate(t);a.active=!1,a.parent=t.parent,a.y=t.y;var i=a.getComponent("Car");i.SetOrgScale(a.scale),this.cars.push(i),0==e&&(this.carZIndexInitial=a.zIndex)}this.replayMng=this.node.getComponent("ReplayMng")},update:function(e){e*=cc.director.getScheduler().getTimeScale();for(var t=0;t<this.carExists.length;t++)this.carExists[t]=1e4;var a=this.replayMng.RecordNow(),i=this.replayMng.ReplayNow(),n=Def.raceMng.GetMyCar();for(t=0;t<this.cars.length;t++){var o=this.cars[t];if(0!=o.node.active){var c=o.node,r=c.y-c.height*c.scale*.5,l=o.LaneIndex();l>=0&&l<this.carExists.length&&0==o.CollideDir()&&r<this.carExists[l]&&(this.carExists[l]=r);var s=(n.SpeedCur()-o.Speed())*Def.KilometerPerHourToMeterPerSec()*Def.MeterToPixel()*e,u=c.y,p=.5-u/Def.CanvasHeight();if(u-=Util.Lerp(s,s*Def.RoadRatioTopBottom(),p),0!=o.CollideDir())c.x+=Def.LaneWidthBottom()*o.CollideDir()*e,c.rotation+=250*Math.PI*o.CollideDir()*e;else{var d=o.laneIndex-Math.floor(.5*Def.LaneCount());c.x=Util.Lerp(Def.LaneWidthTop(),Def.LaneWidthBottom(),p)*d}if(c.y=u,c.scale=Util.Lerp(o.OrgScale(),o.OrgScale()*Def.RoadRatioTopBottom(),p),0==i){var h=.5*Def.CanvasHeight()+350;(u<-h||u>h)&&(c.active=!1,a&&this.replayMng.Record(Def.RecordVal_HideCar()+o.SpawnIndex()))}}}},Spawn:function(e,t,a,i,n){for(var o=0;o<this.cars.length;o++)if(o%this.carResrcs.length==t){var c=this.cars[o];if(!c.node.active){if(this.spawnCount++,0==i&&(i=this.spawnCount),c.Spawn(e,i,a),n)for(var r=0;r<this.cars.length;r++)if(o!=r){var l=this.cars[r];if(0!=l.node.active&&e==l.LaneIndex()){var s=.5*Def.CanvasHeight()+.5*l.node.height,u=.5*Def.CanvasHeight()+1.5*l.node.height;if(l.node.y>=s&&l.node.y<=u)return l.node.active=!1,this.replayMng.RecordNow()&&this.replayMng.Record(Def.RecordVal_OutofSightCar()+l.SpawnIndex()),null}}return c.node.zIndex=this.carZIndexInitial+this.cars.length-this.spawnCount%this.cars.length,c}}return null},ResetSpawnCars:function(){if(null!=this.cars)for(var e=0;e<this.cars.length;e++){var t=this.cars[e];t.ResetSpawnIndex(),t.node.active=!1}this.carExists=[];for(e=0;e<Def.LaneCount();e++)this.carExists.push(1e4);this.spawnCount=0}});cc._RF.pop()},{}],Car:[function(e,t,a){"use strict";cc._RF.push(t,"b70bcDr9btM+ok/GvHimj1I","Car");cc.Class({extends:cc.Component,properties:{speed:{default:50,type:cc.Float,serializable:!1,visible:!1},laneIndex:{default:-1,type:cc.Integer,serializable:!1,visible:!1},orgScale:{default:1,type:cc.Float,serializable:!1,visible:!1},collideDir:{default:0,type:cc.Integer,serializable:!1,visible:!1},spawnIndex:{default:0,type:cc.Integer,serializable:!1,visible:!1}},Speed:function(){return this.speed},LaneIndex:function(){return this.laneIndex},SetOrgScale:function(e){this.orgScale=e},OrgScale:function(){return this.orgScale},CollideDir:function(){return this.collideDir},SpawnIndex:function(){return this.spawnIndex},ResetSpawnIndex:function(){this.spawnIndex=-1},start:function(){},onCollisionEnter:function(e,t){var a=e.getComponent("Car");null!=a&&(this.speed=a.Speed())},Spawn:function(e,t,a){this.node.active=!0,this.node.y=.5*Def.CanvasHeight()+this.node.height,this.node.rotation=Def.RotPerLane()*(Math.floor(.5*Def.LaneCount())-e);var i=.5-this.node.y/Def.CanvasHeight();this.node.scale=Util.Lerp(this.OrgScale(),this.OrgScale()*Def.RoadRatioTopBottom(),i);var n=e-Math.floor(.5*Def.LaneCount());this.node.x=Util.Lerp(Def.LaneWidthTop(),Def.LaneWidthBottom(),i)*n,this.laneIndex=e,this.speed=a,this.collideDir=0,this.spawnIndex=t,this.node.getComponent(cc.Collider).enabled=!0,this.node.getComponent(cc.Sprite).enabled=!0},SetCollide:function(e,t){this.collideDir=e,this.node.getComponent(cc.Collider).enabled=!1,this.speed=t,this.node.getComponent(cc.Sprite).enabled=!1}});cc._RF.pop()},{}],GameMng:[function(e,t,a){"use strict";cc._RF.push(t,"f5e0cTfNUtNBIk/CG6kBkQa","GameMng");cc.Class({extends:cc.Component,properties:{uiRootNode:{default:null,type:cc.Node},panelMenu:{default:null,type:cc.Node},panelWaitScreen:{default:null,type:cc.Node},panelMask:{default:null,type:cc.Node},panelLogin:{default:null,type:cc.Node},toastPopupMsg:{default:null,type:cc.Node}},isPracticeRace:null,SetPracticeRace:function(e){this.isPracticeRace=e},GetPracticeRace:function(){return this.isPracticeRace},onLoad:function(){Def.gameMng=this,this.panelMenu.active=!1,this.panelWaitScreen.position=cc.Vec2.ZERO,this.panelWaitScreen.active=!1,this.panelMask.position=cc.Vec2.ZERO,this.panelMenu.position=cc.Vec2.ZERO,this.panelLogin.active=!1,this.panelLogin.position=cc.Vec2.ZERO,this.toastPopupMsg.position=cc.Vec2.ZERO,this.toastPopupMsg.active=!1,this.isPracticeRace=!1},start:function(){var e=Def.GetLocalStorageData_LanguageIndex();(void 0==e||e<0)&&(e=0),LocalizeMng.Init(e);var t=Def.ZIndexUI();this.uiRootNode.zIndex=t++,this.panelMenu.zIndex=t++,this.panelLogin.zIndex=t++,this.ShowLoginPanel(!0),this.ShowMenuPanel(!1)},BeginRace:function(e,t,a,i,n,o){t==Def.RaceType_Match()&&Def.raceMng.ExtendRaceDist(!1),BCDUser.SetRaceCar(a),this.ShowRaceUI(!0),Def.raceMng.PrepareAndBeginRace(e,t,a,i,n,o)},BeginEventRace:function(e,t){if(Def.raceMng.ExtendRaceDist(e.info.extendRaceDist),this.GetPracticeRace()){var a=0,i=0,n=0;e.rankings.length>0&&(a=.001*e.rankings[0].value.timeLap1,i=.001*e.rankings[0].value.timeLap2,n=.001*e.rankings[0].value.timeFinal),BCDUser.SetCurEventID(e.id);var o=Math.floor(1e3*Math.random());this.BeginRace(o,Def.RaceType_Event(),t,a,i,n)}else BCDUser.SetRaceCar(t),Def.scatterMng.BeginEventRace(e,t)},ReplayRace:function(e,t,a){this.ShowRaceUI(!0),this.SetPracticeRace(!1),Def.raceMng.ReplayRace(e,t,a)},ShowRaceUI:function(e){e?(Def.uiRace.node.active=!0,Def.uiMain.node.active=!1):(Def.uiRace.node.active=!1,Def.uiMain.node.active=!0),Def.raceMng.SetEnable(e)},ShowMenuPanel:function(e){var t=this.panelMenu.getChildByName("tmpSelectNodePanel");if(this.panelMenu.active=e,e){t=this.panelMenu.getComponent("UIPopupMenu");Def.scatterMng.getAccountData(function(){t.UpdateDataToUI()})}},ShowWaitScreen:function(e){this.panelWaitScreen.active=e},onClick_MenuPanel:function(){this.ShowMenuPanel(!this.panelMenu.active)},ShowLoginPanel:function(e){this.panelLogin.active=e}});cc._RF.pop()},{}],MyCar:[function(e,t,a){"use strict";cc._RF.push(t,"24a23mUieRBEYgPDhViSYuh","MyCar");cc.Class({extends:cc.Component,properties:{speedCur:{default:80,type:cc.Float,serializable:!1,visible:!1},speedMax:{default:200,type:cc.Float,serializable:!1,visible:!1},speedMaxOver:{default:200,type:cc.Float,serializable:!1,visible:!1},speedAdd:{default:0,type:cc.Float,serializable:!1,visible:!1},accCur:{default:10,type:cc.Float,serializable:!1,visible:!1},accMax:{default:10,type:cc.Float,serializable:!1,visible:!1},rpmRatio:{default:.5,type:cc.Float,serializable:!1,visible:!1},laneIndex:{default:2,type:cc.Integer,serializable:!1,visible:!1},steer:{default:0,type:cc.Integer,serializable:!1,visible:!1},initialY:{default:100,type:cc.Float,serializable:!1,visible:!1},crashCount:{default:0,type:cc.Integer,serializable:!1,visible:!1},extraAccOutRun:{default:!1,serializable:!1,visible:!1},extraAccTimer:{default:0,type:cc.Float,serializable:!1,visible:!1},steerAngleCur:{default:0,type:cc.Float,serializable:!1,visible:!1},orgY:{default:0,type:cc.Float,serializable:!1,visible:!1},collideTimer:{default:0,type:cc.Float,serializable:!1,visible:!1},audioAcc1:{default:null,type:cc.AudioSource},audioCrash:{default:null,type:cc.AudioSource},fxAccOutrunBegin:{default:null,type:cc.Node},fxAccOutrun:{default:null,type:cc.Node},fxAccOutrunExtra:{default:null,type:cc.Node},fxMoveNormal:{default:null,type:cc.Node},fxMoveLeft:{default:null,type:cc.Node},fxMoveRight:{default:null,type:cc.Node},fxCrash:{default:null,type:cc.Node},fxCrashOutrun:{default:null,type:cc.Node},carMngNode:{default:null,type:cc.Node},raceMngNode:{default:null,type:cc.Node},replayMngNode:{default:null,type:cc.Node}},carMng:null,raceMng:null,replayMng:null,extraAccStat:null,imgNormal:null,imgCrash1:null,imgCrash2:null,fxMoveNormalScale:null,engineSndSrc:null,SpeedCur:function(){return this.speedCur},SpeedMax:function(){return this.speedMax},SpeedMaxOver:function(){return this.speedMaxOver},RPMRatio:function(){return this.rpmRatio},SetSteer:function(e){this.steer=e},SetCurSpeed:function(e){this.speedCur=e},onLoad:function(){this.LoadEngineSound()},start:function(){this.carMng=this.carMngNode.getComponent("CarMng"),this.raceMng=this.raceMngNode.getComponent("RaceMng"),this.replayMng=this.replayMngNode.getComponent("ReplayMng"),this.orgY=this.node.y,this.extraAccStat=Def.ExtraAccStat_None(),this.accMax=this.accCur=Def.MyCarDefaultAcc(),this.SetMaxSpeed(200),this.imgNormal=this.node.getChildByName("imgNormal"),this.imgCrash1=this.node.getChildByName("imgCrash1"),this.imgCrash2=this.node.getChildByName("imgCrash2"),this.imgCrash1.active=!1,this.imgCrash2.active=!1,this.ResetAllFX()},update:function(e){if(e*=cc.director.getScheduler().getTimeScale(),0==this.replayMng.ReplayNow()){var t=this.extraAccStat,a=this.carMng.IsExistInLane(this.laneIndex);a>this.node.y&&a<this.node.y+.7*Def.CanvasHeight()?a<.7*this.node.height+this.speedCur?this.extraAccStat=Def.ExtraAccStat_Approach():this.extraAccStat=Def.ExtraAccStat_Follow():this.extraAccStat=Def.ExtraAccStat_None(),this.replayMng.RecordNow()&&t!=this.extraAccStat&&this.replayMng.Record(Def.RecordVal_ExtraAcc()+this.extraAccStat)}var i=0;if(this.extraAccStat==Def.ExtraAccStat_Approach()||this.extraAccStat==Def.ExtraAccStat_Follow()?(this.speedAdd=50,i+=30,0==this.fxAccOutrun.active&&(this.fxAccOutrun.active=!0),this.accCur=1*this.accMax):(this.speedAdd=0,this.accCur=this.accMax*(1-this.speedCur/this.speedMax)+.01,this.accCur<1&&(this.accCur=1),1==this.fxAccOutrun.active&&this.extraAccTimer<=0&&(this.fxAccOutrun.active=!1)),this.extraAccTimer>0){this.speedAdd=Def.MyCarExtraAccAddSpeed(),this.accCur=this.accMax*(2+this.extraAccTimer);var n=this.extraAccTimer/Def.MyCarExtraAccTime();n<.95&&(i+=n/.95*130),this.extraAccTimer-=e,this.extraAccTimer<=0?this.fxAccOutrunExtra.active=!1:this.fxAccOutrunExtra.opacity=Math.floor(this.extraAccTimer/Def.MyCarExtraAccTime()*255)}else 1==this.fxAccOutrunExtra.active&&(this.fxAccOutrunExtra.active=!1);this.collideTimer>0&&(i-=200*this.collideTimer,this.collideTimer-=e);var o=this.speedMax+this.speedAdd;this.speedCur>o?this.speedCur=Util.Lerp(this.speedCur,o,e):(this.speedCur+=this.accCur*e,this.speedCur>o&&(this.speedCur=o));var c=this.node.x,r=(this.laneIndex-Math.floor(Def.LaneCount()/2))*Def.MyCarLaneWidth(),l=c/(2*Def.MyCarLaneWidth())*-Def.MyCarLimitRot(),s=Math.abs(c-r),u=this.laneIndex;if(0!=this.steer&&s<Def.MyCarMoveBoundary()&&0==this.replayMng.ReplayNow()&&this.MoveLane(u+this.steer),this.laneIndex!=u&&(r=(this.laneIndex-Math.floor(Def.LaneCount()/2))*Def.MyCarLaneWidth(),s=Math.abs(c-r)),s>.01){var p=Def.MyCarMoveHorzSpeed()*e;this.extraAccTimer>0&&(p*=1+.5*this.extraAccTimer),s>Def.MyCarMoveBoundary()?c>r?c-=p:c+=p:c=Util.Lerp(c,r,p),this.node.x=c}0==this.steer&&(this.steerAngleCur=Util.Lerp(this.steerAngleCur,0,5*e)),l+=this.steerAngleCur,this.node.rotation=l;this.speedCur<=.5*this.speedMax?this.rpmRatio=this.speedCur/(.5*this.speedMax)*.58:this.speedCur<=.8*this.speedMax?this.rpmRatio=.58*this.speedCur/(.8*this.speedMax):this.speedCur<=this.speedMax?this.rpmRatio=.58*this.speedCur/this.speedMax:this.rpmRatio=.58+(1-(this.speedMaxOver-this.speedCur)/(this.speedMaxOver-this.speedMax))*(1-.58),void 0!=this.engineSndSrc&&(this.engineSndSrc.playbackRate.value=this.rpmRatio),this.node.y=Util.Lerp(this.node.y,this.orgY+i,5*e),this.node.x+=1.5*(.5-Math.random()),this.node.y+=1.5*(.5-Math.random()),this.fxMoveNormal.scaleY=this.speedCur/this.speedMaxOver*3},onCollisionEnter:function(e,t){var a=e.getComponent("Car");null!=a&&0==this.replayMng.ReplayNow()&&this.CrashToOtherCar(a)},ResetAllFX:function(){this.fxMoveNormalScale=this.fxMoveNormal.scaleY,this.fxAccOutrunBegin.active=!1,this.fxAccOutrun.active=!1,this.fxAccOutrunExtra.active=!1,this.fxMoveLeft.active=!1,this.fxMoveRight.active=!1,this.fxCrash.active=!1,this.fxCrashOutrun.active=!1},MoveLane:function(e){if(!(e<0||e>=Def.LaneCount()||e==this.laneIndex)){var t=this.laneIndex<e?1:-1;this.laneIndex=e;var a=null;t<0?(this.steerAngleCur=-Def.MyCarSteerAngle(),a=this.fxMoveLeft):(this.steerAngleCur=Def.MyCarSteerAngle(),a=this.fxMoveRight),a.active=!0;var i=a.getComponent(cc.Animation);i.setCurrentTime(0),i.play(),0==this.replayMng.ReplayNow()&&(this.extraAccStat==Def.ExtraAccStat_Approach()&&(this.OutrunExtra(),this.replayMng.RecordNow()&&this.replayMng.Record(Def.RecordVal_OutrunExtra())),this.replayMng.RecordNow()&&this.replayMng.Record(Def.RecordVal_MoveLane()+this.laneIndex))}},SetExtraAcc:function(e){this.extraAccStat=e},OutrunExtra:function(){this.extraAccOutRun=!0,this.extraAccTimer=Def.MyCarExtraAccTime(),this.audioAcc1.play(),this.fxAccOutrunExtra.active=!0,this.fxAccOutrunBegin.active=!0;var e=this.fxAccOutrunBegin.getComponent(cc.Animation);e.setCurrentTime(0),e.play()},CrashToOtherCar:function(e){this.crashCount++,e.SetCollide(Math.random()<.5?-1:1,.7*e.Speed());var t=this.extraAccStat!=Def.ExtraAccStat_None()?this.fxCrashOutrun:this.fxCrash;t.active=!0;var a=t.getComponent(cc.Animation);if(a.setCurrentTime(0),a.play(),this.extraAccStat=Def.ExtraAccStat_None(),this.extraAccTimer=0,this.speedCur>this.speedMax&&(this.speedCur=this.speedMax),this.accCur=this.accMax,this.speedAdd=0,this.audioCrash.play(),this.extraAccOutRun&&(this.extraAccOutRun=!1,this.extraAccTimer=.01,this.fxAccOutrunExtra.active=!1),this.collideTimer=.5,this.crashCount>=2){var i=1;this.crashCount>=4&&(i=2),this.imgNormal.active=!1,this.imgCrash1.active=1==i,this.imgCrash2.active=2==i}this.raceMng.ShakeScreen(.5),this.replayMng.RecordNow()&&this.replayMng.Record(Def.RecordVal_Crash()+e.SpawnIndex())},SetMaxSpeed:function(e){e<10&&(e=10),e>1e3&&(e=1e3),this.speedMax=e;var t=this.speedMax+this.accMax,a=this.speedMax+Def.MyCarExtraSpeedRatio_Follow();this.speedMaxOver=t>a?t:a},SetModel:function(e,t){Util.LoadTexture_Car(this.imgNormal.getComponent(cc.Sprite),e,Def.CarImageType_Top(),t,Def.CarImageShape_Normal()),Util.LoadTexture_Car(this.imgCrash1.getComponent(cc.Sprite),e,Def.CarImageType_Top(),t,Def.CarImageShape_Crash1()),Util.LoadTexture_Car(this.imgCrash2.getComponent(cc.Sprite),e,Def.CarImageType_Top(),t,Def.CarImageShape_Crash2()),this.imgNormal.active=!0,this.imgCrash1.active=!1,this.imgCrash2.active=!1;var a=Util.GetCarModelInfo(e);this.fxMoveNormal.y=a.pivot_fx1,this.fxAccOutrunBegin.y=a.pivot_fx1,this.fxAccOutrun.y=a.pivot_fx1,this.fxAccOutrunExtra.y=a.pivot_fx1},BeginRace:function(){this.crashCount=0,this.speedCur=Def.MyCarStartSpeed(),this.accMax=this.accCur=Def.MyCarDefaultAcc(),this.laneIndex=Math.floor(Def.LaneCount()/2),this.node.x=0,this.extraAccOutRun=!1,this.extraAccTimer=.01,this.steer=0,this.steerAngleCur=0,this.ResetAllFX(),this.PlayEngineSound()},EndRace:function(){this.ResetAllFX(),this.StopEngineSound()},LoadEngineSound:function(){var e=this;cc.loader.loadRes("sound/engine_loop",function(t,a){e.engineSndBuffer=a._audio})},PlayEngineSound:function(){var e=new(window.AudioContext||window.webkitAudioContext);this.engineSndSrc=e.createBufferSource(),this.engineSndSrc.buffer=this.engineSndBuffer,this.engineSndSrc.connect(e.destination),this.engineSndSrc.loop=!0,this.engineSndSrc.start(0)},StopEngineSound:function(){this.engineSndSrc.stop(0)}});cc._RF.pop()},{}],RaceMng:[function(e,t,a){"use strict";cc._RF.push(t,"cdf7cClGcZMpIxrR9TUrbTG","RaceMng");cc.Class({extends:cc.Component,properties:{raceTimeCur:{default:0,type:cc.Float,serializable:!1,visible:!1},raceTimePrev:{default:-1,type:cc.Float,serializable:!1,visible:!1},raceTimeBestLap1:{default:19,type:cc.Float,serializable:!1,visible:!1},raceTimeBestLap2:{default:36,type:cc.Float,serializable:!1,visible:!1},raceTimeBestFinal:{default:55,type:cc.Float,serializable:!1,visible:!1},raceTimeCurLap1:{default:20,type:cc.Float,serializable:!1,visible:!1},raceTimeCurLap2:{default:40,type:cc.Float,serializable:!1,visible:!1},raceTimeCurFinal:{default:60,type:cc.Float,serializable:!1,visible:!1},raceDistCur:{default:0,type:cc.Float,serializable:!1,visible:!1},raceDistPrev:{default:-1,type:cc.Float,serializable:!1,visible:!1},racingNow:{default:!1,serializable:!1,visible:!1},raceType:{default:0,serializable:!1,visible:!1},raceStandbyTime:{default:0,serializable:!1,visible:!1},myCarNode:{default:null,type:cc.Node},cameraNode:{default:null,type:cc.Node}},collisionMng:null,myCar:null,roadMng:null,carMng:null,replayMng:null,distNextWindEffect:null,shakeScreenTimer:null,carSpawnDatas:null,carSpawnIndex:null,carInfoCur:null,replayUser:null,replayRaceID:null,replayEventID:null,prevRaceFinalTime:null,RaceType:function(){return this.raceType},RaceTimeCur:function(){return this.raceTimeCur},RaceDist:function(){return this.raceDistExtended?6e3:3e3},RaceDistExtended:function(e){return this.raceDistExtended},ExtendRaceDist:function(e){this.raceDistExtended=e},RaceDistCur:function(){return this.raceDistCur},RaceDistPrev:function(){return this.raceDistPrev},GetMyCar:function(){return this.myCar},GetReplayUser:function(){return this.replayUser},GetReplayRaceID:function(){return this.replayRaceID},start:function(){this.collisionMng=cc.director.getCollisionManager(),this.collisionMng.enabled=!0,this.collisionMng.enableDebugDraw=!0,this.myCar=this.myCarNode.getComponent("MyCar"),this.carMng=this.node.getComponent("CarMng"),this.roadMng=this.node.getComponent("RoadMng"),this.replayMng=this.node.getComponent("ReplayMng"),Def.raceMng=this.node.getComponent("RaceMng"),this.distNextWindEffect=Def.WindObjectDistStd(),this.shakeScreenTimer=0},update:function(e){if(e*=cc.director.getScheduler().getTimeScale(),this.raceStandbyTime>0&&(this.raceStandbyTime-=e,this.raceStandbyTime<=0&&(this.racingNow=!0,this.raceType!=Def.RaceType_Match()&&this.raceType!=Def.RaceType_Event()||(this.raceTimeBestFinal>0&&Def.uiRace.ShowDistDiffIndicator(!0),this.replayMng.BeginRecord(),this.RaceDistExtended()&&this.replayMng.Record(Def.RecordVal_RaceDistExtended())),this.raceStandbyTime<-1&&(this.raceStandbyTime=0,Def.uiRace.ShowRaceStandby(!1)))),this.racingNow){this.raceDistCur<this.RaceDist()&&(this.raceTimePrev=this.raceTimeCur,this.raceTimeCur+=e,0!=this.raceTimeBestFinal&&this.ProcessCompetitionGauge());var t=this.myCar.SpeedCur()*Def.KilometerPerHourToMeterPerSec()*e;this.raceDistPrev=this.raceDistCur,this.raceDistCur+=t;var a=this.RaceDist()/3;this.raceDistPrev<a&&this.raceDistCur>=a&&0==this.replayMng.ReplayNow()&&(this.raceTimeCurLap1=this.raceTimeCur),a=this.RaceDist()/3*2,this.raceDistPrev<a&&this.raceDistCur>=a&&0==this.replayMng.ReplayNow()&&(this.raceTimeCurLap2=this.raceTimeCur),a=this.RaceDist(),this.raceDistPrev<a&&this.raceDistCur>=a&&(0==this.replayMng.ReplayNow()&&(this.raceTimeCurFinal=this.raceTimeCur),this.EndRace(!0)),this.raceDistCur<this.RaceDist()&&0==this.replayMng.ReplayNow()&&this.ProcessSpawnCar()}this.ProcessSpawnWindEffect(e),this.shakeScreenTimer>0&&this.ProcessShakeScreen(e)},ProcessSpawnCar:function(){if(!(this.carSpawnIndex>=this.carSpawnDatas.length)){for(var e=this.carSpawnIndex,t=this.carSpawnIndex+1;t<this.carSpawnDatas.length;t++){var a=this.carSpawnDatas[t];if(a.dist>this.raceDistCur)return;if(a.dist>this.raceDistPrev&&a.dist<=this.raceDistCur){this.carSpawnIndex=t;break}}if(this.carSpawnIndex!=e&&!(this.myCar.SpeedCur()<.6*this.myCar.SpeedMax())){var i=this.myCar.SpeedMax()*(.8+.1*Math.random());i>this.myCar.SpeedCur()&&(i=this.myCar.SpeedCur()),i=Math.floor(i),this.SpawnCarByIndex(this.carSpawnIndex,i,!0),this.replayMng.RecordNow()&&this.replayMng.Record(Def.RecordVal_SpawnCar()+this.carSpawnIndex,i)}}},ProcessSpawnWindEffect:function(e){var t=this.myCar.SpeedCur()*Def.KilometerPerHourToMeterPerSec()*e;this.distNextWindEffect-=t,this.distNextWindEffect<0&&(this.roadMng.SpawnWindEffect(0),this.distNextWindEffect=Def.WindObjectDistStd()*(1+.1*Math.random()))},ProcessShakeScreen:function(e){this.shakeScreenTimer-=e,this.shakeScreenTimer>0&&(this.cameraNode.x=20*(Math.random()-.5)*this.shakeScreenTimer,this.cameraNode.y=20*(Math.random()-.5)*this.shakeScreenTimer)},ProcessCompetitionGauge:function(){var e=this.RaceDist()/3,t=0;t=this.raceDistCur<e?e/this.raceTimeBestLap1*this.raceTimeCur:this.raceDistCur<2*e?e+e/(this.raceTimeBestLap2-this.raceTimeBestLap1)*(this.raceTimeCur-this.raceTimeBestLap1):2*e+e/(this.raceTimeBestFinal-this.raceTimeBestLap2)*(this.raceTimeCur-this.raceTimeBestLap2),Def.uiRace.SetDistDiffIndicator(this.raceDistCur-t)},SpawnCarByIndex:function(e,t,a){var i=this.carSpawnDatas[e];this.carMng.Spawn(i.lane,i.resrc,t,0,a)},SetBestLapTime:function(e,t,a){this.raceTimeBestLap1=e,this.raceTimeBestLap2=t,this.raceTimeBestFinal=a},BeginRace:function(e,t){if(this.raceType=e,this.raceTimeCur=this.raceTimePrev=0,this.raceDistCur=this.raceDistPrev=0,this.myCar.node.active=!0,this.myCar.SetModel(t.model,t.color),this.myCar.SetMaxSpeed(t.speed),this.myCar.BeginRace(),this.roadMng.ResetScroll(),this.carMng.ResetSpawnCars(),Def.uiRace.ShowRaceResult(!1,e,0,0),Def.uiRace.ShowRaceStandby(!0),Def.uiRace.ShowDistDiffIndicator(!1),this.carInfoCur=t,e==Def.RaceType_Replay())Def.uiRace.ShowReplayPanel(!0),Def.uiRace.ShowExitBtn(!1),this.replayMng.BeginReplay();else{Def.uiRace.ShowReplayPanel(!1);var a=!1;if(Def.gameMng.GetPracticeRace())a=!0;else if(e==Def.RaceType_Event()){var i=BCDEvent.GetDataById(BCDUser.GetCurEventID());void 0!=i.mapPlayer&&void 0!=i.mapPlayer.get(BCDAccount.Name())&&(a=!0)}Def.uiRace.ShowExitBtn(a)}this.raceStandbyTime=3},PrepareAndBeginRace:function(e,t,a,i,n,o){var c=e/Def.CarSpawnData_BundleSize()%Def.CarSpawnData_BundleCount(),r="spawn_datas/spawn";r+=c<1?"000":c<10?"00"+c:"0"+c,this.myCar.node.active=!1;var l=this;cc.loader.loadRes(r,function(c,r){l.GenerateCarSpawnDatas(r.text,e),l.SetBestLapTime(i,n,o),l.BeginRace(t,a)})},EndRace:function(e){this.racingNow=!1,this.raceStandbyTime=0,this.myCar.EndRace(),this.carMng.ResetSpawnCars(),this.replayMng.ReplayNow()&&this.replayMng.EndReplay();var t=this.raceDistCur>=this.RaceDist();if(t&&Def.uiRace.ShowRaceResult(!0,this.raceType,this.raceTimeCurFinal,this.raceTimeBestFinal),this.raceType==Def.RaceType_Replay())null!=Def.gameMng&&void 0!=Def.gameMng&&Def.gameMng.ShowRaceUI(!1);else{var a=Math.round(1e3*this.raceTimeCurLap1),i=Math.round(1e3*this.raceTimeCurLap2),n=Math.round(1e3*this.raceTimeCurFinal);if(this.raceType==Def.RaceType_Match())Def.gameMng.GetPracticeRace()?t?setTimeout(function(){Def.gameMng.ShowRaceUI(!1)},3e3):Def.gameMng.ShowRaceUI(!1):Def.scatterMng.EndMatchRace(a,i,n);else if(this.raceType==Def.RaceType_Event())if(Def.gameMng.GetPracticeRace())Def.gameMng.ShowRaceUI(!1),t&&(BCDUser.SetCurEventRaceRecord(n),Def.uiMain.ShowPopupRaceResult(Def.RaceType_Event()));else if(e){if(this.raceTimeCurFinal>this.raceTimeBestFinal)void 0!=BCDEvent.GetDataById(BCDUser.GetCurEventID()).mapPlayer.get(BCDAccount.Name())&&Def.uiRace.ShowToastPopupMsg("toastmsg_record_race");Def.scatterMng.EndEventRace(BCDUser.GetCurEventID(),a,i,n)}else Def.gameMng.ShowRaceUI(!1),Def.gameMng.ShowWaitScreen(!1);0==Def.gameMng.GetPracticeRace()&&(this.replayMng.StopRecord(),e&&this.SendReplayDatasToServer(0))}},ShakeScreen:function(){this.shakeScreenTimer=.5},GenerateCarSpawnDatas:function(e,t){var a=Math.floor(t%Def.CarSpawnData_BundleSize())*Def.CarSpawnData_Count();this.carSpawnDatas=[],this.carSpawnIndex=-1;for(var i=0;i<Def.CarSpawnData_Count();i++){var n=e.charCodeAt(a+i),o=n>>5&3,c=(n>>2&7)-1,r=(3&n)-1,l=i*Def.CarSpawnDist()+(o-1.5)*Def.CarSpawnDist()*.15;this.carSpawnDatas.push({lane:c,resrc:r,dist:l})}},SetEnable:function(e){this.myCar.enabled=e,this.roadMng.enabled=e,this.carMng.enabled=e,this.replayMng.enabled=e},SendReplayDatasToServer:function(e){var t=Def.ReplayDataServerURL_Send(),a=new Date;console.log(a),console.log("SendReplayDatasToServer seq["+e+"] RaceID["+BCDUser.GetCurRaceID()+"] - "+t);var i=cc.loader.getXMLHttpRequest();i.timeout=5e3,i.open("POST",t,!0),i.setRequestHeader("Content-Type","application/json;charset=UTF-8");for(var n=[],o=Def.replayMng.GetDatas(),c=0;c<o.length;c++){var r=o[c];n.push(Math.floor(10*r.dist)),n.push(Math.floor(r.value)),n.push(Math.floor(r.speed))}var l={race_id:Def.ReplayServerKeyHead()+"_"+BCDAccount.Name()+"_"+String(BCDUser.GetCurRaceID()),account:BCDAccount.Name(),car_id:this.carInfoCur.id,car_model:this.carInfoCur.model,car_color:this.carInfoCur.color,car_speed:this.carInfoCur.speed,playdata_v1:n},s=JSON.stringify(l);i.send(s),i.onreadystatechange=function(){i.readyState==XMLHttpRequest.DONE&&200!=i.status&&(window.alert("send replay data failed - status : "+i.status+" response : "+i.responseText),e<2&&setTimeout(function(){Def.raceMng.SendReplayDatasToServer(e+1)},1e3))},i.onerror=function(e){console.log(e)}},ReplayRace:function(e,t,a){this.replayUser=e,this.replayRaceID=t,this.replayEventID=a;var i=this,n=cc.loader.getXMLHttpRequest();n.timeout=5e3;var o=Def.ReplayDataServerURL_Recv()+Def.ReplayServerKeyHead()+"_"+e+"_"+t;console.log("ReplayRace ["+t+"] - request data - "+o),n.open("GET",o),n.send(),n.onreadystatechange=function(){if(n.readyState==XMLHttpRequest.DONE)if(200==n.status){var e=JSON.parse(n.responseText);if(i.replayUser=e.account,e.playdata.length>0)Def.replayMng.SetDataFromBuffer(e.playdata,0);else{if(!(e.playdata_v1.length>0))return console.log(e),void window.alert("play data ["+t+"] not compatible");Def.replayMng.SetDataFromBuffer(e.playdata_v1,1)}var a={model:Number(e.car_model),color:Number(e.car_color),speed:Number(e.car_speed)};i.PrepareAndBeginRace(t,Def.RaceType_Replay(),a,0,0,0)}else{var c=n.responseText+" "+o;window.alert(c),null!=Def.gameMng&&void 0!=Def.gameMng&&Def.gameMng.ShowRaceUI(!1)}},n.onerror=function(e){console.log(e)}},ReportRace:function(){Def.scatterMng.ReportRace(this.replayUser,this.replayRaceID,this.replayEventID)}});cc._RF.pop()},{}],ReplayMng:[function(e,t,a){"use strict";cc._RF.push(t,"214a1yo3UZKEaPBTCsptum0","ReplayMng");cc.Class({extends:cc.Component,properties:{recordNow:{default:!1,serializable:!1,visible:!1},replayNow:{default:!1,serializable:!1,visible:!1},myCarNode:{default:null,type:cc.Node}},recordDatas:null,replayIndex:null,myCar:null,carMng:null,BeginReplay:function(){this.replayNow=!0,this.replayIndex=0},EndReplay:function(){0!=this.replayNow&&(this.replayNow=!1,this.replayIndex=0)},ReplayNow:function(){return this.replayNow},BeginRecord:function(){this.recordNow=!0,this.recordDatas=[]},StopRecord:function(){this.recordNow=!1},RecordNow:function(){return this.recordNow},GetDatas:function(){return this.recordDatas},start:function(){this.myCar=this.myCarNode.getComponent("MyCar"),this.carMng=this.node.getComponent("CarMng"),Def.replayMng=this.node.getComponent("ReplayMng"),this.recordDatas=new Array,this.replayIndex=0},update:function(e){if(this.replayNow&&this.replayIndex<this.recordDatas.length){var t=Def.raceMng.RaceDistCur(),a=this.recordDatas[this.replayIndex];if(t>=a.dist){var i=!0;if(a.value>=Def.RecordVal_HideCar()||a.value>=Def.RecordVal_OutofSightCar()){var n=a.value%1e3;null!=(c=this.carMng.FindCarBySpawnIndex(n))&&(c.node.active=!1)}else if(a.value>=Def.RecordVal_SpawnCar()){n=a.value%1e3;Def.raceMng.SpawnCarByIndex(n,a.speed,!1),i=!1}else if(a.value>=Def.RecordVal_OutrunExtra())this.myCar.OutrunExtra();else if(a.value>=Def.RecordVal_ExtraAcc()){var o=a.value%1e3;this.myCar.SetExtraAcc(o)}else if(a.value>=Def.RecordVal_Crash()){var c;n=a.value%1e3;null!=(c=this.carMng.FindCarBySpawnIndex(n))&&this.myCar.CrashToOtherCar(c)}else if(a.value>=Def.RecordVal_MoveLane()){var r=a.value%1e3;this.myCar.MoveLane(r)}i&&this.myCar.SetCurSpeed(a.speed),this.replayIndex++}}},Record:function(e,t){if(0!=this.recordNow&&1!=this.replayNow){void 0==t&&(t=Math.floor(this.myCar.SpeedCur()));var a={dist:Def.raceMng.RaceDistCur(),value:e,speed:t};this.recordDatas.push(a)}},SetDataFromBuffer:function(e,t){var a=!1;this.recordDatas=[];for(var i=0;i<e.length;i+=3){var n=0,o=0,c=0;if(void 0==t||0==t?(n=Number((.1*e.charCodeAt(i)).toFixed(1)),o=e.charCodeAt(i+1),c=e.charCodeAt(i+2)):t>=1&&(n=Number((.1*e[i]).toFixed(1)),o=e[i+1],c=e[i+2]),0==i&&o==Def.RecordVal_RaceDistExtended())a=!0;else{var r={dist:n,value:o,speed:c};this.recordDatas.push(r)}}Def.raceMng.ExtendRaceDist(a)}});cc._RF.pop()},{}],ReplayRaceStarter:[function(e,t,a){"use strict";cc._RF.push(t,"eef84Udg5JG243bkOPPnB/+","ReplayRaceStarter");cc.Class({extends:cc.Component,properties:{panelMask:{default:null,type:cc.Node},uiRootNode:{default:null,type:cc.Node}},start:function(){var e=Def.ZIndexUI();this.uiRootNode.zIndex=e++,this.panelMask.position=cc.Vec2.ZERO,Def.uiRace.HideAllCtrlBtns(),Util.InitCarInfo(Def.Language_En());var t=window.parent.document.URL.split("?");if(!(t.length<=3)){var a=t[t.length-3];Def.ReplayServerKeyHead_Set(a);var i=t[t.length-2],n=Number(t[t.length-1]);Def.raceMng.ReplayRace(i,n)}}});cc._RF.pop()},{}],RoadMng:[function(e,t,a){"use strict";cc._RF.push(t,"4f09cFXZ61Efqqgo5X9vI6x","RoadMng");cc.Class({extends:cc.Component,properties:{roads:{default:[],type:cc.Node},lineLap:{default:null,type:cc.Node},lineFinish:{default:null,type:cc.Node},roadWidthTop:{default:345,type:cc.Float,serializable:!1,visible:!1},roadWidthBottom:{default:740,type:cc.Float,serializable:!1,visible:!1},windEffectResrc:{default:null,type:cc.Node},scroll:{default:0,type:cc.Float,serializable:!1,visible:!1},myCar:{default:null,type:cc.Node}},raceMng:null,roadPosInitial:null,roadHeight:null,roadScaleInitial:null,roadScaleFinal:null,roadScaleRatio:null,roadScaleRatioTopBottom:null,roadScrollHeight:null,roadRatioTopBottom:null,windEffects:null,lineScaleInitial:null,ResetScroll:function(){this.scroll=0},start:function(){this.raceMng=this.node.getComponent("RaceMng"),this.roadPosInitial=this.roads[1].y,this.roadScaleInitial=this.roads[1].scale,this.roadScaleFinal=this.roads[0].scale,this.roadScaleRatio=this.roadScaleInitial/this.roadScaleFinal,this.roadHeight=this.roads[1].height,this.roadScrollHeight=this.roadHeight*(this.roadScaleInitial+this.roadScaleFinal)*.5,this.roadRatioTopBottom=1/(this.roadScaleRatio*this.roadScaleRatio),Def.SetRoadRatioTopBottom(this.roadRatioTopBottom),this.lineScaleInitial=this.lineLap.scale,this.lineLap.active=!1,this.lineFinish.active=!1;var e=cc.find("Canvas").getComponent(cc.Canvas);Def.SetCanvasHeight(e.designResolution.height),this.roadScaleRatioTopBottom=this.roadWidthBottom/this.roadWidthTop,this.windEffects=[];for(var t=0;t<10;t++){var a=cc.instantiate(this.windEffectResrc);a.active=!1,a.parent=this.windEffectResrc.parent,a.y=this.windEffectResrc.y,this.windEffects.push(a)}},update:function(e){e*=cc.director.getScheduler().getTimeScale();var t=this.myCar.getComponent("MyCar"),a=1+this.roadScaleRatio*(this.scroll/this.roadScrollHeight%1);this.scroll+=t.SpeedCur()*Def.KilometerPerHourToMeterPerSec()*a*Def.MeterToPixel()*e;var i=this.scroll/this.roadScrollHeight,n=this.scroll%this.roadScrollHeight,o=n/this.roadScrollHeight,c=this.roadScaleInitial*(1-o)+this.roadScaleFinal*o,r=i%3,l=null,s=null,u=null;r>=0&&r<1?(l=this.roads[0],s=this.roads[1],u=this.roads[2]):r>=1&&r<2?(l=this.roads[1],s=this.roads[2],u=this.roads[0]):(l=this.roads[2],s=this.roads[0],u=this.roads[1]),l.scale=c,l.y=this.roadPosInitial-n,s.scale=c*this.roadScaleRatio,s.y=l.y+.5*(l.scale*this.roadHeight+s.scale*this.roadHeight),u.scale=c*this.roadScaleRatio*this.roadScaleRatio,u.y=s.y+.5*(s.scale*this.roadHeight+u.scale*this.roadHeight);var p=t.SpeedCur()*Def.KilometerPerHourToMeterPerSec()*Def.MeterToPixel()*Def.RoadObjectScrollRatio()*e,d=this.raceMng.RaceDist(),h=this.raceMng.RaceDistCur(),f=this.raceMng.RaceDistPrev(),g=d/3-48,C=2*d/3-48;if((h>=g&&f<g||h>=C&&f<C)&&(this.lineLap.active=!0,this.lineLap.y=.5*Def.CanvasHeight()),this.lineLap.active){var m=.5-this.lineLap.y/Def.CanvasHeight();this.lineLap.y-=Util.Lerp(p,p*Def.RoadRatioTopBottom(),m),this.lineLap.scale=Util.Lerp(this.lineScaleInitial,this.lineScaleInitial*this.roadScaleRatioTopBottom,m),this.lineLap.y<-(.5*Def.CanvasHeight()+this.lineLap.height)&&(this.lineLap.active=!1)}var v=d-55;if(h>=v&&f<v&&(this.lineFinish.active=!0,this.lineFinish.y=.5*Def.CanvasHeight()),this.lineFinish.active){m=.5-this.lineFinish.y/Def.CanvasHeight();this.lineFinish.y-=Util.Lerp(p,p*Def.RoadRatioTopBottom(),m),this.lineFinish.scale=Util.Lerp(this.lineScaleInitial,this.lineScaleInitial*this.roadScaleRatioTopBottom,m),this.lineFinish.y<-(.5*Def.CanvasHeight()+this.lineFinish.height)&&(this.lineFinish.active=!1)}for(var y=0;y<this.windEffects.length;y++){var D=this.windEffects[y];if(0!=D.active){var S=D.y;m=.5-S/Def.CanvasHeight();S-=Util.Lerp(p,p*Def.RoadRatioTopBottom(),m),D.y=S,D.scaleX=Util.Lerp(1,this.roadScaleRatioTopBottom,m),D.scaleY=D.scaleX*D.scaleX;var M=D.getComponent("WindEffect");D.x=Util.Lerp(this.roadWidthTop,this.roadWidthBottom,m)*M.offsetX,S<-(.5*Def.CanvasHeight()+D.height)&&(D.active=!1)}}},SpawnWindEffect:function(e){for(var t=0;t<this.windEffects.length;t++){var a=this.windEffects[t];if(!a.active){a.scale=this.windEffectResrc.scale,a.y=.5*Def.CanvasHeight()+this.windEffectResrc.height,a.active=!0;var i=a.getComponent("WindEffect");i.offsetX=Math.random()-.5,a.rotation=-12*i.offsetX;break}}}});cc._RF.pop()},{}],ScatterMng:[function(e,t,a){"use strict";cc._RF.push(t,"485fam9ZU9CbosrGpQI+ke5","ScatterMng");cc.Class({extends:cc.Component,properties:{},eos:null,scatter:null,account:null,actOptions:null,connectKey:null,contractName:null,contract:null,IsLogin:function(){return null!=this.account},onLoad:function(){Def.scatterMng=this,ScatterJS.plugins(new ScatterEOS)},Login:function(e,t){var a=this,i=null,n="none";0==e?(i={blockchain:"eos",protocol:"http",host:"192.168.12.236",port:8888,chainId:"cf057bbfb72640471fd910bcb67639c22df9f92470936cddc1ade0e2f2e7dc4f"},this.connectKey="eosrace_local",this.contractName="tcdevtest",n="localnet"):1==e?(i={blockchain:"eos",protocol:"https",host:"jungle2.cryptolions.io",port:443,chainId:"e70aaab8997e1dfce58fbfac80cbbb8fecec7b99cf982a9444273cbc64c41473"},this.connectKey="eosrace_junglenet",this.contractName="teamcraftdev",n="junglenet"):2==e||void 0==e?(i={blockchain:"eos",protocol:"https",host:t,port:443,chainId:"aca376f206b8fc25a6ed44dbdc66547c36c6c33e3a119ffbeaef943642f0e906"},this.connectKey="eosrace_mainnet",this.contractName="eosrace1main",n="mainnet"):window.alert("Invalid login index !!!!!!!!! : "+e),Def.ReplayServerKeyHead_Set(n);var o=this.contractName;ScatterJS.scatter.connect(this.connectKey).then(function(e){if(window.scatter=null,console.log("connect to scatter -> "+e),console.log("contract : "+o),console.log("network : "+i.protocol+"://"+i.host+":"+i.port),!e)return Def.gameMng.ShowWaitScreen(!1),window.alert("connect to scatter failed"),!1;a.scatter=ScatterJS.scatter;var t={accounts:[i]};a.scatter.getIdentity(t).then(function(e){a.account=e.accounts.find(function(e){return"eos"===e.blockchain}),a.actOptions={authorization:[a.account.name+"@"+a.account.authority]};var t=Def.AppName()+"_"+a.account.name;Def.SetLocalStorageKey(t);var n={keyProvider:[""],httpEndpoint:i.protocol+"://"+i.host+":"+i.port,expiredInSeconds:60};a.eos=a.scatter.eos(i,Eos,n),a.eos.contract(a.contractName).then(function(e){a.contract=e}),Def.gameMng.ShowLoginPanel(!1),a.getAllData()}).catch(function(e){Def.gameMng.ShowWaitScreen(!1),console.error(e),window.alert(e)})}).catch(function(e){Def.gameMng.ShowWaitScreen(!1),console.error(e),window.alert(e)})},Logout:function(){this.scatter.forgetIdentity(),this.account=null,BCDGame.Clear(),BCDUser.Clear(),BCDMatchPool.Clear(),BCDMarket.Clear(),BCDEvent.Clear(),Def.uiMain.UpdateUserAccountDatasToUI(),Def.uiMain.UpdateAccountBalanceToUI(),Def.uiMain.UpdateAccountInfoToUI(),Def.uiMain.UpdateMarketInfosToUI(Def.MarketItemType_Car()),Def.uiMain.UpdateMarketInfosToUI(Def.MarketItemType_Piece()),Def.uiMain.UpdateMarketInfosToUI(Def.MarketItemType_Fuel()),Def.uiMain.UpdateMatchInfosToUI(),Def.uiMain.UpdateEventInfosToUI(),Def.uiMain.ShowUI(Def.UITab_None()),Def.gameMng.ShowLoginPanel(!0)},getAllData:function(){var e=this;Def.gameMng.ShowWaitScreen(!0);var t={code:this.contractName,scope:this.contractName,table:"manage",json:!0};this.eos.getTableRows(t).then(function(t){BCDGame.SetData(t.rows[0]);e.getUserData(function(){Def.scatterMng.getMatchPoolData(),Def.scatterMng.getEventData(0),Def.scatterMng.getMarketData_Car(),Def.scatterMng.getMarketData_Piece(),Def.scatterMng.getMarketData_Fuel(),Def.gameMng.ShowWaitScreen(!1),Def.uiMain.ShowUI(Def.UITab_Match()),Def.uiMain.UpdateUserStatus()})}).catch(function(t){Def.gameMng.ShowWaitScreen(!1),e.ReportEOSError(t,"getAllData")}),t.table="manageext",this.eos.getTableRows(t).then(function(e){BCDGame.SetDataExt(e.rows[0])}).catch(function(t){e.ReportEOSError(t,"getAllData - Ext")})},getAccountData:function(e){var t=this;null!=this.eos&&(this.eos.getAccount(this.account.name).then(function(t){BCDAccount.SetData(t),Def.uiMain.UpdateAccountInfoToUI(),null!=e&&void 0!=e&&e()}).catch(function(e){t.ReportEOSError(e,"getAccountData")}),this.eos.getCurrencyBalance(TOKEN_CONTRACT_NAME,this.account.name,TOKEN_SYMBOL).then(function(e){BCDAccount.SetBalance(e.length>0?e[0]:"0.0000 EOS"),Def.uiMain.UpdateAccountBalanceToUI()}).catch(function(e){t.ReportEOSError(e,"getCurrencyBalance")}))},getUserData:function(e){var t=this;if(null!=this.eos){this.getAccountData();var a={code:this.contractName,scope:this.contractName,table:"userdata",json:!0,lower_bound:this.account.name,upper_bound:this.account.name+"a"};this.eos.getTableRows(a).then(function(t){BCDUser.SetData(t.rows.length>0?t.rows[0]:void 0),Def.uiMain.UpdateUserAccountDatasToUI(),void 0!=e&&null!=e&&e()}).catch(function(e){t.ReportEOSError(e,"getUserData")})}},getMarketData_Car:function(e,t){if(null!=this.eos){0!=t&&void 0!=t||(BCDMarket.ClearCarDatas(),t=0);var a={code:this.contractName,scope:this.contractName,table:"mktcar",lower_bound:t,upper_bound:Def.MaxTableUpperBound(),json:!0};this.eos.getTableRows(a).then(function(a){for(var i=t,n=0;n<a.rows.length;n++){if(a.rows[n].items.length>0){for(var o=0;o<a.rows[n].items.length;o++)a.rows[n].items[o].value.car.date=a.rows[n].id;BCDMarket.PushCarData(a.rows[n].items)}i=a.rows[n].id+1}a.more?Def.scatterMng.getMarketData_Car(e,i):(Def.uiMain.UpdateMarketInfosToUI(Def.MarketItemType_Car()),void 0!=e&&null!=e&&e())}).catch(function(e){})}},getMatchData_Refresh:function(){var e=this,t={code:this.contractName,scope:this.contractName,table:"manage",json:!0};this.eos.getTableRows(t).then(function(t){BCDGame.SetData(t.rows[0]),e.getMatchPoolData()}).catch(function(t){e.ReportEOSError(t,"getMatchData_Refresh")})},getMarketData_Piece:function(e,t){var a=this;if(null!=this.eos){0!=t&&void 0!=t||(BCDMarket.ClearPieceDatas(),t=0);var i={code:this.contractName,scope:this.contractName,table:"mktpiece",lower_bound:t,upper_bound:Def.MaxTableUpperBound(),json:!0};this.eos.getTableRows(i).then(function(a){for(var i=t,n=0;n<a.rows.length;n++){if(a.rows[n].items.length>0){for(var o=0;o<a.rows[n].items.length;o++)a.rows[n].items[o].value.date=a.rows[n].id;BCDMarket.PushPieceData(a.rows[n].items)}i=a.rows[n].id+1}a.more?Def.scatterMng.getMarketData_Piece(e,i):(Def.uiMain.UpdateMarketInfosToUI(Def.MarketItemType_Piece()),void 0!=e&&null!=e&&e())}).catch(function(e){a.ReportEOSError(e,"getMarketData_Piece")})}},getMarketData_Fuel:function(e,t){var a=this;if(null!=this.eos){0!=t&&void 0!=t||(BCDMarket.ClearFuelDatas(),t=0);var i={code:this.contractName,scope:this.contractName,table:"mktfuel",lower_bound:t,upper_bound:Def.MaxTableUpperBound(),json:!0};this.eos.getTableRows(i).then(function(i){for(var n=t,o=0;o<i.rows.length;o++){if(i.rows[o].items.length>0){for(var c=0;c<i.rows[o].items.length;c++)i.rows[o].items[c].value.date=i.rows[o].id;BCDMarket.PushFuelData(i.rows[o].items)}n=i.rows[o].id+1}i.more?a.getMarketData_Fuel(e,n):(Def.uiMain.UpdateMarketInfosToUI(Def.MarketItemType_Fuel()),void 0!=e&&null!=e&&e())}).catch(function(e){a.ReportEOSError(e,"getMarketData_Fuel")})}},getMatchPoolData:function(){var e=this,t={code:this.contractName,scope:this.contractName,table:"matchpool",json:!0,lower_bound:BCDUser.GetMatchPoolIndex(),upper_bound:BCDUser.GetMatchPoolIndex()+1};BCDMatchPool.Clear(),this.eos.getTableRows(t).then(function(e){BCDMatchPool.SetData(e.rows[0].datas),Def.uiMain.UpdateMatchInfosToUI()}).catch(function(t){e.ReportEOSError(t,"getMatchPoolData")})},getEventData:function(e){var t=this;0!=e&&void 0!=e||(BCDEvent.Clear(),e=0);var a={code:this.contractName,scope:this.contractName,table:"event",json:!0,lower_bound:e,upper_bound:Def.MaxTableUpperBound()};this.eos.getTableRows(a).then(function(t){for(var a=e,i=0;i<t.rows.length;i++){var n=t.rows[i];BCDEvent.PushData(n),a=n.id}t.more?Def.scatterMng.getEventData(a+1):Def.uiMain.UpdateEventInfosToUI()}).catch(function(e){t.ReportEOSError(e,"getEventData")})},createUser:function(){Def.gameMng.ShowWaitScreen(!0),this.contract.createuser(this.account.name,this.actOptions).then(function(e){setTimeout(function(){Def.scatterMng.getUserData(function(){Def.gameMng.ShowWaitScreen(!1)})},3e3)}).catch(function(e){Def.gameMng.ShowWaitScreen(!1),Def.scatterMng.ReportContractActionError(e)})},transferWithCallback:function(e,t,a,i){BCDUser.IsBlocked()?Def.uiMain.ShowToastPopupMsg("toastmsg_user_blocked"):(Def.gameMng.ShowWaitScreen(!0),this.eos.transfer(this.account.name,e,t,a,this.actOptions).then(function(e){setTimeout(function(){var e=function(){Def.gameMng.ShowWaitScreen(!1)},t=function(){Def.uiMain.ShowPopupBuyFuel(!1),Def.gameMng.ShowWaitScreen(!1)};Def.scatterMng.getUserData(function(){i==Def.Trasfer_BuyCar()?(Def.scatterMng.getMarketData_Car(e),Def.uiMain.ShowToastPopupMsg("toastmsg_buy_car")):i==Def.Trasfer_BuyPiece()?(Def.scatterMng.getMarketData_Piece(e),Def.uiMain.ShowToastPopupMsg("toastmsg_buy_piece")):i==Def.Trasfer_BuyFuel()?(Def.scatterMng.getMarketData_Fuel(t),Def.uiMain.ShowToastPopupMsg("toastmsg_buy_fuel")):i==Def.Trasfer_UpgradeCar()?Def.uiMain.CheckOldCarLevel():i==Def.Trasfer_ExpandGarage()?(Def.uiMain.ShowPopupExpandGarage(!1),Def.uiMain.ShowToastPopupMsg("toastmsg_garage_expand"),Def.uiMain.ShowUI(Def.UITab_Garage()),Def.gameMng.ShowWaitScreen(!1)):i==Def.Trasfer_PurchasePiece()?(Def.uiMain.ShowToastPopupMsg("toastmsg_purchase_piece"),Def.gameMng.ShowWaitScreen(!1)):i==Def.Trasfer_EnterEvent()?Def.scatterMng.PostProcessEventRaceBegin():Def.gameMng.ShowWaitScreen(!1)})},3e3)}).catch(function(e){Def.gameMng.ShowWaitScreen(!1),Def.scatterMng.ReportContractActionError(e)}))},BeginMatchRace:function(e){if(BCDUser.IsBlocked())Def.uiMain.ShowToastPopupMsg("toastmsg_user_blocked");else{var t=BCDUser.GetSelectedCarInfo();if(0!=this.CheckCarForRace(t,null)){var a=BCDMatchPool.GetData(e);Def.gameMng.ShowWaitScreen(!0),this.contract.beginrace(this.account.name,t.id,e,this.actOptions).then(function(i){setTimeout(function(){Def.scatterMng.getUserData(function(){Def.SetLocalStorageData_MatchCarID(t.id),Def.gameMng.ShowWaitScreen(!1),BCDUser.SetMatchPoolRaceIndex(e);var i=.001*a.timeLap1,n=.001*a.timeLap2,o=.001*a.timeFinal;Def.gameMng.BeginRace(BCDUser.GetCurRaceID(),Def.RaceType_Match(),t,i,n,o)})},3e3)}).catch(function(e){Def.gameMng.ShowWaitScreen(!1),Def.scatterMng.ReportContractActionError(e)})}}},EndMatchRace:function(e,t,a){var i=Math.round(e),n=Math.round(t),o=Math.round(a),c=Def.GetLocalStorageData_MatchCarID();this.contract.endrace(this.account.name,c,i,n,o,this.actOptions).then(function(e){setTimeout(function(){BCDUser.SavePieceInfosAndFuel();Def.scatterMng.getUserData(function(){Def.uiMain.UpdateMatchInfosToUI(),Def.uiMain.ShowPopupRaceResult(Def.RaceType_Match())});var e=BCDUser.GetMatchPoolRaceIndex();Def.SetLocalStorageData_MatchRecord(e,a),Def.gameMng.ShowRaceUI(!1)},3e3)}).catch(function(e){Def.gameMng.ShowRaceUI(!1),Def.gameMng.ShowWaitScreen(!1),Def.scatterMng.ReportContractActionError(e)})},BeginEventRace:function(e,t){if(BCDUser.IsBlocked())Def.uiMain.ShowToastPopupMsg("toastmsg_user_blocked");else{if(e.info.grade==Def.EventGrade_Special_DropCar());else if(0==this.CheckCarForRace(t,e))return;BCDEvent.SetCurEventEnter(e,t);var a=void 0==e.mapPlayer.get(BCDAccount.Name());if(Util.EventNeedEnterFee(e.info)&&a){BCDEvent.SetCurEventEnter(e,t);var i=Util.MakeTokenSymbol(e.info.enterFeeOrTrophy/1e4),n="enterEvent,"+e.id+","+t.id;this.transferWithCallback(this.contractName,i,n,Def.Trasfer_EnterEvent())}else Def.gameMng.ShowWaitScreen(!0),this.contract.eventracebeg(this.account.name,e.id,t.id,this.actOptions).then(function(e){Def.scatterMng.PostProcessEventRaceBegin()}).catch(function(e){Def.gameMng.ShowWaitScreen(!1),Def.scatterMng.ReportContractActionError(e)})}},PostProcessEventRaceBegin:function(){var e=BCDEvent.GetCurEvent(),t=BCDEvent.GetCurCar(),a=Util.ParseCarModel_Grade(t.model);0==e.info.requiredCarGrade&&(a=0),Def.SetLocalStorageData_EventCarID_Grade(a,t.id),setTimeout(function(){var a=0,i=0,n=0;if(e.rankings.length>0){var o=e.rankings[0].value;a=.001*o.timeLap1,i=.001*o.timeLap2,n=.001*o.timeFinal}Def.scatterMng.getUserData(function(){Def.gameMng.ShowWaitScreen(!1),Def.gameMng.BeginRace(BCDUser.GetCurRaceID(),Def.RaceType_Event(),t,a,i,n)})},3e3)},EndEventRace:function(e,t,a,i){var n=Math.round(t),o=Math.round(a),c=Math.round(i);this.contract.eventraceend(this.account.name,e,n,o,c,this.actOptions).then(function(e){setTimeout(function(){BCDUser.SetCurEventRaceRecord(c);Def.scatterMng.getUserData(function(){Def.scatterMng.getEventData(0)}),Def.gameMng.ShowRaceUI(!1),Def.uiMain.ShowPopupRaceResult(Def.RaceType_Event())},3e3)}).catch(function(e){Def.gameMng.ShowRaceUI(!1),Def.gameMng.ShowWaitScreen(!1),Def.scatterMng.ReportContractActionError(e)})},ReportRace:function(e,t,a){this.contract.rpteventrace(this.account.name,e,t,a,this.actOptions).then(function(e){Def.uiRace.ShowToastPopupMsg("toastmsg_report_race")}).catch(function(e){Def.scatterMng.ReportContractActionError(e)})},CheckCarForRace:function(e,t){if(null==e||void 0==e)return Def.uiMain.ShowToastPopupMsg("toastmsg_checkrace_null"),!1;if(0!=e.marketKey)return Def.uiMain.ShowToastPopupMsg("toastmsg_checkrace_market"),!1;if(null!=t){if(e.winCount>=Def.EventCarMaxWinCount())return Def.uiMain.ShowToastPopupMsg("toastmsg_checkrace_win_maximum"),!1;if(BCDUser.GetEventTicketCount()<=0){var a=t.info.fuelConsume;if(0==a){var i=Util.ParseCarModel_Grade(e.model);a=BCDGame.GetCarGradeInfo(i).fuelConsume}if(BCDUser.GetFuelCount()<a)return Def.uiMain.ShowToastPopupMsg("toastmsg_check_fuel"),!1}}return!0},GenerateCar:function(e){Def.gameMng.ShowWaitScreen(!0),this.contract.generatecar(this.account.name,e,this.actOptions).then(function(e){setTimeout(function(){Def.scatterMng.getUserData(function(){Def.gameMng.ShowWaitScreen(!1),Def.uiMain.ShowPopupMakeCarResult()})},3e3)}).catch(function(e){Def.gameMng.ShowWaitScreen(!1),Def.scatterMng.ReportContractActionError(e)})},DisassemblePiece:function(e){var t=BCDUser.GetFuelCount()-Def.PieceDisassembleConsumeFuel(),a=BCDUser.GetTrophyCount();Def.gameMng.ShowWaitScreen(!0),this.contract.destroypiece(this.account.name,e,this.actOptions).then(function(e){setTimeout(function(){Def.scatterMng.getUserData(function(){Def.gameMng.ShowWaitScreen(!1),Def.uiMain.ShowPopupDisassemblePieceResult(t,a)})},3e3)}).catch(function(e){Def.gameMng.ShowWaitScreen(!1),Def.scatterMng.ReportContractActionError(e)})},UpgradeCar:function(e,t){var a=Util.MakeTokenSymbol(t),i="upgradeCar,"+e;this.transferWithCallback(this.contractName,a,i,Def.Trasfer_UpgradeCar())},DestroyCar:function(e){Util.UserCarIsLastOne()?Def.uiMain.ShowToastPopupMsg("toastmsg_check_destroy_car_last_one"):(Def.gameMng.ShowWaitScreen(!0),this.contract.destroycar(this.account.name,e,this.actOptions).then(function(e){setTimeout(function(){Def.scatterMng.getUserData(function(){Def.gameMng.ShowWaitScreen(!1),Def.uiMain.ShowPopupCarDestroyResult()})},3e3)}).catch(function(e){Def.gameMng.ShowWaitScreen(!1),Def.scatterMng.ReportContractActionError(e)}))},RegCarMarket:function(e,t){if(BCDUser.IsBlocked())Def.uiMain.ShowToastPopupMsg("toastmsg_user_blocked");else if(0!=Util.CheckPrice(t)){var a=Util.MakeTokenSymbol(t);Def.gameMng.ShowWaitScreen(!0),this.contract.regcarmkt(this.account.name,e,a,this.actOptions).then(function(e){setTimeout(function(){Def.scatterMng.getUserData(Def.scatterMng.getMarketData_Car(function(){Def.gameMng.ShowWaitScreen(!1),Def.uiMain.UpdateOnSaleCarToUI(),Def.uiMain.ShowToastPopupMsg("toastmsg_register_market_car")}))},3e3)}).catch(function(e){Def.gameMng.ShowWaitScreen(!1),Def.scatterMng.ReportContractActionError(e)})}},UnregCarFromMarket:function(e){BCDUser.IsBlocked()?Def.uiMain.ShowToastPopupMsg("toastmsg_user_blocked"):(Def.gameMng.ShowWaitScreen(!0),this.contract.unregcarmkt(this.account.name,e,this.actOptions).then(function(e){setTimeout(function(){Def.scatterMng.getUserData(Def.scatterMng.getMarketData_Car(function(){Def.uiMain.UpdateOnSaleCarToUI(),Def.gameMng.ShowWaitScreen(!1),Def.uiMain.ShowToastPopupMsg("toastmsg_cancel_register_market")}))},3e3)}).catch(function(e){Def.gameMng.ShowWaitScreen(!1),Def.scatterMng.ReportContractActionError(e)}))},BuyCarFromMarket:function(e,t,a){var i="buyCarFromMarket,"+e+","+t;this.transferWithCallback(this.contractName,a,i,Def.Trasfer_BuyCar())},RegPieceMarket:function(e,t,a){if(BCDUser.IsBlocked())Def.uiMain.ShowToastPopupMsg("toastmsg_user_blocked");else if(0!=Util.CheckPrice(a)){var i=Util.MakeTokenSymbol(a);Def.gameMng.ShowWaitScreen(!0),this.contract.regpiecemkt(this.account.name,e,t,i,this.actOptions).then(function(e){setTimeout(function(){Def.scatterMng.getUserData(Def.scatterMng.getMarketData_Piece(function(){Def.uiMain.ShowPopupPieceInfo(!1),Def.uiMain.UpdateOnSalePieceToUI(),Def.gameMng.ShowWaitScreen(!1),Def.uiMain.ShowToastPopupMsg("toastmsg_register_market_piece")}))},3e3)}).catch(function(e){Def.gameMng.ShowWaitScreen(!1),Def.scatterMng.ReportContractActionError(e)})}},BuyPieceFromMarket:function(e,t,a){var i="buyPieceFromMarket,"+e+","+t;this.transferWithCallback(this.contractName,a,i,Def.Trasfer_BuyPiece())},UnregPieceFromMarket:function(e,t){BCDUser.IsBlocked()?Def.uiMain.ShowToastPopupMsg("toastmsg_user_blocked"):(Def.gameMng.ShowWaitScreen(!0),this.contract.unregpiecemk(this.account.name,e,t,this.actOptions).then(function(e){setTimeout(function(){Def.scatterMng.getUserData(Def.scatterMng.getMarketData_Piece(function(){Def.uiMain.UpdateOnSalePieceToUI(),Def.gameMng.ShowWaitScreen(!1),Def.uiMain.ShowToastPopupMsg("toastmsg_cancel_register_market")}))},3e3)}).catch(function(e){Def.gameMng.ShowWaitScreen(!1),Def.scatterMng.ReportContractActionError(e)}))},RegFuelToMarket:function(e,t){if(BCDUser.IsBlocked())Def.uiMain.ShowToastPopupMsg("toastmsg_user_blocked");else if(0!=Util.CheckPrice(t)){var a=Util.MakeTokenSymbol(t);Def.gameMng.ShowWaitScreen(!0),this.contract.regfuelmkt(this.account.name,e,a,this.actOptions).then(function(e){setTimeout(function(){Def.scatterMng.getUserData(Def.scatterMng.getMarketData_Fuel(function(){Def.uiMain.ShowPopupSaleFuel(!1),Def.uiMain.UpdateOnSaleFuelToUI(),Def.gameMng.ShowWaitScreen(!1),Def.uiMain.ShowToastPopupMsg("toastmsg_register_market_fuel")}))},3e3)}).catch(function(e){Def.gameMng.ShowWaitScreen(!1),Def.scatterMng.ReportContractActionError(e)})}},UnregFuelFromMarket:function(e){BCDUser.IsBlocked()?Def.uiMain.ShowToastPopupMsg("toastmsg_user_blocked"):(Def.gameMng.ShowWaitScreen(!0),this.contract.unregfuelmkt(this.account.name,e,this.actOptions).then(function(e){setTimeout(function(){Def.scatterMng.getUserData(Def.scatterMng.getMarketData_Fuel(function(){Def.uiMain.UpdateOnSaleFuelToUI(),Def.gameMng.ShowWaitScreen(!1),Def.uiMain.ShowToastPopupMsg("toastmsg_cancel_register_market")}))},3e3)}).catch(function(e){Def.gameMng.ShowWaitScreen(!1),Def.scatterMng.ReportContractActionError(e)}))},BuyFuelFromMarket:function(e,t,a){var i="buyFuelFromMarket,"+e+","+t;this.transferWithCallback(this.contractName,a,i,Def.Trasfer_BuyFuel())},RecvEventReward:function(e){if(BCDUser.IsBlocked())Def.uiMain.ShowToastPopupMsg("toastmsg_user_blocked");else{Def.gameMng.ShowWaitScreen(!0);var t=BCDUser.GetRewardInfo(e);this.contract.eventrecvrw(this.account.name,e,this.actOptions).then(function(e){setTimeout(function(){Def.gameMng.ShowWaitScreen(!1);Def.scatterMng.getUserData(function(){Def.uiMain.ShowPopupRewardResult(t),Def.uiMain.ShowPopupReward(!0),Def.uiMain.UpdateEventRewardsExist()})},3e3)}).catch(function(e){Def.gameMng.ShowWaitScreen(!1),Def.scatterMng.ReportContractActionError(e)})}},ExpandGarage:function(e){var t=Util.MakeTokenSymbol(e);this.transferWithCallback(this.contractName,t,"expandCarSpace",Def.Trasfer_ExpandGarage())},PurchasePiece:function(e,t,a){var i="buyPieceFromMain,"+e+","+t,n=Util.MakeTokenSymbol(a);this.transferWithCallback(this.contractName,n,i,Def.Trasfer_PurchasePiece())},RecommendUser:function(e){Def.gameMng.ShowWaitScreen(!0),this.contract.setrecommend(this.account.name,e,this.actOptions).then(function(t){Def.gameMng.ShowWaitScreen(!1),BCDUser.SetRecommended(e),Def.uiMain.ShowUI(Def.UITab_Info())}).catch(function(e){Def.gameMng.ShowWaitScreen(!1),Def.scatterMng.ReportContractActionError(e)})},ReportContractActionError:function(e){if(void 0==e.code||void 0==e.type||402!=e.code||"signature_rejected"!=e.type){console.log(e);var t=JSON.parse(e);if(void 0!=t.error){if(3080004==t.error.code)return void Def.uiMain.ShowToastPopupMsg("toastmsg_tx_cpu_limit_exceeded");if(3040005==t.error.code)return void Def.uiMain.ShowToastPopupMsg("toastmsg_tx_expired");if(3010010==t.error.code)return void Def.uiMain.ShowToastPopupMsg("toastmsg_auth_canceled")}var a=JSON.stringify(e);window.alert(a),Def.uiMain.ShowToastPopupMsg("toastmsg_warning_sel_node")}else Def.uiMain.ShowToastPopupMsg("toastmsg_auth_canceled")},ReportEOSError:function(e,t){console.error(e),window.alert(t),Def.uiMain.ShowToastPopupMsg("toastmsg_warning_sel_node")}});cc._RF.pop()},{}],SideObject:[function(e,t,a){"use strict";cc._RF.push(t,"48cffz/c2dLBb1qMzOytQ4C","SideObject");cc.Class({extends:cc.Component,offsetX:null,ctor:function(){this.offsetX=0}});cc._RF.pop()},{}],SoundMng:[function(e,t,a){"use strict";cc._RF.push(t,"82f90BtlitFZo7al6hCaxWS","SoundMng"),cc.Class({extends:cc.Component,properties:{},start:function(){}}),cc._RF.pop()},{}],UICarAsset:[function(e,t,a){"use strict";cc._RF.push(t,"9c8f1JrvvFHOqet7Mb1eDXp","UICarAsset");cc.Class({extends:cc.Component,properties:{usedMarket:{default:!1},btnCar:{default:null,type:cc.Button},btnPiece:{default:null,type:cc.Button},panelCar:{default:null,type:cc.Node},panelPiece:{default:null,type:cc.Node},panelFuel:{default:null,type:cc.Node},panelOnSale:{default:null,type:cc.Node},panelStore:{default:null,type:cc.Node},srcItemCar:{default:null,type:cc.Node},srcItemPiece:{default:null,type:cc.Node},srcItemFuel:{default:null,type:cc.Node},srcItemStore:{default:null,type:cc.Node}},isViewItemAll:null,start:function(){this.isViewItemAll=!1,this.InitListItems()},InitListItems:function(){this.usedMarket?(this.InitPiecePanel(),this.InitCarPanel(),this.InitFuelPanel(),this.InitStorePanel()):(this.InitGaragePiecePanel(),this.InitGarageCarPanel()),this.ShowPanelPiece()},InitCarPanel:function(){var e=this.panelCar.getComponent(cc.ScrollView);Util.AdjustScrollViewItems(e.content,10,1,this.srcItemCar),Util.SetTransparentChildren(e.content),e.scrollToTop(0,!1)},InitGarageCarPanel:function(){var e=Def.MaxCarSpace(),t=this.panelCar.getComponent(cc.ScrollView);Util.AdjustScrollViewItems(t.content,e,3,this.srcItemCar),Util.SetTransparentChildren(t.content),t.scrollToTop(0,!1)},InitPiecePanel:function(){var e=this.panelPiece.getComponent(cc.ScrollView);Util.AdjustScrollViewItems(e.content,10,1,this.srcItemPiece),Util.SetTransparentChildren(e.content),e.scrollToTop(0,!1)},InitGaragePiecePanel:function(){var e=Def.MaxPieceSpace(),t=this.panelPiece.getComponent(cc.ScrollView);Util.AdjustScrollViewItems(t.content,e,4,this.srcItemPiece),Util.SetTransparentChildren(t.content),t.scrollToTop(0,!1)},InitFuelPanel:function(){var e=this.panelFuel.getComponent(cc.ScrollView);Util.AdjustScrollViewItems(e.content,16,1,this.srcItemFuel),Util.SetTransparentChildren(e.content),e.scrollToTop(0,!1)},InitStorePanel:function(){var e=this.panelStore.getComponent(cc.ScrollView);Util.AdjustScrollViewItems(e.content,3,1,this.srcItemStore),e.scrollToTop(0,!1);for(var t=0;t<e.content.children.length;t++){var a=t+1;e.content.children[t].getComponent("UIItemStore").SetInfo(a)}},onClick_CarPage:function(){this.isViewItemAll||(Def.scatterMng.getMarketData_Car(),Def.uiMain.uiMarket.StateInit(),Def.uiMain.uiMarket.UpdateCarInfosToUI()),this.isViewItemAll=!1,this.ShowPanelCar()},onClick_PiecePage:function(){this.isViewItemAll||(Def.scatterMng.getMarketData_Piece(),Def.uiMain.uiMarket.StateInit(),Def.uiMain.uiMarket.UpdatePieceInfosToUI()),this.isViewItemAll=!1,this.ShowPanelPiece()},onClick_FuelPage:function(){Def.scatterMng.getMarketData_Fuel(),Def.uiMain.uiMarket.StateInit(),Def.uiMain.uiMarket.UpdateFuelInfosToUI(),this.ShowPanelFuel()},onClick_StorePage:function(){this.ShowPanelStore()},ShowPanelCar:function(){this.panelCar.active=!0,this.panelPiece.active=!1,this.usedMarket&&this.panelFuel&&(this.panelFuel.active=!1),!this.usedMarket&&this.panelOnSale&&(this.panelOnSale.active=!1),this.panelStore&&(this.panelStore.active=!1),this.panelCar.getComponent(cc.ScrollView).scrollToTop(0,!1)},ShowPanelPiece:function(){this.panelCar.active=!1,this.panelPiece.active=!0,this.usedMarket&&this.panelFuel&&(this.panelFuel.active=!1),!this.usedMarket&&this.panelOnSale&&(this.panelOnSale.active=!1),this.panelStore&&(this.panelStore.active=!1),this.panelPiece.getComponent(cc.ScrollView).scrollToTop(0,!1)},ShowPanelFuel:function(){this.panelCar.active=!1,this.panelPiece.active=!1,this.panelFuel.active=!0,!this.usedMarket&&this.panelOnSale&&(this.panelOnSale.active=!1),this.panelStore&&(this.panelStore.active=!1),this.panelFuel.getComponent(cc.ScrollView).scrollToTop(0,!1)},ShowPanelOnSale:function(){this.panelCar.active=!1,this.panelPiece.active=!1,this.panelOnSale.active=!0},ShowPanelStore:function(){this.panelCar.active=!1,this.panelPiece.active=!1,this.panelFuel.active=!1,this.panelStore.active=!0,this.panelStore.getComponent("UIStore").UpdateQuotationsToUI()},UpdateGarageDatasToUI:function(){for(var e=Def.CarItemType_Garage(),t=this.panelCar.getComponent(cc.ScrollView),a=0;a<t.content.childrenCount;a++){var i=t.content.children[a].getComponent("UIItemCar"),n=a<BCDUser.GetCarCount()?BCDUser.GetCarInfo(a):null;i.SetInfo(e,a,n),i.node.opacity=255}t.scrollToTop(0,!1),t=this.panelPiece.getComponent(cc.ScrollView);var o=0;for(a=0;a<t.content.childrenCount;a++){var c=o<BCDUser.GetPieceCount()?BCDUser.GetPieceInfo(o):null;if(null!=c&&c.count-c.marketDeposit<=0)a--,o++;else(i=t.content.children[a].getComponent("UIItemPiece")).SetInfo(e,o,c),i.node.opacity=255,o++}t.scrollToTop(0,!1)},UpdateMarketCarsToUI:function(e,t){for(var a=Def.CarItemType_Market(),i=this.panelCar.getComponent(cc.ScrollView),n=i.content.childrenCount,o=0;o<n;o++){var c=null,r=null,l=t*n+o;null!=e&&l<e.length&&(c=e[l].car,r=e[l].price);var s=i.content.children[o].getComponent("UIItemCar");s.SetInfo(a,l,c,r),s.node.opacity=255}i.scrollToTop(0,!1)},UpdateMarketPiecesToUI:function(e,t){for(var a=Def.CarItemType_Market(),i=this.panelPiece.getComponent(cc.ScrollView),n=i.content.childrenCount,o=0;o<n;o++){var c=null,r=t*n+o;null!=e&&r<e.length&&(c=e[r],e[r].price);var l=i.content.children[o].getComponent("UIItemPiece");l.SetInfo(a,r,c),l.node.opacity=255}i.scrollToTop(0,!1)},UpdateMarketFuelsToUI:function(e,t){for(var a=Def.CarItemType_Market(),i=this.panelFuel.getComponent(cc.ScrollView),n=i.content.childrenCount,o=0;o<n;o++){var c=null,r=t*n+o;null!=e&&r<e.length&&(c=e[r],e[r].price);var l=i.content.children[o].getComponent("UIItemFuel");l.SetInfo(a,r,c),l.node.opacity=255}i.scrollToTop(0,!1)}});cc._RF.pop()},{}],UIEvent:[function(e,t,a){"use strict";cc._RF.push(t,"be40ed4m8BOe7wbvVdcom2q","UIEvent");cc.Class({extends:cc.Component,properties:{panelEventList:{default:null,type:cc.Node},panelEventInfo:{default:null,type:cc.Node},svEventList:{default:null,type:cc.ScrollView},popupEventInfoDetail:{default:null,type:cc.Node},popupEventRaceReady:{default:null,type:cc.Node},panelRankingList:{default:null,type:cc.Node},srcItemEvent:{default:null,type:cc.Node},srcItemRanking:{default:null,type:cc.Node},lbPlayerCount:{default:null,type:cc.Label},lbEventTitle:{default:null,type:cc.Label},lbRewardTotal:{default:null,type:cc.Label},lbReward1:{default:null,type:cc.Label},lbRewardTimeRemain:{default:null,type:cc.Label},lbRaceDist:{default:null,type:cc.Label},lbRemainTime:{default:null,type:cc.Label},imgRewardExist:{default:null,type:cc.Node},imgEableRaceExists:{default:[],type:cc.Node},btnRankingPrev:{default:null,type:cc.Node},btnRankingNext:{default:null,type:cc.Node},lbRankingPage:{default:null,type:cc.Label}},eventCur:null,curCarID:null,curTabIndex:null,curRankingPage:null,eventInfos:null,timePrev:null,onLoad:function(){this.panelEventList.position=cc.Vec2.ZERO,this.panelEventInfo.position=cc.Vec2.ZERO,this.panelEventInfo.active=!1,this.popupEventInfoDetail.position=cc.Vec2.ZERO,this.popupEventInfoDetail.active=!1,this.popupEventRaceReady.position=cc.Vec2.ZERO,this.popupEventRaceReady.active=!1,this.curTabIndex=Def.EventGrade_EOS(),this.curRankingPage=0,this.eventInfos=[],this.timePrev=0,this.updateInterval=0},update:function(e){var t=Math.floor(.001*(new Date).getTime());if(this.panelEventInfo.active&&null!=this.eventCur&&void 0!=this.eventCur){var a=this.eventCur.info.timeEnd-t;this.lbRemainTime.string=Util.FormatTimeLeft(a,!0,!0),a=this.eventCur.info.timeRemove-t,this.lbRewardTimeRemain.string=LocalizeMng.GetText("text_reward_time_remain")+Util.FormatTimeLeft(a,!0,!0)}if(this.updateInterval+=e,this.updateInterval>3){this.updateInterval=0,0==this.timePrev&&(this.timePrev=t-3);for(var i=!1,n=0;n<this.eventInfos.length;n++){var o=this.eventInfos[n];if(o.timeRemove<t&&o.timeRemove>=this.timePrev||o.timeBegin<t&&o.timeBegin>=this.timePrev){i=!0;break}}this.timePrev=t,i&&this.UpdateEventDatasToUI()}},UpdateEventDatasToUI:function(){var e=Math.floor(.001*(new Date).getTime()),t=[!1,!1,!1,!1,!1];this.eventInfos=[];for(var a=0;a<BCDEvent.GetDataCount();a++){var i=BCDEvent.GetData(a);if(this.eventInfos.push(i.info),!(e<i.info.timeBegin-3600*i.info.previewHour||e>i.info.timeEnd)){var n=i.mapPlayer.get(BCDAccount.Name());if(!(0==i.info.allowEnterAgain&&void 0!=n||i.players.length>=i.info.entryLimit&&(0==i.info.allowEnterAgain||void 0==n))){var o=i.info.grade;o>Def.EventGrade_Special_DropCar()&&(o=Def.EventGrade_Special_DropCar()),t[o]=!0}}}for(a=0;a<this.imgEableRaceExists.length;a++)this.imgEableRaceExists[a].active=t[a];if(this.UpdateEventDatasToTab(this.curTabIndex),this.UpdateEventRewardsExist(),this.panelEventInfo.active&&null!=this.eventCur){var c=BCDEvent.GetDataById(this.eventCur.id);this.ShowPage_EventInfo(c),this.popupEventRaceReady.active=!1}},UpdateEventDatasToTab:function(e){for(var t=Math.floor(.001*(new Date).getTime()),a=[],i=[],n=[],o=0;o<BCDEvent.GetDataCount();o++){if(!(t<(p=BCDEvent.GetData(o)).info.timeBegin-3600*p.info.previewHour)){if(e>=Def.EventGrade_Special_DropCar()){if(p.info.grade<e)continue}else if(p.info.grade!=e)continue;t<p.info.timeEnd?t>=p.info.timeBegin?p.info.allowEnterAgain||void 0==p.mapPlayer.get(BCDAccount.Name())?a.push(p):n.push(p):i.push(p):n.push(p)}}var c=a.sort(function(e,t){return e.info.timeEnd<t.info.timeEnd?-1:1}),r=i.sort(function(e,t){return e.info.timeBegin<t.info.timeBegin?-1:1}),l=n.sort(function(e,t){return void 0!=e.mapPlayer.get(BCDAccount.Name())?-1:1}),s=c.concat(r);s=s.concat(l),Util.AdjustScrollViewItems(this.svEventList.content,s.length,1,this.srcItemEvent);for(o=0;o<s.length;o++){var u=this.svEventList.content.children[o].getComponent("UIItemEvent"),p=s[o];u.SetInfo(p)}this.svEventList.scrollToTop(0,!1)},UpdateEventRewardsExist:function(){var e=BCDUser.GetRewardCount();this.imgRewardExist.active=e>0},ShowPage_EventList:function(){this.panelEventList.active=!0,this.panelEventInfo.active=!1,this.popupEventRaceReady.active=!1},ShowPage_EventInfo:function(e){this.panelEventList.active=!1,this.panelEventInfo.active=!0,this.eventCur=e,this.lbEventTitle.string=e.info.title,this.lbPlayerCount.string=e.players.length;var t=e.info.grade==Def.EventGrade_Special_Trophy()?4:e.info.prizeVar,a=Util.CalcEventPrize(e.info,0,e.players.length);this.lbRewardTotal.string=Util.FormatEventPrize(e.info.prizeType,a,t);var i=Util.CalcEventPrize(e.info,1,e.players.length);this.lbReward1.string=Util.FormatEventPrize(e.info.prizeType,i,t);var n=Math.floor(.001*(new Date).getTime());if(this.lbRewardTimeRemain.node.active=n>=e.info.timeEnd,this.lbRaceDist.string=e.info.extendRaceDist?"6 km":"3 km",this.curCarID=0,void 0!=(f=e.mapPlayer.get(BCDAccount.Name())))this.curCarID=f.carID;else{var o=Def.GetLocalStorageData_EventCarID_Grade(e.info.requiredCarGrade);if(0!=o&&0==e.info.requiredCarModel)void 0!=(r=BCDUser.GetCarInfoByID(o))&&0==r.marketKey&&(this.curCarID=o);if(0==this.curCarID)for(var c=0;c<BCDUser.GetCarCount();c++){var r;if(0==(r=BCDUser.GetCarInfo(c)).marketKey)if(!((p=BCDUser.GetGradeCur())<e.info.requiredUserGradeMin||p>e.info.requiredUserGradeMax))if(0!=e.info.requiredCarModel){if(r.model==e.info.requiredCarModel){this.curCarID=r.id;break}}else{if(0==e.info.requiredCarGrade){this.curCarID=r.id;break}var l=Util.ParseCarModel_Grade(r.model);if(e.info.requiredCarGrade<10){if(l<=e.info.requiredCarGrade){this.curCarID=r.id;break}}else if(e.info.requiredCarGrade<20&&l==e.info.requiredCarGrade%10){this.curCarID=r.id;break}}}}var s=this.panelEventInfo.getComponentInChildren("UIItemRace"),u=null;u=e.info.grade==Def.EventGrade_Special_DropCar()?Util.GenerateEventCar(e.info):BCDUser.GetCarInfoByID(this.curCarID),s.SetInfo_Common(u,e.id);var p,d=!1,h=0;if((e.info.grade==Def.EventGrade_Special_DropCar()||0!=this.curCarID)&&((p=BCDUser.GetGradeCur())>=e.info.requiredUserGradeMin&&p<=e.info.requiredUserGradeMax&&(n=Math.floor(.001*(new Date).getTime()))>=e.info.timeBegin&&n<e.info.timeEnd)){var f=e.mapPlayer.get(BCDAccount.Name()),g=e.players.length>=e.info.entryLimit;if(e.info.allowEnterAgain){if(void 0!=f||0==g){d=!0;for(c=0;c<e.rankings.length;c++){var C=e.rankings[c].value;if(C.user==BCDUser.AccountName()){h=C.timeFinal/1e3;break}}}}else void 0==f&&0==g&&(d=!0)}s.EnableStartButton(d),s.ShowRaceTime(h),this.curRankingPage=0,this.UpdateEventRankingsToUI(e,this.curRankingPage)},UpdateEventRankingsToUI:function(e,t){var a=this.panelRankingList.getComponent(cc.ScrollView);Util.AdjustScrollViewItems(a.content,25,1,this.srcItemRanking);for(var i=0;i<25;i++){var n=25*t+i+1;a.content.children[i].getComponent("UIItemRace").SetInfo_Event(e,n)}if(a.scrollToTop(0,!1),e.rankings.length<=25)this.btnRankingNext.active=!1,this.btnRankingPrev.active=!1,this.lbRankingPage.node.active=!1;else{if(0==t)this.btnRankingNext.active=e.rankings.length>25,this.btnRankingPrev.active=!1;else{var o=Math.floor(e.rankings.length/25);this.btnRankingNext.active=t<o,this.btnRankingPrev.active=!0}this.lbRankingPage.node.active=!0,this.lbRankingPage.string=String(t+1)}},PopupEventInfoDetail:function(e){(this.popupEventInfoDetail.active=!!e,e)&&this.popupEventInfoDetail.getComponent("UIPopupEventInfo").UpdateEventDataToUI(e)},UpdateCarInfoToUI_Ready:function(e){e.id>0&&BCDUser.SelectCarByID(e.id),this.UpdateCarInfoToUI(e)},UpdateCarInfoToUI:function(e){this.popupEventRaceReady.getComponent("UIPopupEventRaceReady").UpdateDataToUI(this.eventCur,e)},onClick_ShowPopupReadyRace:function(e,t){Def.gameMng.SetPracticeRace("practice"==t),this.popupEventRaceReady.active=!0;var a=null;a=this.eventCur.info.grade==Def.EventGrade_Special_DropCar()?Util.GenerateEventCar(this.eventCur.info):BCDUser.GetCarInfoByID(this.curCarID),this.UpdateCarInfoToUI_Ready(a)},onClick_ShowList:function(){this.ShowPage_EventList()},onClick_EventTab:function(e,t){this.curTabIndex=t,this.UpdateEventDatasToTab(t)},onClick_ShowReward:function(){Def.uiMain.ShowPopupReward(!0)},onClick_Refresh:function(){Def.scatterMng.getEventData(0)},onClick_ViewInfo:function(){Def.uiMain.ShowPopupEventInfo(this.eventCur)},onClick_UpdateRankingPage:function(e,t){var a=this.curRankingPage+Number(t);this.curRankingPage=Math.floor(a),this.UpdateEventRankingsToUI(this.eventCur,this.curRankingPage)}});cc._RF.pop()},{}],UIGarage:[function(e,t,a){"use strict";cc._RF.push(t,"5ae59dHB7NEvr/L8TcfU79s","UIGarage");cc.Class({extends:cc.Component,properties:{lbCarTotalCount:{default:null,type:cc.Label},lbPieceTotalCount:{default:null,type:cc.Label},btnExpandGarage:{default:null,type:cc.Button}},UpdateInfosToUI:function(){this.node.getComponent("UICarAsset").UpdateGarageDatasToUI(),this.UpdateTotalCount()},UpdateTotalCount:function(){var e=Util.PadNumber(BCDUser.GetCarCount(),2),t=Util.PadNumber(BCDUser.GetCarSpaceCount(),2);this.lbCarTotalCount.string=e+" / "+t,this.lbPieceTotalCount.string=BCDUser.GetPieceCount()+" / 45",BCDUser.GetCarSpaceCount()==Def.MaxCarSpace()&&(this.btnExpandGarage.node.active=!1)},ExpandGarage:function(){BCDUser.GetCarSpaceCount()<Def.MaxCarSpace()&&Def.uiMain.ShowPopupExpandGarage(!0)}});cc._RF.pop()},{}],UIInfo:[function(e,t,a){"use strict";cc._RF.push(t,"1b615tubXVIirwbgIMFufSp","UIInfo");cc.Class({extends:cc.Component,properties:{iconGrades:{default:[],type:cc.Node},lbGradeName:{default:null,type:cc.Label},lbGradeDesc:{default:null,type:cc.Label},lbAwardingCount:{default:null,type:cc.Label},lbPrizeTotal:{default:null,type:cc.Label},lbPrizeNext:{default:null,type:cc.Label},lbInfo1st:{default:null,type:cc.Label},lbInfo2nd:{default:null,type:cc.Label},lbInfo3rd:{default:null,type:cc.Label},lbInfoETC:{default:null,type:cc.Label},lbRecommended:{default:null,type:cc.Label},tiRecommended:{default:null,type:cc.EditBox},btnRecommend:{default:null,type:cc.Button}},UpdateDataToUI:function(){for(var e=BCDUser.GetGradeCur(),t=0;t<this.iconGrades.length;t++)this.iconGrades[t].active=t==e;this.lbGradeName.string=LocalizeMng.GetText("txt_user_grade_"+e),this.lbGradeDesc.string=LocalizeMng.GetText("txt_user_grade_desc_"+e);var a=BCDUser.data.summary.win1,i=BCDUser.data.summary.win2,n=BCDUser.data.summary.win3,o=BCDUser.data.summary.winETC,c=a+i+n,r=LocalizeMng.GetText("txt_award_times");this.lbAwardingCount.string=c+LocalizeMng.GetText("txt_award_prize1")+a+LocalizeMng.GetText("txt_award_prize2");var l=BCDUser.data.summary.tokenEarnPrize,s=Util.MakeTokenSymbol(l/1e4);if(this.lbPrizeTotal.string=LocalizeMng.GetText("txt_award_total_prize")+s,e<BCDGame.GetUserGradeMax()){var u=BCDGame.GetUserGradeStd(e+1),p=Util.MakeTokenSymbol((u-l)/1e4);this.lbPrizeNext.node.active=!0,this.lbPrizeNext.string=LocalizeMng.GetText("txt_award_total_prize_next")+p}else this.lbPrizeNext.node.active=!1;this.lbInfo1st.string=LocalizeMng.GetText("txt_award_rank_1")+a+r,this.lbInfo2nd.string=LocalizeMng.GetText("txt_award_rank_2")+i+r,this.lbInfo3rd.string=LocalizeMng.GetText("txt_award_rank_3")+n+r,this.lbInfoETC.string=LocalizeMng.GetText("txt_award_rank_ETC")+o+r;var d=BCDUser.GetRecommended();this.lbRecommended.string=d,this.tiRecommended.string=d,this.btnRecommend.interactable=""==d,this.tiRecommended.node.active=""==d,this.lbRecommended.node.active=""!=d},onClick_Recommend:function(){var e=this.tiRecommended.string;""!=e?e!=BCDUser.AccountName()?Def.scatterMng.RecommendUser(e):Def.uiMain.ShowToastPopupMsg("toastmsg_warning_not_allowed_recommend_self"):Def.uiMain.ShowToastPopupMsg("toastmsg_warning_input_recommended_account")},onClick_Close:function(){this.node.active=!1}});cc._RF.pop()},{}],UIItemCarLarge:[function(e,t,a){"use strict";cc._RF.push(t,"4f39aY5b/lO54l+uVgvWF2O","UIItemCarLarge");cc.Class({extends:cc.Component,properties:{lbName:{default:null,type:cc.Label},lbSpeed:{default:null,type:cc.Label},lbLevel:{default:null,type:cc.Label},lbWinCount:{default:null,type:cc.Label},imgSale:{default:null,type:cc.Node},carImg:{default:null,type:cc.Sprite},imgTiers:{default:[],type:cc.Sprite}},car:null,SetInfo:function(e){var t=Util.ParseCarModel_Grade(e.model),a=(BCDGame.GetCarGradeInfo(t),Util.GetCarModelInfo(e.model));this.car=e,Util.PadName(this.lbName,a.name,15),this.lbSpeed.string=String(e.speed),this.lbLevel.string=String(e.level),this.lbWinCount.node.active=!0,0==e.winCount&&(this.lbWinCount.node.active=!1),this.lbWinCount.string=e.winCount,this.imgSale.active=0!=e.marketKey,Util.LoadTexture_Car(this.carImg,e.model,Def.CarImageType_Side(),e.color,"");t=Util.ParseCarModel_Grade(e.model);Util.SetGradeRes(t,this.imgTiers)},onClick_ViewInfo:function(){Def.uiMain.ShowPopupCarInfo(this.car)}});cc._RF.pop()},{}],UIItemCar:[function(e,t,a){"use strict";cc._RF.push(t,"769c6BZCmpJjrWqZuB7KiFK","UIItemCar");cc.Class({extends:cc.Component,properties:{panelEmpty:{default:null,type:cc.Node},panelValid:{default:null,type:cc.Node},panelLock:{default:null,type:cc.Node},lbRegAccount:{default:null,type:cc.Label},lbCarName:{default:null,type:cc.Label},lbPrice:{default:null,type:cc.Label},carImg:{default:null,type:cc.Sprite},imgGradeBox:{default:[],type:cc.Sprite},panelCarInfo:{default:null,type:cc.Node},lbCarLevel:{default:null,type:cc.Label},lbCarSpeed:{default:null,type:cc.Label},sprKm:{default:null,type:cc.Sprite},lbCarName2:{default:null,type:cc.Label},lbCarWinCount:{default:null,type:cc.Label},imgWinCount:{default:null,type:cc.Node},imgLevel:{default:null,type:cc.Node},lbCarSpec:{default:null,type:cc.Label},sprCarSale:{default:null,type:cc.Sprite},sprSelBox:{default:null,type:cc.Sprite},lbExpires:{default:null,type:cc.Label},btnBuy:{default:null,type:cc.Node},btnUnReg:{default:null,type:cc.Node},animWait:{default:null,type:cc.Node}},carIndex:null,type:null,data:null,price:null,key:null,onLoad:function(){},GetModel:function(){return this.data.model},ShowSelBox:function(e){this.sprSelBox.node.active=e},SetInfo:function(e,t,a,i){if(this.type=e,this.carIndex=t,this.data=a,this.price=i,null!=this.data){var n=this.data.model,o=Util.ParseCarModel_Grade(n),c=0;this.type!=Def.CarItemType_FilterSort()&&this.type!=Def.CarItemType_PurchasePiece()?(this.lbCarWinCount.node.active=!0,this.imgWinCount.active=!0,this.lbCarLevel.node.active=!0,this.imgLevel.active=!0,this.lbCarLevel.string=this.data.level,this.lbCarSpeed.string=this.data.speed,this.lbCarWinCount.string=this.data.winCount,c=this.data.color):(this.lbCarWinCount.node.active=!1,this.imgWinCount.active=!1,this.lbCarLevel.node.active=!1,this.imgLevel.active=!1),Util.LoadTexture_Car(this.carImg,n,Def.CarImageType_Side(),c,"",this.animWait),Util.SetGradeRes(o,this.imgGradeBox),void 0!=a.date&&Util.PrintExpires(this.lbExpires,a.date),this.type==Def.CarItemType_Garage()||this.type==Def.CarItemType_Select()?(this.panelLock.active=!1,"0"!=this.data.marketKey?(this.sprKm.node.active=!1,this.sprCarSale.node.active=!0):(this.sprKm.node.active=!0,this.sprCarSale.node.active=!1),this.lbCarName.node.active=!1,this.sprSelBox.node.active=!1,this.panelCarInfo.active=!0):this.type==Def.CarItemType_Market()?(this.lbPrice.string=i,this.lbRegAccount.string=a.owner,this.lbCarName2.string=Util.CarNameByModel(n,17),this.btnBuy.active=!0,this.btnUnReg.active=!1,this.panelCarInfo.active=!0):this.type==Def.CarItemType_FilterSort()||this.type==Def.CarItemType_PurchasePiece()?(this.lbCarSpeed.node.active=!1,this.sprKm.node.active=!1,this.sprCarSale.node.active=!1,this.lbCarName.string=Util.CarNameByModel(n,15),this.lbCarName.node.active=!0,this.sprSelBox.node.active=!1,this.panelCarInfo.active=!0):this.type==Def.CarItemType_OnSale()&&(this.lbPrice.string=i,this.lbRegAccount.string=a.owner,this.lbCarName2.string=Util.CarNameByModel(n,17),this.btnBuy.active=!1,this.btnUnReg.active=!0,this.panelCarInfo.active=!0),this.panelEmpty.active=!1,this.panelValid.active=!0}else if(this.type==Def.CarItemType_Market()||this.type==Def.CarItemType_OnSale()||(this.panelCarInfo.active=!1,this.sprCarSale.node.active=!1,this.sprSelBox.node.active=!1),this.panelEmpty.active=!0,this.panelValid.active=!1,this.type==Def.CarItemType_Garage()){var r=BCDUser.data.carSpaceCount;this.panelLock.active=r-1<t}},onClicked:function(){if(this.type==Def.CarItemType_Garage()){if(this.carIndex>-1&&this.carIndex<BCDUser.GetCarCount()&&"0"==this.data.marketKey){var e=BCDUser.GetCarInfo(this.carIndex);Def.uiMain.ShowPopupCarInfo(e)}}else if(this.type==Def.CarItemType_Select()){BCDUser.SelectCar(this.carIndex);e=BCDUser.GetSelectedCarInfo();Def.uiMain.ShowPopupCarSelect(!1,0,0),Def.uiMain.RefreshEventReadyUI(e)}else this.type==Def.CarItemType_FilterSort()?(this.sprSelBox.node.active=!0,Def.uiMain.UpdateSelectedCar(this.carIndex)):this.type==Def.CarItemType_PurchasePiece()&&(this.sprSelBox.node.active=!0,Def.uiMain.UpdatePurchasePieceSelect(this.data.model))},onClick_Buy:function(){var e=this.data.owner;e!=BCDAccount.Name()&&Def.scatterMng.BuyCarFromMarket(e,this.data.marketKey,this.price)},onClick_UnReg:function(){this.data.owner==BCDAccount.Name()&&Def.scatterMng.UnregCarFromMarket(this.data.id)},onClick_ExpandGarage:function(){Def.uiMain.ShowPopupExpandGarage(!0)},onClick_ShowCarInfo:function(){Def.uiMain.ShowPopup_MarketCarInfo(this.data)}});cc._RF.pop()},{}],UIItemEvent:[function(e,t,a){"use strict";cc._RF.push(t,"d6d07gQnZlGVLToRg2HQWAK","UIItemEvent");cc.Class({extends:cc.Component,properties:{lbInfo:{default:null,type:cc.Label},lbJoinRequired1:{default:null,type:cc.Label},lbJoinRequired2:{default:null,type:cc.Label},lbJoinCount:{default:null,type:cc.Label},iconEOS:{default:null,type:cc.Node},iconFuel:{default:null,type:cc.Node},iconTrophy:{default:null,type:cc.Node},lbConsume:{default:null,type:cc.Label},iconPrizes:{default:[],type:cc.Node},lbPrizeAmount:{default:null,type:cc.Label},btnAction:{default:null,type:cc.Button},lbAction:{default:null,type:cc.Label},lbEndTime:{default:null,type:cc.Label},iconCompleted:{default:null,type:cc.Node}},data:null,enableRace:null,SetInfo:function(e){return this.data=e,this.UpdateDataToUI()},UpdateDataToUI:function(){self=this,this.btnAction.node.active=!0;var e=this.data.info,t=-1;e.prizeType==Def.RewardType_Token()?t=0:e.prizeType==Def.RewardType_Fuel()?t=1:e.prizeType==Def.RewardType_Piece()?t=e.grade==Def.EventGrade_Special_Trophy()?6:2+e.prizeVar:e.prizeType==Def.RewardType_Car()&&(t=7);for(var a=0;a<this.iconPrizes.length;a++)this.iconPrizes[a].active=a==t;this.lbInfo.string=e.title;var i="",n=Util.CalcEventPrize(e,0,this.data.players.length);if(e.prizeType==Def.RewardType_Token())i=Util.FormatEventPrize(e.prizeType,n);else if(e.prizeType==Def.RewardType_Piece()&&0!=e.prizeVar){i="T"+(e.grade==Def.EventGrade_Special_Trophy()?4:e.prizeVar)+":"+String(n)}else i=String(n);this.lbPrizeAmount.string=i;var o="";if(e.grade==Def.EventGrade_Special_DropCar())o=LocalizeMng.GetText("txt_no_limit");else if(0!=e.requiredCarModel){var c=Util.GetCarModelInfo(e.requiredCarModel);o=LocalizeMng.GetText("txt_only_model")+c.name}else 0==e.requiredCarGrade?o=LocalizeMng.GetText("txt_no_limit_tier"):e.requiredCarGrade<10?o=LocalizeMng.GetText("txt_under_tier")+e.requiredCarGrade:e.requiredCarGrade<20&&(o=LocalizeMng.GetText("txt_only_tier")+e.requiredCarGrade%10);this.lbJoinRequired1.string=o,e.requiredUserGradeMin==e.requiredUserGradeMax?this.lbJoinRequired2.string=Util.GetUserGradeString(e.requiredUserGradeMax):this.lbJoinRequired2.string=Util.GetUserGradeString(e.requiredUserGradeMin)+" ~ "+Util.GetUserGradeString(e.requiredUserGradeMax),this.lbEndTime.string="",this.enableRace=!0;var r=!1,l=new Date,s=Math.floor(l.getTime()/1e3);(s>e.timeEnd||s<e.timeBegin)&&(this.enableRace=!1);var u=BCDUser.GetGradeCur();(u<e.requiredUserGradeMin||u>e.requiredUserGradeMax)&&(this.enableRace=!1);var p=this.data.mapPlayer.get(BCDAccount.Name());void 0!=p&&(0==this.data.info.allowEnterAgain&&(this.enableRace=!1),r=!0);var d="unlimited";e.entryLimit>0&&(d=String(e.entryLimit),void 0==p&&this.data.players.length>=e.entryLimit&&(this.enableRace=!1)),this.lbJoinCount.string=d;var h=Util.EventNeedEnterFee(e),f=e.grade==Def.EventGrade_Special_Trophy();this.iconEOS.active=h,this.iconTrophy.active=f,this.iconFuel.active=0==h&&0==f&&e.fuelConsume>0;var g,C,m=e.fuelConsume;(h||f)&&(m=e.enterFeeOrTrophy,h&&(m/=1e4)),this.lbConsume.node.active=m>0,this.lbConsume.string=-m;var v=!1;return this.enableRace?(g=new cc.Color(80,110,245,255),C="txt_race",v=!0):s<e.timeBegin?(g=new cc.Color(32,192,32,255),C="txt_incoming",v=!0):(g=new cc.Color(255,64,64,255),C="txt_view_info",v=!1),Util.SetBtnColor(this.btnAction,g),this.lbAction.string=LocalizeMng.GetText(C),this.lbEndTime.node.active=v,this.iconCompleted.active=r,this.enableRace},update:function(e){if(null!=this.data&&this.lbEndTime.node.active){var t=Number(.001*(new Date).getTime()),a=0;a=t<this.data.info.timeBegin?this.data.info.timeBegin-t:this.data.info.timeEnd-t,this.lbEndTime.string=Util.FormatTimeLeft(a,!0,!0)}},onClick_Action:function(){Def.uiMain.UpdateEventInfoToUI(this.data)},onClick_ViewInfo:function(){Def.uiMain.ShowPopupEventInfo(this.data)}});cc._RF.pop()},{}],UIItemFuel:[function(e,t,a){"use strict";cc._RF.push(t,"e8298LU4XxIUp41/iL8AnU3","UIItemFuel");cc.Class({extends:cc.Component,properties:{panelEmpty:{default:null,type:cc.Node},panelValid:{default:null,type:cc.Node},lbRegAccount:{default:null,type:cc.Label},lbTotalPrice:{default:null,type:cc.Label},lbUnitPrice:{default:null,type:cc.Label},lbQuantity:{default:null,type:cc.Label},lbExpires:{default:null,type:cc.Label},btnBuy:{default:null,type:cc.Node},btnUnReg:{default:null,type:cc.Node}},type:null,data:null,index:null,onLoad:function(){},SetInfo:function(e,t,a){if(this.type=e,this.data=a,this.index=t,null!=a){this.panelEmpty.active=!1,this.panelValid.active=!0,this.lbQuantity.string="x "+a.count,this.lbRegAccount.string=a.owner,this.lbTotalPrice.string=String(a.price);var i=Util.ParseTokenSymbol(a.price),n=Util.MakeTokenSymbol(i/a.count);this.lbUnitPrice.string="("+n+")",void 0!=a.date&&Util.PrintExpires(this.lbExpires,a.date),this.type==Def.CarItemType_Market()?(this.btnBuy.active=!0,this.btnUnReg.active=!1):this.type==Def.CarItemType_OnSale()&&(this.btnBuy.active=!1,this.btnUnReg.active=!0)}else this.panelEmpty.active=!0,this.panelValid.active=!1},onClick_Buy:function(){this.data.owner!=BCDAccount.Name()&&Def.scatterMng.BuyFuelFromMarket(this.data.owner,this.data.key,this.data.price)},onClick_UnReg:function(){Def.scatterMng.UnregFuelFromMarket(this.data.key)}});cc._RF.pop()},{}],UIItemPiece:[function(e,t,a){"use strict";cc._RF.push(t,"8befdhmKb1AyaPWrygsxA4n","UIItemPiece");cc.Class({extends:cc.Component,properties:{panelEmpty:{default:null,type:cc.Node},panelValid:{default:null,type:cc.Node},lbRegAccount:{default:null,type:cc.Label},lbCarName:{default:null,type:cc.Label},lbTotalPrice:{default:null,type:cc.Label},lbUnitPrice:{default:null,type:cc.Label},panelPieceInfo:{default:null,type:cc.Node},carPieceImg:{default:null,type:cc.Sprite},imgGradeBox:{default:[],type:cc.Sprite},imgQuantityDisable:{default:null,type:cc.Sprite},imgMaxQuantityBg:{default:null,type:cc.Sprite},lbQuantity:{default:null,type:cc.Label},lbCarName2:{default:null,type:cc.Label},lbExpires:{default:null,type:cc.Label},btnBuy:{default:null,type:cc.Node},btnUnReg:{default:null,type:cc.Node}},pieceIndex:null,type:null,data:null,key:null,onLoad:function(){},SetInfo:function(e,t,a){if(this.type=e,this.pieceIndex=t,this.data=a,null!=a){var i=this.data.model,n=Util.ParseCarModel_Grade(i),o=BCDGame.GetCarGradeInfo(n),c=a.count-a.marketDeposit;if(Util.LoadTexture_CarPiece(this.carPieceImg,i),Util.SetGradeRes(n,this.imgGradeBox),void 0!=a.date&&Util.PrintExpires(this.lbExpires,a.date),this.type==Def.CarItemType_Garage())c==Def.MaxPieceQuantity()?this.imgMaxQuantityBg.node.active=!0:(this.imgMaxQuantityBg.node.active=!1,this.imgQuantityDisable.node.active=o.asmPiece>c),this.lbCarName.string=Util.CarNameByModel(i,12),this.lbQuantity.string=""+c;else if(this.type==Def.CarItemType_Market()){this.key=a.key,(c=a.count)==Def.MaxPieceQuantity()?this.imgMaxQuantityBg.node.active=!0:(this.imgMaxQuantityBg.node.active=!1,this.imgQuantityDisable.node.active=o.asmPiece>c),this.lbQuantity.string=""+a.count,this.lbRegAccount.string=a.owner,this.lbCarName.string=Util.CarNameByModel(i,12),this.lbCarName2.string=Util.CarNameByModel(i,20),this.lbTotalPrice.string=String(a.price);var r=Util.ParseTokenSymbol(a.price),l=Util.MakeTokenSymbol(r/a.count);this.lbUnitPrice.string="("+l+")",this.btnBuy.active=!0,this.btnUnReg.active=!1}else if(this.type==Def.CarItemType_OnSale()){this.key=a.key,(c=a.count)==Def.MaxPieceQuantity()?this.imgMaxQuantityBg.node.active=!0:(this.imgMaxQuantityBg.node.active=!1,this.imgQuantityDisable.node.active=o.asmPiece>c),this.lbQuantity.string=""+a.count,this.lbRegAccount.string=a.owner,this.lbCarName.string=Util.CarNameByModel(i,12),this.lbCarName2.string=Util.CarNameByModel(i,20),this.lbTotalPrice.string=String(a.price);r=Util.ParseTokenSymbol(a.price),l=Util.MakeTokenSymbol(r/a.count);this.lbUnitPrice.string="("+l+")",this.btnBuy.active=!1,this.btnUnReg.active=!0}this.panelEmpty.active=!1,this.panelValid.active=!0}else this.panelEmpty.active=!0,this.panelValid.active=!1},onClicked:function(){this.type==Def.CarItemType_Garage()&&this.pieceIndex>-1&&this.pieceIndex<BCDUser.GetPieceCount()&&(BCDUser.SelectPiece(this.pieceIndex),Def.uiMain.ShowPopupPieceInfo(!0)),this.type==Def.CarItemType_Market()&&this.pieceIndex>-1&&null!=this.data&&Def.uiMain.ShowPopupPieceInfo(!0,this.type,this.data)},onClick_Buy:function(){this.data.owner!=BCDAccount.Name()&&Def.scatterMng.BuyPieceFromMarket(this.data.owner,this.data.key,this.data.price)},onClick_UnReg:function(){this.data.owner==BCDAccount.Name()&&Def.scatterMng.UnregPieceFromMarket(this.data.model,this.data.key)}});cc._RF.pop()},{}],UIItemRace:[function(e,t,a){"use strict";cc._RF.push(t,"fe67f1SKB5I5oQeX4qy0D2m","UIItemRace");cc.Class({extends:cc.Component,properties:{nodeStart:{default:null,type:cc.Node},nodeRetry:{default:null,type:cc.Node},nodeWinImg:{default:null,type:cc.Node},nodeReplay:{default:null,type:cc.Node},nodePractice:{default:null,type:cc.Node},nodePrize:{default:null,type:cc.Node},imgPrizeType:{default:[],type:cc.Node},lbPrizeAmount:{default:null,type:cc.Label},nodeMatchReplay:{default:null,type:cc.Node},nodeEmptyCover:{default:null,type:cc.Node},iconGrades:{default:[],type:cc.Node},lbName:{default:null,type:cc.Label},lbTime:{default:null,type:cc.Label},lbTimeDiff:{default:null,type:cc.Label},lbSpeed:{default:null,type:cc.Label},imgSpeedUnit:{default:null,type:cc.Node},carImgNotExist:{default:null,type:cc.Node},carImg:{default:null,type:cc.Sprite},imgGradeBox:{default:[],type:cc.Sprite},lbCarName:{default:null,type:cc.Label},lbCarLevel:{default:null,type:cc.Label},iconRanks:{default:[],type:cc.Node},lbRank:{default:null,type:cc.Label}},matchIndex:null,data:null,raceUser:null,raceID:null,eventID:null,SetInfo_Match:function(e,t){this.data=t,this.SetInfo_Common(t,0),this.matchIndex=e,this.nodeStart.active=!1,this.nodeRetry.active=!1,this.nodeWinImg.active=!1,this.nodeReplay.active=!1,this.nodeEmptyCover.active=!1;for(var a=0;a<this.iconRanks.length;a++)this.iconRanks[a].active=!1;this.lbRank.node.active=!1,this.nodeMatchReplay.active=0!=t.raceID,this.nodePractice.active=!0,this.nodePrize.active=!1;var i=BCDUser.GetMatchStats(),n=BCDUser.GetMatchTimeLatest(),o=BCDUser.GetMatchPoolRaceIndex(),c=i>>2*e&3,r=Def.MatchStat_Enable();n>BCDGame.GetMatchPoolUpdatedTime()&&(e==o?r=Def.MatchStat_Ing():c==Def.MatchBit_Lose()?r=Def.MatchStat_Lose():c==Def.MatchBit_Win()&&(r=Def.MatchStat_Win()));var l=0;if(r==Def.MatchStat_Enable()||r==Def.MatchStat_Ing())this.nodeStart.active=!0;else{var s=Def.GetLocalStorageData_MatchRecord(e);0!=s&&(l=s-t.timeFinal),r==Def.MatchStat_Win()?this.nodeWinImg.active=!0:r==Def.MatchStat_Lose()&&(this.nodeRetry.active=!0)}this.lbTimeDiff.node.active=0!=l,0!=l&&(this.lbTimeDiff.string=Util.FormatTimeDiff(.001*l)),this.lbTimeDiff.node.color=l<0?new cc.Color(96,255,96,255):new cc.Color(255,96,96,255)},SetInfo_Event:function(e,t){var a=t-1;this.data=a<e.rankings.length?e.rankings[a].value:null,this.nodeEmptyCover.active=null==this.data||void 0==this.data,this.SetInfo_Common(this.data,e.id),this.nodeStart.active=!1,this.nodeRetry.active=!1,this.nodeWinImg.active=!1,this.nodeReplay.active=!0,this.nodePractice.active=!1,this.iconRanks[0].active=t>=4;for(var i=1;i<this.iconRanks.length;i++)this.iconRanks[i].active=i==t;this.lbRank.node.active=!0,this.lbRank.string=String(t);for(i=0;i<this.imgPrizeType.length;i++)this.imgPrizeType[i].active=i==e.info.prizeType;var n=e.players.length,o=Util.CalcEventPrize(e.info,t,n);if(o>0||"string"==typeof o){if(o>0){if(e.info.grade==Def.EventGrade_Special_EnterFee_Acc()){var c=e.rankings.length;1==c?o=Util.CalcEventPrize(e.info,0,n):2==c&&1==t&&(o+=Util.CalcEventPrize(e.info,3,n))}e.info.prizeType==Def.RewardType_Token()&&(o/=1e4)}this.nodePrize.active=!0,this.lbPrizeAmount.string=o}else this.nodePrize.active=!1},SetInfo_Common:function(e,t){for(var a=0;a<this.iconGrades.length;a++)this.iconGrades[a].active=!1;if(null==e||void 0==e)this.lbName.string="no vehicle",this.lbTime.node.active=!1,this.lbSpeed.node.active=!1,this.imgSpeedUnit.active=!1,this.carImgNotExist.active=!0,this.carImg.node.active=!1,this.raceID=0,this.eventID=0;else{void 0!=e.userGrade&&e.userGrade>=0&&e.userGrade<this.iconGrades.length&&(this.iconGrades[e.userGrade].active=!0);var i=e.model;void 0!=e.user?this.lbName.string=e.user:void 0!=e.owner&&(this.lbName.string=e.owner),void 0!=e.timeFinal?(this.lbTime.node.active=!0,this.lbTime.string=Util.FormatTime(.001*e.timeFinal)):this.lbTime.node.active=!1,this.lbSpeed.node.active=!0,this.lbSpeed.string=e.speed,this.imgSpeedUnit.active=!0,this.carImgNotExist.active=!1,this.carImg.node.active=!0,Util.LoadTexture_Car(this.carImg,i,Def.CarImageType_Side(),e.color,""),this.raceUser=e.user,this.raceID=e.raceID,this.eventID=t;var n=Util.ParseCarModel_Grade(i);if(Util.SetGradeRes(n,this.imgGradeBox),this.lbCarName.string=Util.CarNameByModel(i,12),this.lbCarLevel.string=String(e.level),null!=t&&void 0!=t&&0!=t){var o=BCDEvent.GetDataById(t),c=o.mapPlayer.get(BCDAccount.Name()),r=-1;if(void 0!=c){var l=o.rankings.length;for(a=0;a<l;a++)if(o.rankings[a].value.user==BCDAccount.Name())r=a+1}var s=this.nodeStart.getComponentInChildren(cc.Label);if(s){var u="txt_challenge";o.info.allowEnterAgain&&void 0!=c&&(u="txt_challenge_again"),s.string=LocalizeMng.GetText(u)}this.iconRanks[0].active=r>=4;for(var p=1;p<this.iconRanks.length;p++)this.iconRanks[p].active=p==r;this.lbRank.node.active=r>0,this.lbRank.string=String(r)}}this.lbTimeDiff.node.active=!1},EnableStartButton:function(e){this.nodeStart.active=!0,this.nodeStart.getComponent(cc.Button).interactable=e},ShowRaceTime:function(e){this.lbTime.node.active=e>0,this.lbTime.string=Util.FormatTime(e)},onClick_StartMatchRace:function(){Def.gameMng.SetPracticeRace(!1),Def.scatterMng.BeginMatchRace(this.matchIndex)},onClick_EndMatchRaceForcely:function(){Def.scatterMng.EndMatchRace(4e4,8e4,12e4)},onClick_RetryMatchRace:function(){Def.gameMng.SetPracticeRace(!1),Def.scatterMng.BeginMatchRace(this.matchIndex)},onClick_ReplayRace:function(){Def.gameMng.ReplayRace(this.raceUser,this.raceID,this.eventID)},onClick_PracticeRace:function(){var e=BCDUser.GetSelectedCarInfo(),t=BCDMatchPool.GetData(this.matchIndex),a=.001*t.timeLap1,i=.001*t.timeLap2,n=.001*t.timeFinal;Def.gameMng.SetPracticeRace(!0);var o=Math.floor(1e3*Math.random());Def.gameMng.BeginRace(o,Def.RaceType_Match(),e,a,i,n)}});cc._RF.pop()},{}],UIItemReward:[function(e,t,a){"use strict";cc._RF.push(t,"7f372horjVJhLXfK1i7Mi9d","UIItemReward");cc.Class({extends:cc.Component,properties:{lbTitle:{default:null,type:cc.Label},lbRank:{default:null,type:cc.Label},lbReward:{default:null,type:cc.Label},iconRewards:{default:[],type:cc.Node},iconRanks:{default:[],type:cc.Node}},index:null,data:null,SetInfo:function(e,t){this.index=e,this.data=t,this.lbTitle.string=t.title,this.lbRank.string=t.ranking+LocalizeMng.GetText("txt_reqard_rank"),this.iconRanks[0].active=t.ranking>=4;for(var a=1;a<this.iconRanks.length;a++)this.iconRanks[a].active=a==t.ranking;for(a=0;a<this.iconRewards.length;a++)this.iconRewards[a].active=a==t.type;if(t.type==Def.RewardType_Token()||t.type==Def.RewardType_Fuel())this.lbReward.string=Util.FormatEventPrize(t.type,t.amount);else if(t.type==Def.RewardType_Piece()||t.type==Def.RewardType_Car()){var i=Util.GetCarModelInfo(t.model).name;t.type==Def.RewardType_Piece()&&(i+=" x "+t.amount),this.lbReward.string=i}},onClick_Reward:function(){Def.scatterMng.RecvEventReward(this.index)}});cc._RF.pop()},{}],UIItemStore:[function(e,t,a){"use strict";cc._RF.push(t,"9c2e3aicINOsbdNQqvdkrYV","UIItemStore");cc.Class({extends:cc.Component,properties:{lbTierInfo:{default:null,type:cc.Label},lbUnitPrice:{default:null,type:cc.Label},imgTiers:{default:[],type:cc.Node}},tier:null,SetInfo:function(e){this.tier=e;for(var t=0;t<this.imgTiers.length;t++)this.imgTiers[t].active=t+1==e;this.lbTierInfo.string=LocalizeMng.GetText("txt_piece_tier")+e;var a=BCDGame.GetCarGradeInfo(e);this.lbUnitPrice.string=Util.MakeTokenSymbol(a.piecePrice/1e4)},onClick_Buy:function(){Def.uiMain.ShowPopupPurchasePiece(this.tier)}});cc._RF.pop()},{}],UILogin:[function(e,t,a){"use strict";cc._RF.push(t,"17fb7CsfVFCNattI4gjtm16","UILogin");cc.Class({extends:cc.Component,properties:{btnLogin:{default:null,type:cc.Button},lbInfo:{default:null,type:cc.Label},imgPopup:{default:null,type:cc.Node},panelSelNode:{default:null,type:cc.Node},lbSelNodeName:{default:null,type:cc.Label},imgSelNodeSpeed:{default:null,type:cc.Node},llNodeNames:{default:[],type:cc.Label},imgNodeSpeeds:{default:[],type:cc.Node},btnLanguages:{default:[],type:cc.Button}},isTokenPocket:null,isMobile:null,nodeIndex:null,nodeSpeedColor:null,start:function(){this.lbInfo.node.active=!1,this.nodeIndex=0,this.nodeSpeedColor=new cc.Color,this.panelSelNode.active=!1,this.nodeIndex=Def.GetLocalStorageData_APINodeIndex(),(null==this.nodeIndex||void 0==this.nodeIndex||this.nodeIndex>=Def.APIEndPointHostCount())&&(this.nodeIndex=0),this.UpdateNodeNameToUI();for(var e=0;e<Def.APIEndPointHostCount();e++)this.llNodeNames[e].string=Def.APIEndPointName(e),this.UpdateNodeSpeedToUI(e);var t=Def.GetLocalStorageData_LanguageIndex();if(t>=0&&t<this.btnLanguages.length&&(this.btnLanguages[t].normalColor=new cc.Color(80,200,240,255)),null!=this.imgPopup){this.imgPopup.active=!0;var a=this;setTimeout(function(){a.closePopup()},5e3)}},UpdateNodeNameToUI:function(){this.lbSelNodeName.string=Def.APIEndPointName(this.nodeIndex)},UpdateNodeSpeedToUI:function(e){if(!(e<0||e>=Def.APIEndPointHostCount()||null==e||void 0==e)){var t=new Date,a=this.nodeIndex,i=new XMLHttpRequest,n="https://"+Def.APIEndPointHost(e)+":443/v1/chain/get_info",o=this;i.open("POST",n),i.setRequestHeader("accept","application/json"),i.send(null),i.onreadystatechange=function(){if(i.readyState==XMLHttpRequest.DONE){var c=1e4;if(200==i.status)c=(new Date).getTime()-t.getTime();if(console.log(n+" estimated : "+c+" mSec"),e<o.imgNodeSpeeds.length){var r=o.imgNodeSpeeds[e];c<200?r.color=new cc.Color(64,255,64,255):c<500?r.color=new cc.Color(255,255,64,255):c<1e3?r.color=new cc.Color(255,128,64,255):(e==a&&(Def.uiMain.ShowToastPopupMsg("toastmsg_warning_sel_node"),o.onClick_OpenSelectNode()),r.color=new cc.Color(255,32,32,255)),e==o.nodeIndex&&(o.imgSelNodeSpeed.color=r.color)}}}}},onClick_Login:function(){var e=Def.APIEndPointHost(this.nodeIndex);Def.scatterMng.Login(2,e)},onClick_Close:function(){this.node.active=!1},onClick_GotoCreateEOSAccount:function(e,t){cc.sys.openURL(t)},onClick_SelectLanguage:function(e,t){LocalizeMng.SaveLanguageAndRefreshPage(t)},onClick_OpenSelectNode:function(){this.panelSelNode.active=!0},onClick_SelectNode:function(e,t){Def.SetLocalStorageData_APINodeIndex(t),this.nodeIndex=t,t<this.imgNodeSpeeds.length&&(this.imgSelNodeSpeed.color=this.imgNodeSpeeds[t].color),this.UpdateNodeNameToUI(),this.panelSelNode.active=!1},closePopup:function(){this.imgPopup.active=!1}});cc._RF.pop()},{}],UIMain:[function(e,t,a){"use strict";cc._RF.push(t,"822fcbr36BFOp4QkcPHju1P","UIMain");cc.Class({extends:cc.Component,properties:{btnMarket:{default:null,type:cc.Button},btnGarage:{default:null,type:cc.Button},btnMatch:{default:null,type:cc.Button},btnEvent:{default:null,type:cc.Button},btnInfo:{default:null,type:cc.Button},uiNodeMarket:{default:null,type:cc.Node},uiNodeGarage:{default:null,type:cc.Node},uiNodeMatch:{default:null,type:cc.Node},uiNodeEvent:{default:null,type:cc.Node},uiNodeInfo:{default:null,type:cc.Node},uiNodeGarageOnSale:{default:null,type:cc.Node},labelAccount:{default:null,type:cc.Label},labelCPU:{default:null,type:cc.Label},labelBalance:{default:null,type:cc.Label},labelFuel:{default:null,type:cc.Label},labelEventTicket:{default:null,type:cc.Label},labelTrophy:{default:null,type:cc.Label},iconGrades:{default:[],type:cc.Node},panelLogin:{default:null,type:cc.Node},popupCarInfo:{default:null,type:cc.Node},popupCarSelect:{default:null,type:cc.Node},popupReward:{default:null,type:cc.Node},popupRewardResult:{default:null,type:cc.Node},popupPieceInfo:{default:null,type:cc.Node},popupMarketCarInfo:{default:null,type:cc.Node},popupTradeFuel:{default:null,type:cc.Node},popupFilterSort:{default:null,type:cc.Node},popupRaceResult:{default:null,type:cc.Node},popupExpandGarage:{default:null,type:cc.Node},popupResource:{default:null,type:cc.Node},popupPurchaseList:{default:null,type:cc.Node},popupSalesList:{default:null,type:cc.Node},popupAwardingRecord:{default:null,type:cc.Node},popupNews:{default:null,type:cc.Node},popupNotice:{default:null,type:cc.Node},popupPurchasePiece:{default:null,type:cc.Node},imgBlocked:{default:null,type:cc.Node},iconNewExist:{default:null,type:cc.Node}},uiMarket:null,uiGarage:null,uiMatch:null,uiEvent:null,uiInfo:null,uis:null,btns:null,onLoad:function(){Def.uiMain=this,this.node.position=cc.Vec2.ZERO,this.uiNodeMarket.position=cc.Vec2.ZERO,this.uiNodeGarage.position=cc.Vec2.ZERO,this.uiNodeMatch.position=cc.Vec2.ZERO,this.uiNodeEvent.position=cc.Vec2.ZERO,this.uiNodeInfo.position=cc.Vec2.ZERO,this.popupCarInfo.position=cc.Vec2.ZERO,this.popupCarSelect.position=cc.Vec2.ZERO,this.popupReward.position=cc.Vec2.ZERO,this.popupRewardResult.position=cc.Vec2.ZERO,this.popupPieceInfo.position=cc.Vec2.ZERO,this.popupMarketCarInfo.position=cc.Vec2.ZERO,this.popupTradeFuel.position=cc.Vec2.ZERO,this.popupFilterSort.position=cc.Vec2.ZERO,this.popupRaceResult.position=cc.Vec2.ZERO,this.popupExpandGarage.position=cc.Vec2.ZERO,this.popupResource.position=cc.Vec2.ZERO,this.popupPurchaseList.position=cc.Vec2.ZERO,this.popupSalesList.position=cc.Vec2.ZERO,this.popupAwardingRecord.position=cc.Vec2.ZERO,this.popupNews.position=cc.Vec2.ZERO,this.popupNotice.position=cc.Vec2.ZERO,this.panelLogin.position=cc.Vec2.ZERO,this.popupPurchasePiece.position=cc.Vec2.ZERO},start:function(){this.imgBlocked.active=!1,this.uiMarket=this.uiNodeMarket.getComponent("UIMarket"),this.uiGarage=this.uiNodeGarage.getComponent("UIGarage"),this.uiMatch=this.uiNodeMatch.getComponent("UIMatch"),this.uiEvent=this.uiNodeEvent.getComponent("UIEvent"),this.uiInfo=this.uiNodeInfo.getComponent("UIInfo"),this.uis=new Array,this.uis.push(this.uiNodeMarket),this.uis.push(this.uiNodeGarage),this.uis.push(this.uiNodeMatch),this.uis.push(this.uiNodeEvent),this.uis.push(this.uiNodeInfo),this.btns=new Array,this.btns.push(this.btnMarket),this.btns.push(this.btnGarage),this.btns.push(this.btnMatch),this.btns.push(this.btnEvent),this.btns.push(this.btnInfo),this.ShowUI(Def.UITab_None()),this.popupCarInfo.active=!1,this.popupCarSelect.active=!1,this.popupReward.active=!1,this.popupRewardResult.active=!1,this.popupPieceInfo.active=!1,this.popupMarketCarInfo.active=!1,this.popupTradeFuel.active=!1,this.popupFilterSort.active=!1,this.popupRaceResult.active=!1,this.popupExpandGarage.active=!1,this.popupResource.active=!1,this.popupPurchaseList.active=!1,this.popupSalesList.active=!1,this.popupAwardingRecord.active=!1,this.popupNews.active=!1,this.popupNotice.active=!1,this.panelLogin.active=!1,this.popupPurchasePiece.active=!1,this.InitToDefault()},InitToDefault:function(){this.labelAccount.string="",this.labelCPU.string="",this.labelBalance.string="",this.labelFuel.string="",this.labelEventTicket.string="",this.labelTrophy.string=""},UpdateUserStatus:function(){this.imgBlocked.active=BCDUser.IsBlocked()},ShowUI:function(e){for(var t=0;t<this.uis.length;t++)this.uis[t].active=t==e;var a=e>=0&&e<this.btns.length?e:Math.floor(this.btns.length/2),i=0;for(t=0;t<this.btns.length;t++){var n=this.btns[t].node.getComponent("BtnExpand");n&&(t==a?n.ChangeTargetToSel():n.ChangeTargetToNormal(),n.node.x=i+.5*n.node.width-.5*this.node.width,i+=n.node.width)}},ShowPopup_MarketCarInfo:function(e){null!=e&&void 0!=e?(this.popupMarketCarInfo.active=!0,this.popupMarketCarInfo.getComponent("UIPopupMarketCarInfo").UpdateCarInfoToUI(e)):this.popupMarketCarInfo.active=!1},ShowPopupCarInfo:function(e){null!=e&&void 0!=e?(this.popupCarInfo.active=!0,this.popupCarInfo.getComponent("UIPopupCar").UpdateCarInfoToUI(e)):this.popupCarInfo.active=!1},ShowPopupCarUpgradeResult:function(){this.popupCarInfo.getComponent("UIPopupCar").ShowUpgradeResult()},CheckOldCarLevel:function(){this.popupCarInfo.getComponent("UIPopupCar").CheckOldCarLevel()},ShowPopupCarDestroyResult:function(){this.popupCarInfo.getComponent("UIPopupCar").ShowCarDestroyResult()},ShowPopupEventInfo:function(e){this.uiEvent.PopupEventInfoDetail(e)},ShowPopupEventReady:function(e){this.uiEvent.PopupJoin(e)},RefreshEventReadyUI:function(e){this.uiEvent.UpdateCarInfoToUI_Ready(e)},ShowPopupCarSelect:function(e,t,a){(this.popupCarSelect.active=e,e)&&this.popupCarSelect.getComponent("UIPopupCarSelect").UpdateCarListToUI(t,a)},ShowPopupReward:function(e){(this.popupReward.active=e,e)&&this.popupReward.getComponent("UIPopupReward").UpdateRewardsToUI()},ShowPopupRewardResult:function(e){this.popupRewardResult.active=!0,this.popupRewardResult.getComponent("UIPopupRewardResult").SetInfo(e);var t=this.popupRewardResult;setTimeout(function(){t.active=!1},1e4)},UpdateEventRewardsExist:function(){this.uiEvent.UpdateEventRewardsExist()},UpdateSelectedCarInfoToUIs:function(){var e=BCDUser.GetCarInfo(BCDUser.GetSelectedCarIndex());this.uiEvent.UpdateCarInfoToUI(e)},ShowPopupPieceInfo:function(e,t,a){if(this.popupPieceInfo.active=e,e){var i=this.popupPieceInfo.getComponent("UIPopupPiece"),n=t!=Def.CarItemType_Market()?BCDUser.GetSelectedPiece():a;i.UpdatePieceInfoToUI(n)}},ShowPopupMakeCarResult:function(){this.popupPieceInfo.getComponent("UIPopupPiece").ShowMakeCarResult()},ShowPopupDisassemblePieceResult:function(e,t){this.popupPieceInfo.getComponent("UIPopupPiece").ShowDisassembleResult(e,t)},ShowPopupBuyFuel:function(e,t){(this.popupTradeFuel.active=e,e)&&this.popupTradeFuel.getComponent("UIPopupTradeFuel").ShowFuelBuyPanel(t)},ShowPopupSaleFuel:function(e){var t=BCDUser.GetFuelCount();1!=e||0!=t?(this.popupTradeFuel.active=e,e&&this.popupTradeFuel.getComponent("UIPopupTradeFuel").ShowFuelSalePanel()):Def.uiMain.ShowToastPopupMsg("toastmsg_check_fill_fuel")},ShowPopupFilterSort:function(e,t){(this.popupFilterSort.active=e,e)&&this.popupFilterSort.getComponent("UIPopupFilterSort").UpdatePanelFilterSortUI(t)},UpdateSelectedCar:function(e){this.popupFilterSort.getComponent("UIPopupFilterSort").UpdateSelectedCar(e)},GetFilterSort:function(){return this.popupFilterSort.getComponent("UIPopupFilterSort").GetFilterSort()},UpdatePurchasePieceSelect:function(e){this.popupPurchasePiece.getComponent("UIPopupPurchasePiece").UpdateSelectedPiece(e)},ShowPopupRaceResult:function(e){var t=this.popupRaceResult,a=t.getComponent("UIPopupRaceResult2");t.active=!0,a.SetInfo_Ready(),e==Def.RaceType_Match()?a.SetInfo_Match():e==Def.RaceType_Event()&&a.SetInfo_Event(),setTimeout(function(){t.active=!1},1e4)},UpdateOnSaleCarToUI:function(){this.uiNodeGarageOnSale.getComponent("UIOnSaleAsset").UpdateOnSaleCarToUI()},UpdateOnSalePieceToUI:function(){this.uiNodeGarageOnSale.getComponent("UIOnSaleAsset").UpdateOnSalePieceToUI()},UpdateOnSaleFuelToUI:function(){this.uiNodeGarageOnSale.getComponent("UIOnSaleAsset").UpdateOnSaleFuelToUI()},ShowPopupExpandGarage:function(e){(this.popupExpandGarage.active=e,e)&&this.popupExpandGarage.getComponent("UIPopupExpandGarage").ShowPopup(e)},ViewEqualItemAll:function(e,t){this.ShowUI(Def.UITab_Market()),null!=t&&(this.popupFilterSort.getComponent("UIPopupFilterSort").SetFilterSort(t),this.uiMarket.ApplyFilterSort(String(e)));var a=this.uiMarket.getComponent("UICarAsset");switch(a.isViewItemAll=!0,e){case 0:a.btnCar.isChecked=!0,this.popupCarInfo.getComponent("UIPopupCar").onClick_Cancel();break;case 1:a.btnPiece.isChecked=!0,this.popupPieceInfo.getComponent("UIPopupPiece").onClick_Cancel()}},onClick_GoFuelMarket:function(){this.ViewEqualItemAll(Def.MarketItemType_Fuel())},TouchButton:function(e){if(0!=Def.scatterMng.IsLogin()){var t=-1;if(e.target==this.btnMarket.node){t=0;var a=Def.scatterMng.getMarketData_Piece(i),i=Def.scatterMng.getMarketData_Fuel(n),n=function(){this.uiMarket.StateInit(),this.uiMarket.UpdateCarInfosToUI()};Def.scatterMng.getMarketData_Car(a)}else e.target==this.btnGarage.node?(t=1,Def.scatterMng.getUserData()):e.target==this.btnMatch.node?(t=2,Def.scatterMng.getMatchPoolData()):e.target==this.btnEvent.node?(t=3,Def.scatterMng.getEventData(0)):e.target==this.btnInfo.node&&(t=4,this.uiInfo.UpdateDataToUI(),null!=this.iconNewExist&&(this.iconNewExist.active=!1));t>=0&&this.ShowUI(t)}},UpdateAccountInfoToUI:function(){this.labelCPU.string=BCDAccount.data.cpu_limit.used+"/"+BCDAccount.data.cpu_limit.available},UpdateAccountBalanceToUI:function(){this.labelBalance.string=Util.ParseTokenSymbol(BCDAccount.balance)},UpdateUserAccountDatasToUI:function(){this.labelAccount.string=BCDUser.AccountName(),this.labelFuel.string=String(BCDUser.GetFuelCount()),this.labelEventTicket.string=String(BCDUser.GetEventTicketCount()),this.labelTrophy.string=String(BCDUser.GetTrophyCount());for(var e=BCDUser.GetGradeCur(),t=0;t<this.iconGrades.length;t++)this.iconGrades[t].active=t==e;this.uiGarage.UpdateInfosToUI(),this.uiMatch.UpdateMyCarsToUI()},UpdateMarketInfosToUI:function(e){e==Def.MarketItemType_Car()?this.uiMarket.UpdateCarInfosToUI():e==Def.MarketItemType_Piece()?this.uiMarket.UpdatePieceInfosToUI():e==Def.MarketItemType_Fuel()&&this.uiMarket.UpdateFuelInfosToUI()},UpdateMatchInfosToUI:function(){this.uiMatch.UpdateMatchDatasToUI()},UpdateEventInfosToUI:function(){this.uiEvent.UpdateEventDatasToUI()},UpdateEventInfoToUI:function(e){this.uiEvent.ShowPage_EventInfo(e)},ShowToastPopupMsg:function(e){Def.gameMng.toastPopupMsg.getComponent("UIToastPopupMsg").OuputMsg(e)},ShowPopupResource:function(e){if(null!=BCDAccount.data&&void 0!=BCDAccount.data&&(Def.gameMng.ShowMenuPanel(!1),this.popupResource.active=e,e)){var t=this.popupResource.getComponent("UIPopupResource");Def.scatterMng.getAccountData(function(){t.UpdateDataToUI()})}},ShowPopupAwardingRecord:function(e){null!=BCDAccount.data&&void 0!=BCDAccount.data&&(Def.gameMng.ShowMenuPanel(!1),this.popupAwardingRecord.active=e,e&&this.popupAwardingRecord.getComponent("UIPopupAwardingRecord").UpdateDataToUI())},ShowPopupNews:function(e){null!=BCDAccount.data&&void 0!=BCDAccount.data&&(Def.gameMng.ShowMenuPanel(!1),this.popupNews.active=e,e&&this.popupNews.getComponent("UIPopupNews").UpdateDataToUI())},ShowPopupPurchasePiece:function(e){this.popupPurchasePiece.active=!0,this.popupPurchasePiece.getComponent("UIPopupPurchasePiece").UpdatePieceListToUI(e)}});cc._RF.pop()},{}],UIMarket:[function(e,t,a){"use strict";cc._RF.push(t,"6b830CZMHZFFrrnrQSy3uzS","UIMarket");cc.Class({extends:cc.Component,properties:{lbCarTotalCount:{default:null,type:cc.Label},lbCarPage:{default:null,type:cc.Label},lbPieceTotalCount:{default:null,type:cc.Label},lbPiecePage:{default:null,type:cc.Label},lbFuelTotalCount:{default:null,type:cc.Label},lbFuelPage:{default:null,type:cc.Label},lbLowestPrice:{default:null,type:cc.Label}},pageCar:null,pagePiece:null,pageFuel:null,selectedModel:null,selectedGrade:null,sort:null,selectedQuantity:null,isFilter:null,ctor:function(){this.StateInit()},start:function(){},StateInit:function(){this.pageCar=0,this.pagePiece=0,this.pageFuel=0,this.selectedModel=-1,this.selectedGrade=-1,this.sort=0,this.selectedQuantity="0",this.isFilter=!1},UpdateCarInfosToUI:function(){for(var e=this,t=BCDMarket.GetCarCount(),a=[],i=[],n=0;n<t;n++)a.push(n<BCDMarket.GetCarCount()?BCDMarket.GetCarInfo(n):null),i.push(null!=a[n]?a[n].price:null);var o=[];-1!=this.selectedModel?o=a.filter(function(t){return t.car.model==e.selectedModel}):-1==this.selectedModel&&(o=a);var c=[],r=this.selectedGrade;-1!=this.selectedGrade?c=o.filter(function(e){return Util.ParseCarModel_Grade(e.car.model)==r+1}):-1==this.selectedGrade&&(c=o);var l=[];l=this.sort==Def.Low()?c.sort(function(e,t){var a=Util.ParseTokenSymbol(e.price),i=Util.ParseTokenSymbol(t.price);return a<i?-1:a>i?1:0}):this.sort==Def.High()?c.sort(function(e,t){var a=Util.ParseTokenSymbol(e.price),i=Util.ParseTokenSymbol(t.price);return a>i?-1:a<i?1:0}):c,this.lbCarTotalCount.string=String(l.length),this.lbCarPage.string=this.pageCar+1+" Page",0==l.length&&1==this.isFilter&&(Def.uiMain.ShowToastPopupMsg("toastmsg_no_filter_result"),this.isFilter=!1),this.node.getComponent("UICarAsset").UpdateMarketCarsToUI(l,this.pageCar)},UpdatePieceInfosToUI:function(){for(var e=this,t=BCDMarket.GetPieceCount(),a=[],i=0;i<t;i++)if(a.push(i<BCDMarket.GetPieceCount()?BCDMarket.GetPieceInfo(i):null),null!=a[i]){var n=Util.ParseTokenSymbol(a[i].price);a[i].unitPrice=n/a[i].count}var o=[];-1!=this.selectedModel?o=a.filter(function(t){return t.model==e.selectedModel}):-1==this.selectedModel&&(o=a);var c=[],r=this.selectedGrade;-1!=this.selectedGrade?c=o.filter(function(e){return Util.ParseCarModel_Grade(e.model)==r+1}):-1==this.selectedGrade&&(c=o);var l=[];l=this.sort==Def.Low()?c.sort(function(e,t){var a=e.unitPrice,i=t.unitPrice;return a<i?-1:a>i?1:0}):this.sort==Def.High()?c.sort(function(e,t){var a=e.unitPrice,i=t.unitPrice;return a>i?-1:a<i?1:0}):c,this.node.getComponent("UICarAsset").UpdateMarketPiecesToUI(l,this.pagePiece),this.lbPieceTotalCount.string=String(l.length),this.lbPiecePage.string=this.pagePiece+1+" Page",0==l.length&&1==this.isFilter&&(Def.uiMain.ShowToastPopupMsg("toastmsg_no_filter_result"),this.isFilter=!1)},UpdateFuelInfosToUI:function(){for(var e=BCDMarket.GetFuelCount(),t=[],a=0;a<e;a++)if(t.push(a<BCDMarket.GetFuelCount()?BCDMarket.GetFuelInfo(a):null),null!=t[a]){var i=Util.ParseTokenSymbol(t[a].price);t[a].unitPrice=i/t[a].count}var n=[];switch(this.selectedQuantity){case"0":n=t;break;case"1":n=t.filter(function(e){return e.count<10});break;case"2":n=t.filter(function(e){return e.count<50});break;case"3":n=t.filter(function(e){return e.count<100});break;case"4":n=t.filter(function(e){return e.count>=100})}var o=[];n.length>0?this.sort==Def.Low()?(o=n.sort(function(e,t){var a=e.unitPrice,i=t.unitPrice;return a<i?-1:a>i?1:0}),this.lbLowestPrice.string=parseFloat(o[0].unitPrice).toFixed(4)+" "+TOKEN_SYMBOL):this.sort==Def.High()?(o=n.sort(function(e,t){var a=e.unitPrice,i=t.unitPrice;return a>i?-1:a<i?1:0}),this.lbLowestPrice.string=parseFloat(o[o.length-1].unitPrice).toFixed(4)+" "+TOKEN_SYMBOL):o=n:this.lbLowestPrice.string="",this.node.getComponent("UICarAsset").UpdateMarketFuelsToUI(o,this.pageFuel),this.lbFuelTotalCount.string=String(o.length),this.lbFuelPage.string=this.pageFuel+1+" Page",0==o.length&&1==this.isFilter&&(Def.uiMain.ShowToastPopupMsg("toastmsg_no_filter_result"),this.isFilter=!1)},onClick_PopupTradeFuel:function(){Def.uiMain.ShowPopupSaleFuel(!0)},onClick_CarMovePage:function(e,t){var a=Number(this.lbCarTotalCount.string)/Def.PageItemCount();this.pageCar+=Number(t),this.pageCar<0?this.pageCar=0:this.pageCar>a?this.pageCar-=Number(t):this.UpdateCarInfosToUI()},onClick_PieceMovePage:function(e,t){var a=Number(this.lbPieceTotalCount.string)/Def.PageItemCount();this.pagePiece+=Number(t),this.pagePiece<0?this.pagePiece=0:this.pagePiece>a?this.pagePiece-=Number(t):this.UpdatePieceInfosToUI()},onClick_FuelMovePage:function(e,t){var a=Number(this.lbFuelTotalCount.string)/Def.PageItemCount();this.pageFuel+=Number(t),this.pageFuel<0?this.pageFuel=0:this.pageFuel>a?this.pageFuel-=Number(t):this.UpdateFuelInfosToUI()},onClick_PopupFilterSort:function(e,t){Def.uiMain.ShowPopupFilterSort(!0,t)},ApplyFilterSort:function(e){var t=Def.uiMain.GetFilterSort();switch(this.selectedModel=t.model,this.selectedGrade=Number(t.grade),this.sort=t.sort,this.selectedQuantity=t.quantity,this.isFilter=!0,e){case"0":this.pageCar=0,this.UpdateCarInfosToUI();break;case"1":this.pagePiece=0,this.UpdatePieceInfosToUI();break;case"2":this.pageFuel=0,this.UpdateFuelInfosToUI()}},UpdatePurchasePieceSelect:function(e){this.panelStore.getComponent("UIStore").UpdateSelectedPiece(e)}});cc._RF.pop()},{}],UIMatch:[function(e,t,a){"use strict";cc._RF.push(t,"2573fJSMx9Ol5H3xivKpOF6","UIMatch");cc.Class({extends:cc.Component,properties:{panelMyCars:{default:null,type:cc.Node},panelMatch:{default:null,type:cc.Node},lbUpdateTimeLeft:{default:null,type:cc.Label},lbRewardInfo:{default:null,type:cc.Label},srcItemMatch:{default:null,type:cc.Node},nodeInform:{default:null,type:cc.Node},btnCreateUser:{default:null,type:cc.Node}},itemMatches:null,refreshMatchDataTimer:null,ctor:function(){this.itemMatches=new Array,this.refreshMatchDataTimer=5},update:function(e){if(BCDGame.IsExist()){var t=new Date,a=BCDGame.GetMatchPoolUpdatedTime()+Def.MatchPoolUpdateInterval()-.001*t.getTime();a<-1&&(this.refreshMatchDataTimer-=e,this.refreshMatchDataTimer<0&&(Def.scatterMng.getMatchData_Refresh(),this.refreshMatchDataTimer=5),a=0),0==a?(this.lbUpdateTimeLeft.node.color=new cc.Color(255,255,255,255),this.lbUpdateTimeLeft.string="Waiting.."):(this.lbUpdateTimeLeft.node.color=a<=300?new cc.Color(255,0,0,255):new cc.Color(255,255,255,255),this.lbUpdateTimeLeft.string=Util.FormatTimeLeft(a,!0,!0))}},UpdateMyCarsToUI:function(){var e=BCDUser.GetCarCount(),t=""!=BCDUser.IsExist();this.btnCreateUser.active=!t,this.nodeInform.active=t&&e<=0;var a=Def.GetLocalStorageData_MatchCarID();this.panelMyCars.getComponent("UIMyCarList").UpdateMyCarsToUI(a)},UpdateMatchDatasToUI:function(){for(var e=BCDMatchPool.GetDataCount(),t=BCDUser.GetMatchStats(),a=0,i=0;i<e;i++){(t>>2*i&3)==Def.MatchBit_Win()&&a++}this.lbRewardInfo.string=a+" / "+e;var n=this.panelMatch.getComponent(cc.ScrollView);Util.AdjustScrollViewItems(n.content,e,1,this.srcItemMatch),n.scrollToTop(0,!1);for(i=0;i<e;i++){var o=n.content.children[i].getComponent("UIItemRace"),c=BCDMatchPool.GetData(i);o.SetInfo_Match(i,c)}},onClick_CreateUser:function(){Def.scatterMng.createUser()}});cc._RF.pop()},{}],UIMyCarList:[function(e,t,a){"use strict";cc._RF.push(t,"1d0bbUKCV9KzLOdeli4rsvB","UIMyCarList");cc.Class({extends:cc.Component,properties:{srcItemCar:{default:null,type:cc.Node},nodeLeft:{default:null,type:cc.Node},nodeRight:{default:null,type:cc.Node}},itemCars:null,onClick_SelectMyCar:function(e,t){var a=Number(t),i=BCDUser.GetSelectedCarIndex()+a;i<0?i=0:i>=BCDUser.GetCarCount()&&(i=BCDUser.GetCarCount()-1),BCDUser.SelectCar(i),this.UpdateBtns(!0)},onScroll_SelectMyCar:function(e){var t=0;e.pageEvents&&e.pageEvents.length>0&&((t=e.node.getComponent(cc.PageView).getCurrentPageIndex())<0?t=0:t>=BCDUser.GetCarCount()&&(t=BCDUser.GetCarCount()-1),BCDUser.SelectCar(t));this.UpdateBtns(!1)},UpdateBtns:function(e){var t=BCDUser.GetSelectedCarIndex();(BCDUser.GetCarCount()<=1?(this.nodeLeft.active=!1,this.nodeRight.active=!1):t<=0?(this.nodeLeft.active=!1,this.nodeRight.active=!0):t>=BCDUser.GetCarCount()-1?(this.nodeLeft.active=!0,this.nodeRight.active=!1):(this.nodeLeft.active=!0,this.nodeRight.active=!0),e)&&this.node.getComponent(cc.PageView).setCurrentPageIndex(t)},UpdateMyCarsToUI:function(e){var t=this.node.getComponent(cc.PageView),a=t.getPages(),i=BCDUser.GetCarCount(),n=a.length;if(n>i)for(var o=i;o<n;o++)t.removePageAtIndex(i);else if(n<i)for(o=n;o<i;o++){var c=cc.instantiate(this.srcItemCar);t.addPage(c),c.y=0}a=t.getPages();for(o=0;o<i;o++){var r=BCDUser.GetCarInfo(o);a[o].getComponent("UIItemCarLarge").SetInfo(r),0!=e&&r.id==e&&BCDUser.SelectCar(o)}this.UpdateBtns(!0)}});cc._RF.pop()},{}],UIOnSaleAsset:[function(e,t,a){"use strict";cc._RF.push(t,"d3af6/JeHRED6STmCnQLITt","UIOnSaleAsset");cc.Class({extends:cc.Component,properties:{panelCar:{default:null,type:cc.Node},panelPiece:{default:null,type:cc.Node},panelFuel:{default:null,type:cc.Node},srcItemCar:{default:null,type:cc.Node},srcItemPiece:{default:null,type:cc.Node},srcItemFuel:{default:null,type:cc.Node}},start:function(){this.ShowPanelPiece()},ShowPanelPiece:function(){this.panelCar.active=!1,this.panelPiece.active=!0,this.panelFuel.active=!1,this.UpdateOnSalePieceToUI()},ShowPanelCar:function(){this.panelCar.active=!0,this.panelPiece.active=!1,this.panelFuel.active=!1,this.UpdateOnSaleCarToUI()},ShowPanelFuel:function(){this.panelCar.active=!1,this.panelPiece.active=!1,this.panelFuel.active=!0,this.UpdateOnSaleFuelToUI()},UpdateOnSalePieceToUI:function(){for(var e=BCDMarket.GetPieceCount(),t=[],a=0;a<e;a++)t.push(a<e?BCDMarket.GetPieceInfo(a):null);var i=BCDAccount.Name(),n=t.filter(function(e){return e.owner==i}),o=n.length,c=o<10?10:o,r=this.panelPiece.getComponent(cc.ScrollView);Util.AdjustScrollViewItems(r.content,c,1,this.srcItemPiece);for(a=0;a<c;a++){var l=n[a]?n[a]:null;r.content.children[a].getComponent("UIItemPiece").SetInfo(Def.CarItemType_OnSale(),a,l)}r.scrollToTop(0,!1)},UpdateOnSaleCarToUI:function(){for(var e=BCDMarket.GetCarCount(),t=[],a=0;a<e;a++)t.push(a<e?BCDMarket.GetCarInfo(a).car:null),t[a].price=null!=t[a]?BCDMarket.GetCarInfo(a).price:null;var i=t.filter(function(e){return e.owner==BCDAccount.Name()}),n=i.length,o=n<10?10:n,c=this.panelCar.getComponent(cc.ScrollView);Util.AdjustScrollViewItems(c.content,o,1,this.srcItemCar);for(a=0;a<o;a++){var r=i[a]?i[a]:null,l=i[a]?i[a].price:null;c.content.children[a].getComponent("UIItemCar").SetInfo(Def.CarItemType_OnSale(),a,r,l)}c.scrollToTop(0,!1)},UpdateOnSaleFuelToUI:function(){for(var e=BCDMarket.GetFuelCount(),t=[],a=0;a<e;a++)t.push(a<e?BCDMarket.GetFuelInfo(a):null);var i=t.filter(function(e){return e.owner==BCDAccount.Name()}),n=this.panelFuel.getComponent(cc.ScrollView),o=i.length,c=o<10?10:o;Util.AdjustScrollViewItems(n.content,c,1,this.srcItemFuel);for(a=0;a<c;a++){var r=i[a]?i[a]:null;n.content.children[a].getComponent("UIItemFuel").SetInfo(Def.CarItemType_OnSale(),a,r)}n.scrollToTop(0,!1)}});cc._RF.pop()},{}],UIPopupAwardingRecord:[function(e,t,a){"use strict";cc._RF.push(t,"9cf27ojyCtIdbrwLgjvTmuO","UIPopupAwardingRecord");cc.Class({extends:cc.Component,properties:{lbAwardingCount:{default:null,type:cc.Label},blTotalPrize:{default:null,type:cc.Label},lbInfo1st:{default:null,type:cc.Label},lbInfo2nd:{default:null,type:cc.Label},lbInfo3rd:{default:null,type:cc.Label},lbInfoETC:{default:null,type:cc.Label}},UpdateDataToUI:function(){var e=Util.MakeTokenSymbol(BCDUser.data.summary.tokenEarnPrize/1e4),t=BCDUser.data.summary.win1,a=BCDUser.data.summary.win2,i=BCDUser.data.summary.win3,n=BCDUser.data.summary.winETC,o=t+a+i,c=LocalizeMng.GetText("txt_award_times");this.lbAwardingCount.string=o+LocalizeMng.GetText("txt_award_prize1")+t+LocalizeMng.GetText("txt_award_prize2"),this.blTotalPrize.string=LocalizeMng.GetText("txt_award_total_prize")+e,this.lbInfo1st.string=LocalizeMng.GetText("txt_award_rank_1")+t+c,this.lbInfo2nd.string=LocalizeMng.GetText("txt_award_rank_2")+a+c,this.lbInfo3rd.string=LocalizeMng.GetText("txt_award_rank_3")+i+c,this.lbInfoETC.string=LocalizeMng.GetText("txt_award_rank_ETC")+n+c},onClick_Close:function(){this.node.active=!1}});cc._RF.pop()},{}],UIPopupCarSelect:[function(e,t,a){"use strict";cc._RF.push(t,"028a97plZtNtKvSi84a6JWQ","UIPopupCarSelect");cc.Class({extends:cc.Component,properties:{panelCar:{default:null,type:cc.Node},srcItemCar:{default:null,type:cc.Node}},UpdateCarListToUI:function(e,t){for(var a=this.panelCar.getComponent(cc.ScrollView),i=[],n=[],o=0;o<BCDUser.GetCarCount();o++){var c=BCDUser.GetCarInfo(o);if(0!=e){var r=Util.ParseCarModel_Grade(c.model);if(e<10){if(r>e)continue}else if(e<20&&r!=e%10)continue}0!=t&&c.model!=t||0==c.marketKey&&(i.push(c),n.push(o))}Util.AdjustScrollViewItems(a.content,i.length,2,this.srcItemCar);for(o=0;o<i.length;o++){var l=a.content.children[o].getComponent("UIItemCar"),s=(c=i[o],n[o]);l.SetInfo(Def.CarItemType_Select(),s,c,0)}},onClick_OK:function(){},onClick_Cancel:function(){this.node.active=!1}});cc._RF.pop()},{}],UIPopupCar:[function(e,t,a){"use strict";cc._RF.push(t,"e4524pZKX9Cq6Iyja3MawTL","UIPopupCar");cc.Class({extends:cc.Component,properties:{nodeSelectedCarInfo:{default:null,type:cc.Node},panelDefault:{default:null,type:cc.Node},defaultWinCount:{default:null,type:cc.Label},defaultNoRacing:{default:null,type:cc.Node},defaultRacing:{default:null,type:cc.Node},defaultBtnUpgradeLabel:{default:null,type:cc.Label},defaultModelName:{default:null,type:cc.Label},defaultModelInfo:{default:null,type:cc.Label},panelSale:{default:null,type:cc.Node},saleInfo:{default:null,type:cc.Label},panelUpgrade:{default:null,type:cc.Node},upgradeInfo1:{default:null,type:cc.Label},upgradeInfo2:{default:null,type:cc.Label},upgradeInfo3:{default:null,type:cc.Label},upgradeBtnLabel:{default:null,type:cc.Label},imgUpgradeArrow:{default:null,type:cc.Node},panelUpgradeResult:{default:null,type:cc.Node},upgradeResultCarImg:{default:null,type:cc.Sprite},imgUpgradeResultSuccess:{default:null,type:cc.Node},imgUpgradeResultFail:{default:null,type:cc.Node},upgradeResultImgCarGrade:{default:[],type:cc.Sprite},upgradeResultImgTierBG:{default:[],type:cc.Sprite},upgradeResultSpeedBefore:{default:null,type:cc.Label},upgradeResultSpeedAfter:{default:null,type:cc.Label},upgradeResultInfo:{default:null,type:cc.Label},panelDestroy:{default:null,type:cc.Node},destroyDefaultFuelInfo:{default:null,type:cc.Label},destroyBonusFuel1:{default:null,type:cc.Sprite},destroyBonusFuel2:{default:null,type:cc.Sprite},destroyBonusFuel3:{default:null,type:cc.Sprite},destroyBonusFuel4:{default:null,type:cc.Sprite},destroyBtnLabel:{default:null,type:cc.Label},panelDestroyResult:{default:null,type:cc.Node},destroyResultDefault:{default:null,type:cc.Label},destroyResultInfo1:{default:null,type:cc.Label},destroyResultInfo2:{default:null,type:cc.Label},destroyResultInfo3:{default:null,type:cc.Label},destroyResultInfo4:{default:null,type:cc.Label},destroyResultTotal:{default:null,type:cc.Label},destroyResultPanelDefault:{default:null,type:cc.Node},destroyResultPanelBonus1:{default:null,type:cc.Node},panelBonus1Normal:{default:null,type:cc.Node},panelBonus1Big:{default:null,type:cc.Node},panelBonus1GreatBig:{default:null,type:cc.Node},destroyResultPanelBonus2:{default:null,type:cc.Node},panelBonus2Normal:{default:null,type:cc.Node},panelBonus2Big:{default:null,type:cc.Node},panelBonus2GreatBig:{default:null,type:cc.Node},destroyResultPanelBonus3:{default:null,type:cc.Node},panelBonus3Normal:{default:null,type:cc.Node},panelBonus3Big:{default:null,type:cc.Node},panelBonus3GreatBig:{default:null,type:cc.Node},destroyResultPanelBonus4:{default:null,type:cc.Node},panelBonus4Normal:{default:null,type:cc.Node},panelBonus4Big:{default:null,type:cc.Node},panelBonus4GreatBig:{default:null,type:cc.Node},destroyResultPanelTotal:{default:null,type:cc.Node},destroyResultBtnLabel:{default:null,type:cc.Label}},needUpdate:null,carIndex:null,car:null,carID:null,regMarket_Price:null,carUpgradeCost:null,timeOutEvent:null,oldCarLevel:null,start:function(){},UpdateCarInfoToUI:function(e){var t=e.model,a=Util.GetCarModelInfo(t);this.panelDefault.active=!0,this.panelSale.active=!1,this.panelUpgrade.active=!1,this.panelUpgradeResult.active=!1,this.panelDestroy.active=!1,this.panelDestroyResult.active=!1,this.car=e,this.carID=e.id,BCDUser.SelectCarByID(e.id),this.carIndex=BCDUser.GetSelectedCarIndex(),this.nodeSelectedCarInfo.getComponent("UIItemCarLarge").SetInfo(e),this.defaultModelName.string=a.name,this.defaultModelInfo.string=a.desc,this.needUpdate=-1,this.defaultWinCount.string=LocalizeMng.GetText("txt_winning_count")+e.winCount;var i=this.car.level>=Def.CarMaxLevel()?"txt_upgrade_special":"txt_upgrade";this.defaultBtnUpgradeLabel.string=LocalizeMng.GetText(i)},onClick_OK:function(){Def.uiMain.ShowPopupCarInfo(null)},onClick_Cancel:function(){Def.uiMain.ShowPopupCarInfo(null)},onClick_PanelSale:function(){this.panelSale.active=!1,this.panelDefault.active=!0},onClick_PanelUpgrade:function(){this.panelUpgrade.active=!1,this.panelDefault.active=!0},onClick_PanelDestroy:function(){this.panelDestroy.active=!1,this.panelDefault.active=!0},ShowCarSalePanel:function(e,t){Util.UserCarIsLastOne()?Def.uiMain.ShowToastPopupMsg("toastmsg_check_sell_car_last_one"):(this.panelDefault.active=!t,this.panelSale.active=t)},onEditChange_RegMarketPrice:function(e){this.regMarket_Price=Number(e)},onClick_RegCarMarket:function(){Def.scatterMng.RegCarMarket(this.carID,this.regMarket_Price),Def.uiMain.ShowPopupCarInfo(null)},ShowCarUpgradePanel:function(e,t){this.panelDefault.active=!t,this.panelUpgrade.active=t;var a=Util.ParseCarModel_Grade(this.car.model),i=BCDGame.GetCarGradeInfo(a),n=parseFloat(1e-4*i.lvUpEOS);this.carUpgradeCost=n;var o=Util.ParseTokenSymbol(BCDAccount.balance),c=this.carUpgradeCost.toFixed(4);if(this.car.level<Def.CarMaxLevel())this.upgradeInfo1.string="Lv. "+this.car.level+"          Lv. "+(this.car.level+1),this.upgradeInfo2.string=" + "+Def.CarUpgradeSpeedPerLevel(),this.upgradeInfo3.string=LocalizeMng.GetText("txt_upgrade_info_normal"),this.imgUpgradeArrow.active=!0;else{var r="[ "+Def.CarUpgradeSpeed_SpecialMin()+" ~ "+Def.CarUpgradeSpeed_SpecialMax()+" ]",l=i.speed+Def.CarUpgradeSpeedPerLevel()*(Def.CarMaxLevel()-1);this.upgradeInfo1.string=LocalizeMng.GetText("txt_upgrade_special"),this.upgradeInfo2.string=String(l)+" + "+r,this.upgradeInfo3.string=LocalizeMng.GetText("txt_upgrade_info_special"),this.imgUpgradeArrow.active=!1}this.upgradeBtnLabel.string=LocalizeMng.GetText("txt_upgrade_desc")+c+" "+TOKEN_SYMBOL,this.upgradeBtnLabel.node.color=o>c?new cc.Color(0,0,0,255):new cc.Color(255,0,0,255)},onClick_CarUpgrade:function(){var e=this.carUpgradeCost;Util.ParseTokenSymbol(BCDAccount.balance)>=e?(this.oldSpeed=this.car.speed,Def.scatterMng.UpgradeCar(this.carID,e)):Def.uiMain.ShowToastPopupMsg("toastmsg_check_upgrade_token")},CheckOldCarLevel:function(){var e=BCDUser.GetCarInfo(this.carIndex);this.oldCarLevel>=e.level?setTimeout(Def.scatterMng.getUserData(function(){Def.uiMain.ShowPopupCarUpgradeResult(),Def.gameMng.ShowWaitScreen(!1)}),1e3):(this.ShowUpgradeResult(),Def.gameMng.ShowWaitScreen(!1))},ShowUpgradeResult:function(){self=this;var e=BCDUser.GetCarInfo(this.carIndex),t=e.model,a=e.color,i=Util.ParseCarModel_Grade(t);Util.LoadTexture_Car(this.upgradeResultCarImg,t,Def.CarImageType_Side(),a,""),Util.SetGradeRes(i,this.upgradeResultImgCarGrade),Util.SetGradeRes(i,this.upgradeResultImgTierBG),this.upgradeResultSpeedBefore.string=this.oldSpeed+"km/h",this.upgradeResultSpeedAfter.string=e.speed+"km/h";var n="";if(e.upgradeCount<Def.CarMaxLevel())this.imgUpgradeResultSuccess.active=!1,this.imgUpgradeResultFail.active=!1,n="txt_upgrade_info_normal";else{var o=e.speed-this.oldSpeed>0;this.imgUpgradeResultSuccess.active=o,this.imgUpgradeResultFail.active=!o,n="txt_upgrade_info_special",this.upgradeResultSpeedAfter.node.color=o?new cc.Color(64,64,255,255):new cc.Color(64,64,64,255)}this.upgradeResultInfo.string=LocalizeMng.GetText(n),this.panelUpgradeResult.active=!0,this.timeOutEvent=setTimeout(function(){self.car=e,self.panelUpgradeResult.active=!1,self.UpdateCarInfoToUI(e),self.onClick_PanelUpgrade(),self.timeOutEvent=null},1e4)},onClick_CloseUpgradeResult:function(){this.car=BCDUser.GetCarInfo(this.carIndex),this.panelUpgradeResult.active=!1,this.UpdateCarInfoToUI(this.car),this.onClick_PanelUpgrade(),this.timeOutEvent&&(clearTimeout(this.timeOutEvent),this.timeOutEvent=null)},ShowCarDestroyPanel:function(e,t){this.panelDefault.active=!t,this.panelDestroy.active=t,this.oldFuel=BCDUser.GetFuelCount(),this.destroyCarLv=this.car.level,this.destroyCarModel=this.car.model,this.destroyCarColorIndex=this.car.color;var a=Util.ParseCarModel_Grade(this.destroyCarModel),i=BCDGame.GetCarGradeInfo(a);switch(this.destroyDefaultFuelInfo.string="+"+i.fuelDestroy,this.destroyBonusFuel1.node.active=!1,this.destroyBonusFuel2.node.active=!1,this.destroyBonusFuel3.node.active=!1,this.destroyBonusFuel4.node.active=!1,this.destroyCarLv){case 2:this.destroyBonusFuel1.node.active=!0;break;case 3:this.destroyBonusFuel1.node.active=!0,this.destroyBonusFuel2.node.active=!0;break;case 4:this.destroyBonusFuel1.node.active=!0,this.destroyBonusFuel2.node.active=!0,this.destroyBonusFuel3.node.active=!0;break;case 5:this.destroyBonusFuel1.node.active=!0,this.destroyBonusFuel2.node.active=!0,this.destroyBonusFuel3.node.active=!0,this.destroyBonusFuel4.node.active=!0}},onClick_CarDestroy:function(){Def.scatterMng.DestroyCar(this.car.id)},ShowCarDestroyResult:function(){self=this;var e=BCDUser.GetFuelCount()-this.oldFuel,t=[],a=[];switch(t.push(BCDUser.data.dsmFuel.amount0),t.push(BCDUser.data.dsmFuel.amount1),t.push(BCDUser.data.dsmFuel.amount2),t.push(BCDUser.data.dsmFuel.amount3),t.push(BCDUser.data.dsmFuel.amount4),this.destroyResultPanelDefault.stopAllActions(),this.destroyResultPanelBonus1.stopAllActions(),this.destroyResultPanelBonus2.stopAllActions(),this.destroyResultPanelBonus3.stopAllActions(),this.destroyResultPanelBonus4.stopAllActions(),this.destroyResultPanelTotal.stopAllActions(),this.destroyResultPanelDefault.position=new cc.Vec2(984,361),this.destroyResultPanelBonus1.position=new cc.Vec2(984,207),this.destroyResultPanelBonus2.position=new cc.Vec2(984,37),this.destroyResultPanelBonus3.position=new cc.Vec2(984,-134),this.destroyResultPanelBonus4.position=new cc.Vec2(984,-305),this.destroyResultPanelTotal.position=new cc.Vec2(984,-525),a.push(cc.tween(this.destroyResultPanelDefault).to(0,{position:cc.v2(984,361)}).to(.3,{position:cc.v2(0,361)})),a.push(cc.tween(this.destroyResultPanelBonus1).to(0,{position:cc.v2(984,207)}).delay(.3).to(.3,{position:cc.v2(0,207)})),a.push(cc.tween(this.destroyResultPanelBonus2).to(0,{position:cc.v2(984,37)}).delay(.6).to(.3,{position:cc.v2(0,37)})),a.push(cc.tween(this.destroyResultPanelBonus3).to(0,{position:cc.v2(984,-134)}).delay(.3*3).to(.3,{position:cc.v2(0,-134)})),a.push(cc.tween(this.destroyResultPanelBonus4).to(0,{position:cc.v2(984,-305)}).delay(1.2).to(.3,{position:cc.v2(0,-305)})),a.push(cc.tween(this.destroyResultPanelTotal).to(0,{position:cc.v2(984,-525)}).delay(.3*this.destroyCarLv).to(.3,{position:cc.v2(0,-525)})),this.destroyCarLv){case 1:this.destroyResultDefault.string="+ "+t[0],a[0].start();break;case 2:this.checkLotto(t[1],this.panelBonus1Normal,this.panelBonus1Big,this.panelBonus1GreatBig,this.destroyResultInfo1.node),this.destroyResultDefault.string="+ "+t[0],this.destroyResultInfo1.string="+ "+t[1],a[0].start(),a[1].start();break;case 3:this.checkLotto(t[1],this.panelBonus1Normal,this.panelBonus1Big,this.panelBonus1GreatBig,this.destroyResultInfo1.node),this.checkLotto(t[2],this.panelBonus2Normal,this.panelBonus2Big,this.panelBonus2GreatBig,this.destroyResultInfo2.node),this.destroyResultDefault.string="+ "+t[0],this.destroyResultInfo1.string="+ "+t[1],this.destroyResultInfo2.string="+ "+t[2],a[0].start(),a[1].start(),a[2].start();break;case 4:this.checkLotto(t[1],this.panelBonus1Normal,this.panelBonus1Big,this.panelBonus1GreatBig,this.destroyResultInfo1.node),this.checkLotto(t[2],this.panelBonus2Normal,this.panelBonus2Big,this.panelBonus2GreatBig,this.destroyResultInfo2.node),this.checkLotto(t[3],this.panelBonus3Normal,this.panelBonus3Big,this.panelBonus3GreatBig,this.destroyResultInfo3.node),this.destroyResultDefault.string="+ "+t[0],this.destroyResultInfo1.string="+ "+t[1],this.destroyResultInfo2.string="+ "+t[2],this.destroyResultInfo3.string="+ "+t[3],a[0].start(),a[1].start(),a[2].start(),a[3].start();break;case 5:this.checkLotto(t[1],this.panelBonus1Normal,this.panelBonus1Big,this.panelBonus1GreatBig,this.destroyResultInfo1.node),this.checkLotto(t[2],this.panelBonus2Normal,this.panelBonus2Big,this.panelBonus2GreatBig,this.destroyResultInfo2.node),this.checkLotto(t[3],this.panelBonus3Normal,this.panelBonus3Big,this.panelBonus3GreatBig,this.destroyResultInfo3.node),this.checkLotto(t[4],this.panelBonus4Normal,this.panelBonus4Big,this.panelBonus4GreatBig,this.destroyResultInfo4.node),this.destroyResultDefault.string="+ "+t[0],this.destroyResultInfo1.string="+ "+t[1],this.destroyResultInfo2.string="+ "+t[2],this.destroyResultInfo3.string="+ "+t[3],this.destroyResultInfo4.string="+ "+t[4],a[0].start(),a[1].start(),a[2].start(),a[3].start(),a[4].start()}this.destroyResultTotal.string="+"+e,a[5].start(),this.panelDestroy.active=!1,this.panelDestroyResult.active=!0,this.timeOutEvent=setTimeout(function(){self.panelDestroyResult.active=!1,self.onClick_Cancel(),this.timeOutEvent=null},1e4)},checkLotto:function(e,t,a,i,n){t.active=!1,a.active=!1,i.active=!1,e>=7e3?(i.active=!0,n.color=new cc.Color(238,231,117,255)):e>=700?(a.active=!0,n.color=new cc.Color(238,231,117,255)):(t.active=!0,n.color=new cc.Color(255,255,255,255))},onClick_CloseDestroyResult:function(){this.panelDestroyResult.active=!1,this.onClick_Cancel(),this.timeOutEvent&&(clearTimeout(this.timeOutEvent),this.timeOutEvent=null)},onClick_ViewEqualItemAll:function(){Def.uiMain.ViewEqualItemAll(Def.MarketItemType_Car(),this.car.model)}});cc._RF.pop()},{}],UIPopupEventInfo:[function(e,t,a){"use strict";cc._RF.push(t,"62d53CSicVHWpZ9KwRpzfPi","UIPopupEventInfo");cc.Class({extends:cc.Component,properties:{lbEventTitle:{default:null,type:cc.Label},nodeInfoNormal:{default:null,type:cc.Node},lbRewardTotal:{default:null,type:cc.Label},lbReward1:{default:null,type:cc.Label},lbReward2:{default:null,type:cc.Label},lbReward3:{default:null,type:cc.Label},lbRewardETCTxts:{default:[],type:cc.Label},lbRewardETCs:{default:[],type:cc.Label},nodeInfoSpecial:{default:null,type:cc.Node},nodeAddDesc:{default:null,type:cc.Node},lbJoinCount:{default:null,type:cc.Label},lbRemainTime:{default:null,type:cc.Label}},info:null,UpdateEventDataToUI:function(e){if(this.info=e.info,this.lbEventTitle.string=this.info.title,0==this.info.entryLimit?this.lbJoinCount.string=LocalizeMng.GetText("txt_unlimited"):this.lbJoinCount.string=e.players.length+"/"+this.info.entryLimit,this.info.grade==Def.EventGrade_Special_DropCar())this.nodeInfoNormal.active=!1,this.nodeInfoSpecial.active=!0;else{this.nodeInfoNormal.active=!0,this.nodeInfoSpecial.active=!1;var t=e.players.length,a=Util.CalcEventPrize(this.info,0,t),i=Util.CalcEventPrize(this.info,1,t),n=Util.CalcEventPrize(this.info,2,t),o=Util.CalcEventPrize(this.info,3,t),c=this.info.grade==Def.EventGrade_Special_Trophy()?4:this.info.prizeVar;this.lbRewardTotal.string=Util.FormatEventPrize(this.info.prizeType,a,c),this.lbReward1.string=Util.FormatEventPrize(this.info.prizeType,i,c),this.lbReward2.string=Util.FormatEventPrize(this.info.prizeType,n,c),this.lbReward3.string=Util.FormatEventPrize(this.info.prizeType,o,c);var r=LocalizeMng.GetText("txt_rank"),l=[],s=[];if(this.info.grade==Def.EventGrade_Special_EnterFee()||this.info.grade==Def.EventGrade_Special_EnterFee_Acc());else if(this.info.grade==Def.EventGrade_Special_Trophy())l.push(LocalizeMng.GetText("txt_rank_4_5")),s.push(Util.CalcEventPrize(this.info,4)),l.push(LocalizeMng.GetText("txt_rank_6_10")),s.push(Util.CalcEventPrize(this.info,6)),l.push(LocalizeMng.GetText("txt_rank_within")+String(10+this.info.prizeScopeCount)+" : "),s.push(Util.CalcEventPrize(this.info,11));else if(this.info.prizeScopeCount>0){this.info.prizeType==Def.RewardType_Token()?(l.push(LocalizeMng.GetText("txt_rank_4_5")),l.push(LocalizeMng.GetText("txt_rank_6_10")),s.push(Util.CalcEventPrize(this.info,4)),s.push(Util.CalcEventPrize(this.info,6))):this.info.prizeType==Def.RewardType_Piece()&&(l.push(LocalizeMng.GetText("txt_rank_4_10")),s.push(Util.CalcEventPrize(this.info,4)));for(var u=0;u<4;u++){var p=10+u*this.info.prizeScopeCount,d=p+this.info.prizeScopeCount;l.push(String(p+1)+r+" ~ "+String(d)+r+" : "),s.push(Util.CalcEventPrize(this.info,10+u*this.info.prizeScopeCount+1))}}else{if(this.info.prizeType==Def.RewardType_Token()){var h=Math.floor(.1*this.info.entryLimit);l.push(LocalizeMng.GetText("txt_rank_within")+String(h)+" : ")}else l.push(LocalizeMng.GetText("txt_rank_4_5"));s.push(Util.CalcEventPrize(this.info,4))}for(u=0;u<this.lbRewardETCTxts.length;u++){var f=u<l.length;this.lbRewardETCTxts[u].node.active=f,f&&(this.lbRewardETCTxts[u].string=l[u])}for(u=0;u<this.lbRewardETCs.length;u++){f=u<s.length;this.lbRewardETCs[u].node.active=f,f&&(this.lbRewardETCs[u].string=Util.FormatEventPrize(this.info.prizeType,s[u],c))}}this.nodeAddDesc.active=this.info.grade==Def.EventGrade_Special_EnterFee_Acc()},update:function(e){if(0!=this.node.active){var t=new Date,a=this.info.timeEnd-.001*t.getTime(),i=Util.FormatTimeLeft(a,!0,!0);a>0&&(i+=LocalizeMng.GetText("txt_time_left")),this.lbRemainTime.string=i}},onClick_Close:function(){this.node.active=!1}});cc._RF.pop()},{}],UIPopupEventRaceReady:[function(e,t,a){"use strict";cc._RF.push(t,"5c930HNSc9BtpxBgpPzwSFq","UIPopupEventRaceReady");cc.Class({extends:cc.Component,properties:{nodeCarInfo:{default:null,type:cc.Node},imgFuel:{default:null,type:cc.Node},imgTicket:{default:null,type:cc.Node},imgEnterFee:{default:null,type:cc.Node},imgTrophy:{default:null,type:cc.Node},lbConsume:{default:null,type:cc.Label},lbDesc:{default:null,type:cc.Label},lbBtnStart:{default:null,type:cc.Label},btnChangeVehicle:{default:null,type:cc.Button}},eventCur:null,UpdateDataToUI:function(e,t){this.eventCur=e,this.nodeCarInfo.getComponent("UIItemCarLarge").SetInfo(t),this.btnChangeVehicle.interactable=0!=t.id;var a="",i="";if(Def.gameMng.GetPracticeRace())a="txt_info_practice_race",i="txt_btn_start_practice";else{var n=this.eventCur.info.grade;a=n==Def.EventGrade_Special_DropCar()?"txt_info_join_event_dropcar":n==Def.EventGrade_Special_EnterFee()?"txt_info_join_event_enterfee":n==Def.EventGrade_Special_EnterFee_Acc()?"txt_info_join_event_enterfee_acc":"txt_info_join_event",i="txt_btn_start_race"}this.lbDesc.string=LocalizeMng.GetText(a),this.lbBtnStart.string=LocalizeMng.GetText(i),this.UpdateFuelConsumeToUI()},UpdateFuelConsumeToUI:function(){var e=0,t=0;if(0==Def.gameMng.GetPracticeRace()){if(e=this.eventCur.info.fuelConsume,this.eventCur.info.grade==Def.EventGrade_Special_DropCar())void 0==this.eventCur.mapPlayer.get(BCDAccount.Name())&&(e=0);else if(0==e){var a=BCDUser.GetSelectedCarInfo(),i=Util.ParseCarModel_Grade(a.model);e=BCDGame.GetCarGradeInfo(i).fuelConsume}e>0&&BCDUser.GetEventTicketCount()>0&&(t=1,e=0)}var n=Util.EventNeedEnterFee(this.eventCur.info),o=this.eventCur.info.grade==Def.EventGrade_Special_Trophy(),c=this.eventCur.info.enterFeeOrTrophy;(0==o&&(c/=1e4),n||o)&&(void 0!=this.eventCur.mapPlayer.get(BCDAccount.Name())?c=0:(e=0,t=0));this.imgFuel.active=e>0,this.imgTicket.active=t>0,this.imgEnterFee.active=0!=c&&n,this.imgTrophy.active=0!=c&&o;var r=0;c>0?r=c:t>0?r=t:e>0&&(r=e),this.lbConsume.node.active=r>0,this.lbConsume.string=-r},onClick_OK:function(){var e=null;e=this.eventCur.info.grade==Def.EventGrade_Special_DropCar()?Util.GenerateEventCar(this.eventCur.info):BCDUser.GetSelectedCarInfo(),Def.gameMng.BeginEventRace(this.eventCur,e),this.node.active=!1},onClick_Close:function(){this.node.active=!1},onClick_SelectCar:function(){Def.uiMain.ShowPopupCarSelect(!0,this.eventCur.info.requiredCarGrade,this.eventCur.info.requiredCarModel)}});cc._RF.pop()},{}],UIPopupExpandGarage:[function(e,t,a){"use strict";cc._RF.push(t,"4fffe5OGb9BhKE8XuQPTECD","UIPopupExpandGarage");cc.Class({extends:cc.Component,properties:{popup:{default:null,type:cc.Node},lbMsg2:{default:null,type:cc.Label}},expandPrice:null,start:function(){this.updateInfo()},updateInfo:function(){var e=BCDUser.GetCarSpaceCount();this.expandPrice=0,this.expandPrice=[.2,.4,.8,1.5,3,3,3,3,3,3,3,3,3,3][(e-Def.DefaultCarSpace())/3],this.lbMsg2.string=this.expandPrice+LocalizeMng.GetText("txt_required_token")},ShowPopup:function(e){this.updateInfo(),this.popup.active=e},onClick_Purchase:function(){Def.scatterMng.ExpandGarage(this.expandPrice)},onClick_Cancel:function(){this.popup.active=!1}});cc._RF.pop()},{}],UIPopupFilterSort:[function(e,t,a){"use strict";cc._RF.push(t,"5867dJ+T4dOa6szh3HWqpzz","UIPopupFilterSort");cc.Class({extends:cc.Component,properties:{panelFilterSort_Car:{default:null,type:cc.Node},panelFilterSort_Piece:{default:null,type:cc.Node},panelFilterSort_Fuel:{default:null,type:cc.Node},panelCar:{default:null,type:cc.Node},panelGrade:{default:null,type:cc.Node},panelSort:{default:null,type:cc.Node},panelFuelQuantity:{default:null,type:cc.Node},srcItemCar:{default:null,type:cc.Node},lbCarModel:{default:null,type:cc.Label},lbCarGrade:{default:null,type:cc.Label},lbCarSort:{default:null,type:cc.Label},lbPieceModel:{default:null,type:cc.Label},lbPieceGrade:{default:null,type:cc.Label},lbPieceSort:{default:null,type:cc.Label},lbFuelQuantity:{default:null,type:cc.Label},lbFuelSort:{default:null,type:cc.Label}},itemCars:null,popupType:null,prevIndex:null,selectedCarModel:null,selectedGrade:null,selectedSort:null,selectedQuantityStep:null,Init:function(e){switch(this.popupType=e,this.lbCarModel.string=LocalizeMng.GetText("txt_sort_filter_all"),this.lbCarGrade.string=LocalizeMng.GetText("txt_sort_filter_all"),this.lbCarSort.string=LocalizeMng.GetText("txt_sort_filter_all"),this.lbPieceModel.string=LocalizeMng.GetText("txt_sort_filter_all"),this.lbPieceGrade.string=LocalizeMng.GetText("txt_sort_filter_all_ratings"),this.lbPieceSort.string=LocalizeMng.GetText("txt_sort_filter_low_price"),this.lbFuelQuantity.string=LocalizeMng.GetText("txt_sort_filter_all"),this.lbFuelSort.string=LocalizeMng.GetText("txt_sort_filter_low_price"),this.prevIndex=-1,this.selectedCarModel=-1,this.selectedGrade=-1,this.selectedSort=Def.Low(),this.selectedQuantityStep="0",this.initAllPanel(),e){case"1":this.panelFilterSort_Car.active=!0;break;case"2":this.panelFilterSort_Piece.active=!0;break;case"3":this.panelFilterSort_Fuel.active=!0}},initAllPanel:function(){this.panelFilterSort_Car.active=!1,this.panelFilterSort_Piece.active=!1,this.panelFilterSort_Fuel.active=!1,this.panelCar.active=!1,this.panelGrade.active=!1,this.panelSort.active=!1,this.panelFuelQuantity.active=!1},UpdatePanelFilterSortUI:function(e){this.Init(e)},UpdateCarListToUI:function(){this.itemCars=[];var e=this.panelCar.getComponent(cc.ScrollView);Util.AdjustScrollViewItems(e.content,Util.GetCarModelCount(),2,this.srcItemCar),this.itemCars=[];for(var t=0;t<Util.GetCarModelCount();t++){var a=e.content.children[t].getComponent("UIItemCar");this.itemCars.push(a);var i=Util.GetCarModelInfoByIndex(t);a.SetInfo(Def.CarItemType_FilterSort(),t,i,0)}setTimeout(function(){e.scrollToTop(0,!1)},1e3)},SetFilterSort:function(e){this.selectedCarModel=e,this.selectedGrade=-1,this.selectedSort=0,this.selectedQuantityStep="0"},GetFilterSort:function(){return this.node.active=!1,{model:this.selectedCarModel,grade:this.selectedGrade,sort:this.selectedSort,quantity:this.selectedQuantityStep}},onClick_OK:function(){},onClick_Cancel:function(){this.node.active=!1},onClick_Init:function(){this.Init(this.popupType)},onClick_ShowPanelCarSelect:function(){this.UpdateCarListToUI(),this.initAllPanel(),this.panelCar.active=!0},onClick_ShowPanelPieceSelect:function(){this.UpdateCarListToUI(),this.initAllPanel(),this.panelCar.active=!0},onClick_ShowPanelGradeSelect:function(){this.initAllPanel(),this.panelGrade.active=!0},onClick_ShowPanelSort:function(){this.initAllPanel(),this.panelSort.active=!0},onClick_ShowPanelFuelQuantity:function(){this.initAllPanel(),this.panelFuelQuantity.active=!0},onClick_InitCar:function(){this.selectedCarModel=-1,this.panelCar.active=!1,"1"==this.popupType&&(this.lbCarModel.string=LocalizeMng.GetText("txt_sort_filter_all"),this.panelFilterSort_Car.active=!0),"2"==this.popupType&&(this.lbPieceModel.string=LocalizeMng.GetText("txt_sort_filter_all"),this.panelFilterSort_Piece.active=!0)},onClick_SelectedCar:function(){this.panelCar.active=!1,"1"==this.popupType&&(this.panelFilterSort_Car.active=!0),"2"==this.popupType&&(this.panelFilterSort_Piece.active=!0)},onClick_SelectGrade:function(e,t){this.selectedGrade=t,this.panelGrade.active=!1;var a=Number(t);"1"==this.popupType&&(this.lbCarGrade.string=-1==a?LocalizeMng.GetText("txt_tier_all"):LocalizeMng.GetText("txt_tier_")+(Number(t)+1),this.panelFilterSort_Car.active=!0),"2"==this.popupType&&(this.lbPieceGrade.string=-1==a?LocalizeMng.GetText("txt_tier_all"):LocalizeMng.GetText("txt_tier_")+(Number(t)+1),this.panelFilterSort_Piece.active=!0)},onClick_SelectSort:function(e,t){this.selectedSort=t==Def.Low()?Def.Low():Def.High(),this.panelSort.active=!1;var a=t==Def.Low()?"txt_sort_filter_low_price":"txt_sort_filter_high_price",i=LocalizeMng.GetText(a);"1"==this.popupType?(this.lbCarSort.string=i,this.panelFilterSort_Car.active=!0):"2"==this.popupType?(this.lbPieceSort.string=i,this.panelFilterSort_Piece.active=!0):"3"==this.popupType&&(this.lbFuelSort.string=i,this.panelFilterSort_Fuel.active=!0)},UpdateSelectedCar:function(e){if(-1!=this.prevIndex){this.srcItemCar.getComponent("UIItemCar");this.itemCars[this.prevIndex].sprSelBox.node.active=!1}this.selectedCarModel=this.itemCars[e].data.model,"1"==this.popupType&&(this.lbCarModel.string=Util.GetCarModelInfo(this.selectedCarModel).name),"2"==this.popupType&&(this.lbPieceModel.string=Util.GetCarModelInfo(this.selectedCarModel).name),this.prevIndex=e},onClick_SelectFuelQuantity:function(e,t){switch(this.selectedQuantityStep=t,this.panelFuelQuantity.active=!1,this.selectedQuantityStep){case"0":this.lbFuelQuantity.string=LocalizeMng.GetText("txt_sort_filter_all");break;case"1":this.lbFuelQuantity.string=LocalizeMng.GetText("txt_sort_filter_under_quantity_10");break;case"2":this.lbFuelQuantity.string=LocalizeMng.GetText("txt_sort_filter_under_quantity_50");break;case"3":this.lbFuelQuantity.string=LocalizeMng.GetText("txt_sort_filter_under_quantity_100");break;case"4":this.lbFuelQuantity.string=LocalizeMng.GetText("txt_sort_filter_over_quantity_100")}this.panelFilterSort_Fuel.active=!0},onClick_ApplyFilterSort:function(e,t){Def.uiMain.uiMarket.ApplyFilterSort(t)}});cc._RF.pop()},{}],UIPopupMarketCarInfo:[function(e,t,a){"use strict";cc._RF.push(t,"056d7Lg6L1FbZEuSxjRn4s4","UIPopupMarketCarInfo");cc.Class({extends:cc.Component,properties:{nodeMyCarInfo:{default:null,type:cc.Node},lbLevel:{default:null,type:cc.Label},lbSpeed:{default:null,type:cc.Label},lbWinCount:{default:null,type:cc.Label}},UpdateCarInfoToUI:function(e){var t=this.nodeMyCarInfo.getComponent("UIItemCarLarge");this.carID=e.id,t.SetInfo(e),this.lbLevel.string=LocalizeMng.GetText("txt_level")+e.level,this.lbSpeed.string=LocalizeMng.GetText("txt_normal_speed")+e.speed+"km/h",this.lbWinCount.string=LocalizeMng.GetText("txt_winning_count")+e.winCount},onClick_Cancel:function(){Def.uiMain.ShowPopup_MarketCarInfo(null)}});cc._RF.pop()},{}],UIPopupMenu:[function(e,t,a){"use strict";cc._RF.push(t,"e6c37MwPG9CGZ7UsXv39aXx","UIPopupMenu");cc.Class({extends:cc.Component,properties:{lbAccount:{default:null,type:cc.Label},lbFullBalance:{default:null,type:cc.Label},lbUnstake:{default:null,type:cc.Label},progressCPU:{default:null,type:cc.ProgressBar},progressNET:{default:null,type:cc.ProgressBar},lbTokenEarnMarket:{default:null,type:cc.Label}},UpdateDataToUI:function(){if(null!=BCDAccount.data&&void 0!=BCDAccount.data){var e=BCDAccount.data.cpu_weight/1e4,t=BCDAccount.data.net_weight/1e4,a=Util.ParseTokenSymbol(BCDAccount.balance),i=0;null!=BCDAccount.data.refund_request&&(i=Util.ParseTokenSymbol(BCDAccount.data.refund_request.cpu_amount)+Util.ParseTokenSymbol(BCDAccount.data.refund_request.net_amount));var n=BCDUser.data.summary.tokenEarnMarket/1e4;this.lbAccount.string=BCDAccount.Name(),this.lbFullBalance.string=Util.MakeTokenSymbol(a+e+t+i),this.lbUnstake.string=Util.MakeTokenSymbol(a),this.progressCPU.progress=BCDAccount.data.cpu_limit.used/BCDAccount.data.cpu_limit.max,this.progressNET.progress=BCDAccount.data.net_limit.used/BCDAccount.data.net_limit.max,this.lbTokenEarnMarket.string=Util.MakeTokenSymbol(n)}},update:function(e){},onClick_PopupResource:function(){Def.uiMain.ShowPopupResource(!0)},onClick_PopupPurchaseList:function(){Def.uiMain.ShowToastPopupMsg("toastmsg_comming_soon")},onClick_PopupSalesList:function(){Def.uiMain.ShowToastPopupMsg("toastmsg_comming_soon")},onClick_PopupAwardingRecord:function(){Def.uiMain.ShowPopupAwardingRecord(!0)},onClick_PopupNews:function(){Def.uiMain.ShowToastPopupMsg("toastmsg_comming_soon")},onClick_LinkEOSx:function(){cc.sys.openURL("https://www.eosx.io/account/"+this.lbAccount.string)},onClick_LinkEOSPark:function(){cc.sys.openURL("https://eospark.com/account/"+this.lbAccount.string)},onClick_LinkBlockio:function(){cc.sys.openURL("https://bloks.io/account/"+this.lbAccount.string)},onClick_Login_Logout:function(){Def.scatterMng.IsLogin()?Def.scatterMng.Logout():Def.scatterMng.Login(),this.node.active=!1},onClick_Close:function(){this.node.active=!1},onClick_GotoHome:function(){cc.sys.openURL(Def.HomeURL())}});cc._RF.pop()},{}],UIPopupNews:[function(e,t,a){"use strict";cc._RF.push(t,"b8b829jlTpOHZFfRYfSh1nM","UIPopupNews");cc.Class({extends:cc.Component,properties:{webview:{default:null,type:cc.WebView}},onLoad:function(){this.webview.url="https://www.eosracing.io/notice/board/index.php",this.webview.node.on("loaded",this.callback,this)},callback:function(e){e.detail},UpdateDataToUI:function(){},onClick_Close:function(){this.node.active=!1}});cc._RF.pop()},{}],UIPopupPiece:[function(e,t,a){"use strict";cc._RF.push(t,"b6f36WQ3jVOO5UF4KsKZep1","UIPopupPiece");cc.Class({extends:cc.Component,properties:{popupTitle:{default:null,type:cc.Label},pieceInfo:{default:null,type:cc.Node},infoImgCarPiece:{default:null,type:cc.Sprite},infoQuantityDisableBg:{default:null,type:cc.Sprite},infoMaxQuantityBg:{default:null,type:cc.Sprite},infoPieceQuantity:{default:null,type:cc.Label},infoPieceGradeBox:{default:[],type:cc.Sprite},infoPieceCarName:{default:null,type:cc.Label},infoPiecePanelCarName:{default:null,type:cc.Label},infoPieceTier:{default:null,type:cc.Label},infoNeedPiece:{default:null,type:cc.Label},infoNormalSpeed:{default:null,type:cc.Label},infoUpgradeMaxSpeed:{default:null,type:cc.Label},infoBtnDefault:{default:null,type:cc.Node},makeCarInfo:{default:null,type:cc.Node},panelDefault:{default:null,type:cc.Node},makeCountLabel:{default:null,type:cc.Label},panelSale:{default:null,type:cc.Node},panelDisassemble:{default:null,type:cc.Node},saleInfo:{default:null,type:cc.Label},saleQuantitySlider:{default:null,type:cc.Slider},saleQuantityEditBox:{default:null,type:cc.EditBox},saleMaxQuantityLabel:{default:null,type:cc.Label},salePriceEditBox:{default:null,type:cc.EditBox},saleTotalPrice:{default:null,type:cc.Label},panelMaking:{default:null,type:cc.Node},makingCarInfo:{default:null,type:cc.Node},makingImgCar:{default:null,type:cc.Sprite},makingLbName:{default:null,type:cc.Label},makingLbSpeed:{default:null,type:cc.Label},makingLbLevel:{default:null,type:cc.Label},makingImgCarPiece:{default:null,type:cc.Sprite},makingQuantityDisableBg:{default:null,type:cc.Sprite},makingMaxQuantityBg:{default:null,type:cc.Sprite},makingPieceQuantity:{default:null,type:cc.Label},makingPieceGradeBox:{default:[],type:cc.Sprite},makingPieceCarName:{default:null,type:cc.Label},makingInfo:{default:null,type:cc.Label},panelMakingResult:{default:null,type:cc.Node},makingResultImgCarGrade:{default:[],type:cc.Sprite},makingResultImgCar:{default:null,type:cc.Sprite},makingResultImgTierBG:{default:[],type:cc.Sprite},makingResultName:{default:null,type:cc.Label},makingResultTier:{default:null,type:cc.Label},makingResultInfo1:{default:null,type:cc.Label},makingResultInfo2:{default:null,type:cc.Label},panelDissassembleResult:{default:null,type:cc.Node},disassembleResultImgFuel:{default:null,type:cc.Node},disassembleResultImgTrophy:{default:null,type:cc.Node},disassembleResultCount:{default:null,type:cc.Label}},pieceIndex:null,piece:null,pieceModel:null,maxQuantity:null,regMarket_PieceQuantity:null,regMarket_Price:null,timeOutEvent:null,start:function(){},UpdatePieceInfoToUI:function(e){self=this;var t=e.model,a=Util.GetCarModelInfo(t),i=Util.ParseCarModel_Grade(t),n=BCDGame.GetCarGradeInfo(i),o=String(a.name);this.popupTitle.string="Piece information",this.pieceIndex=BCDUser.GetSelectedPieceIndex(),this.piece=e,this.pieceModel=Number(t),void 0==e.key?this.maxQuantity=Number(e.count-e.marketDeposit):this.maxQuantity=Number(e.count),this.saleMaxQuantityLabel.string="/ "+this.maxQuantity,Util.LoadTexture_CarPiece(this.infoImgCarPiece,t),Util.SetGradeRes(i,this.infoPieceGradeBox),Util.PadName(this.infoPieceCarName,o,17),self.maxQuantity==Def.MaxPieceQuantity()?self.infoMaxQuantityBg.node.active=!0:(self.infoMaxQuantityBg.node.active=!1,self.infoQuantityDisableBg.node.active=n.asmPiece>self.maxQuantity),this.infoPieceQuantity.string=this.maxQuantity,this.infoPiecePanelCarName.string=String(o),this.makeCountLabel.string="( "+n.asmPiece+" )",this.infoPieceTier.string=LocalizeMng.GetText("txt_piece_tier")+i,this.infoNeedPiece.string=LocalizeMng.GetText("txt_need_piece")+n.asmPiece+" piece",this.infoNormalSpeed.string=LocalizeMng.GetText("txt_normal_speed")+n.speed+"km/h",this.infoUpgradeMaxSpeed.string=LocalizeMng.GetText("txt_upgrade_max_speed")+Def.CarMaxSpeed(i)+"km/h",this.infoBtnDefault.active=void 0==e.key,this.pieceInfo.active=!0,this.makeCarInfo.active=!1,this.panelDefault.active=!0,this.panelSale.active=!1,this.panelDisassemble.active=!1,this.panelDissassembleResult.active=!1,this.panelMaking.active=!1,this.panelMakingResult.active=!1},onClick_OK:function(){Def.uiMain.ShowPopupPieceInfo(!1)},onClick_Cancel:function(){Def.uiMain.ShowPopupPieceInfo(!1)},onClick_ClosePanelSale:function(){this.panelDefault.active=!0,this.panelSale.active=!1},onClick_ClosePanelMaking:function(){this.pieceInfo.active=!0,this.panelDefault.active=!0,this.makeCarInfo.active=!1,this.panelMaking.active=!1},onClick_ClosePanelDisassemble:function(){this.pieceInfo.active=!0,this.panelDefault.active=!0,this.panelDisassemble.active=!1},ShowPieceSalePanel:function(e,t){this.popupTitle.string="Piece sale",this.saleQuantitySlider.progress=0,this.UpdateSliderBar(this.saleQuantitySlider.progress),this.saleTotalPrice.string="Sale\nTotal : 0.0000 EOS",this.panelDefault.active=!t,this.panelSale.active=t},ShowPieceDisassemblePanel:function(e,t){this.popupTitle.string="Piece disassemble",this.panelDefault.active=!t,this.panelDisassemble.active=t},onSliderHEvent:function(e,t){this.UpdateSliderBar(e.progress),this.UpdateTotalPrice()},UpdateSliderBar:function(e){var t=parseInt(e*this.maxQuantity);this.saleQuantityEditBox.string=String(t),this.regMarket_PieceQuantity=t},UpdateTotalPrice:function(){var e=this.regMarket_Price*this.regMarket_PieceQuantity;e=isNaN(e)?0:e,this.saleTotalPrice.string="Sale\nTotal : "+Util.MakeTokenSymbol(e)},checkMaxQuantity:function(e){this.saleQuantityEditBox.string=e=e>this.maxQuantity?this.maxQuantity:e,this.saleQuantitySlider.progress=parseFloat(e/this.maxQuantity),this.regMarket_PieceQuantity=e},onEditBox_EditingReturn:function(e){var t=Util.IsStringInteger(e.string)?Number(e.string):0;this.checkMaxQuantity(t),this.UpdateTotalPrice()},onEditChange_RegMarketPieceQuantity:function(e){var t=Util.IsStringInteger(e)?Number(e):0;this.checkMaxQuantity(t),this.UpdateTotalPrice()},onEditChange_RegMarketPrice:function(e){var t=Util.IsStringInteger(e)?Number(e):0;this.regMarket_Price=t,this.UpdateTotalPrice()},onClick_RegPieceMarket:function(){var e=Number(this.regMarket_Price*this.regMarket_PieceQuantity);Def.scatterMng.RegPieceMarket(this.pieceModel,this.regMarket_PieceQuantity,e)},ShowMakeCarPanel:function(e,t){self=this;var a=this.piece.model,i=Util.ParseCarModel_Grade(a),n=BCDGame.GetCarGradeInfo(i),o=Util.GetCarModelInfo(a),c=String(o.name);this.piece.count-this.piece.marketDeposit>=n.asmPiece&&(this.popupTitle.string="Vehicle making",this.makingLbName.string=c,this.makingLbSpeed.string=n.speed+"",this.makingLbLevel.string="1",Util.LoadTexture_Car(this.makingImgCar,a,Def.CarImageType_Side(),0,""),Util.LoadTexture_CarPiece(this.makingImgCarPiece,a),Util.SetGradeRes(i,this.makingPieceGradeBox),Util.PadName(this.makingPieceCarName,c,17),self.maxQuantity==Def.MaxPieceQuantity()?self.makingMaxQuantityBg.node.active=!0:(self.makingMaxQuantityBg.node.active=!1,self.makingQuantityDisableBg.node.active=n.asmPiece>self.maxQuantity),this.makingPieceQuantity.string=""+this.maxQuantity,this.makingInfo.string="X "+n.asmPiece,this.pieceInfo.active=!t,this.makeCarInfo.active=t,this.panelDefault.active=!t,this.panelSale.active=!t,this.panelDisassemble.active=!t,this.panelMaking.active=t,this.panelMakingResult.active=!t)},onClick_MakeCar:function(){var e=BCDUser.GetCarCount();BCDUser.GetCarSpaceCount()>e?Def.scatterMng.GenerateCar(this.pieceModel):Def.uiMain.ShowToastPopupMsg("toastmsg_check_make_garage_full")},ShowMakeCarResult:function(){self=this;var e=this.pieceModel,t=Util.GetCarModelInfo(e),a=Util.ParseCarModel_Grade(e);Util.LoadTexture_Car(this.makingResultImgCar,e,Def.CarImageType_Side(),0,""),Util.SetGradeRes(a,this.makingResultImgCarGrade),Util.SetGradeRes(a,this.makingResultImgTierBG),this.makingResultName.string=String(t.name),this.makingResultTier.string=LocalizeMng.GetText("txt_tier_")+a,this.makingResultInfo2.string="["+t.name+"]"+LocalizeMng.GetText("txt_create_car"),this.pieceInfo.active=!1,this.makeCarInfo.active=!0,this.panelDefault.active=!1,this.panelSale.active=!1,this.panelDisassemble.active=!1,this.panelMaking.active=!1,this.panelMakingResult.active=!0,this.timeOutEvent=setTimeout(function(){self.panelMakingResult.active=!1,self.onClick_Cancel(),this.timeOutEvent=null},1e4)},onClick_CloseMakingResult:function(){self.panelMakingResult.active=!1,self.onClick_Cancel(),this.timeOutEvent&&(clearTimeout(this.timeOutEvent),this.timeOutEvent=null)},onClick_DisassemlePiece:function(){this.piece.count<Def.PieceDisassembleConsumePiece()?Def.uiMain.ShowToastPopupMsg("toastmsg_check_insufficient_piece"):BCDUser.GetFuelCount()<Def.PieceDisassembleConsumeFuel()?Def.uiMain.ShowToastPopupMsg("toastmsg_check_insufficient_fuel"):Def.scatterMng.DisassemblePiece(this.pieceModel)},ShowDisassembleResult:function(e,t){self=this,this.panelDissassembleResult.active=!0;var a=BCDUser.GetFuelCount()-e,i=BCDUser.GetTrophyCount()-t;if(a==Def.PieceDisassembleConsumeFuel()&&0==i)this.disassembleResultImgFuel.active=!1,this.disassembleResultImgTrophy.active=!1,this.disassembleResultCount.string="No reponse";else{this.disassembleResultImgFuel.active=a>0,this.disassembleResultImgTrophy.active=i>0;var n=0;i>0?n=i:a>0&&(n=a),this.disassembleResultCount.string="x "+String(n)}this.timeOutEvent=setTimeout(function(){self.panelDissassembleResult.active=!1,this.timeOutEvent=null},1e4)},onClick_CloseDisassemblePieceResult:function(){this.panelDissassembleResult.active=!1,this.timeOutEvent&&(clearTimeout(this.timeOutEvent),this.timeOutEvent=null)},onClick_ViewEqualItemAll:function(){Def.uiMain.ViewEqualItemAll(Def.MarketItemType_Piece(),this.pieceModel)}});cc._RF.pop()},{}],UIPopupPurchasePiece:[function(e,t,a){"use strict";cc._RF.push(t,"8d824WQ2O5K3Jw/8jIPR0NX","UIPopupPurchasePiece");cc.Class({extends:cc.Component,properties:{svPiece:{default:null,type:cc.ScrollView},srcItemCar:{default:null,type:cc.Node},lbPrice:{default:null,type:cc.Label},tiAmount:{default:null,type:cc.EditBox}},modelSelected:null,UpdatePieceListToUI:function(e){for(var t=[],a=1;a<=Def.CarTierMax();a++)if(0==e||a==e)for(var i=BCDGame.GetCarGradeInfo(a),n=1;n<=i.maxModel;n++){var o=1e3*BCDGame.GetSeason()+100*a+n;t.push(o)}Util.AdjustScrollViewItems(this.svPiece.content,t.length,3,this.srcItemCar);for(a=0;a<t.length;a++){var c=t[a],r=this.svPiece.content.children[a].getComponent("UIItemCar"),l=Util.GetCarModelInfo(c);r.SetInfo(Def.CarItemType_PurchasePiece(),a,l,0),0==a&&(this.modelSelected=c,r.ShowSelBox(!0))}this.svPiece.scrollToTop(0,!1),this.UpdatePriceToUI()},UpdateSelectedPiece:function(e){this.modelSelected=e;for(var t=0;t<this.svPiece.content.children.length;t++){var a=this.svPiece.content.children[t].getComponent("UIItemCar"),i=a.GetModel()==e;a.ShowSelBox(i)}this.UpdatePriceToUI()},UpdatePriceToUI:function(){if(void 0==this.modelSelected)this.lbPrice.string="";else{var e=Util.ParseCarModel_Grade(this.modelSelected),t=BCDGame.GetCarGradeInfo(e),a=Number(this.tiAmount.string);this.lbPrice.string=Util.MakeTokenSymbol(t.piecePrice*a/1e4)}},onClick_Tab:function(e,t){this.UpdatePieceListToUI(t)},onClick_OK:function(){var e=Number(this.tiAmount.string),t=Util.ParseCarModel_Grade(this.modelSelected),a=BCDGame.GetCarGradeInfo(t).piecePrice*e/1e4;Def.scatterMng.PurchasePiece(this.modelSelected,e,a)},onClick_Cancel:function(){this.node.active=!1}});cc._RF.pop()},{}],UIPopupRaceResult1:[function(e,t,a){"use strict";cc._RF.push(t,"57412MYBpBHvrDfxksUzt3w","UIPopupRaceResult1");cc.Class({extends:cc.Component,properties:{imgWin:{default:null,type:cc.Node},imgLose:{default:null,type:cc.Node},nodeReplayFinish:{default:null,type:cc.Node},btnGotoHome:{default:null,type:cc.Node},nodeDesc:{default:null,type:cc.Node},lbTimeCur:{default:null,type:cc.Label},lbTimeDiff:{default:null,type:cc.Label},carImg:{default:null,type:cc.Sprite}},start:function(){},SetInfo:function(e,t,a){var i=!1;if(e==Def.RaceType_Replay())this.nodeReplayFinish.active=!0,this.btnGotoHome.active=!0,this.nodeDesc.active=!1,this.carImg.node.active=!1,this.lbTimeCur.string=Util.FormatTime(t),this.lbTimeDiff.node.active=!1;else if(this.nodeReplayFinish.active=!1,this.btnGotoHome.active=!1,this.nodeDesc.active=!Def.gameMng.GetPracticeRace(),e==Def.RaceType_Match())i=!0,this.carImg.node.active=!1;else if(e==Def.RaceType_Event()){this.imgWin.active=!1,this.imgLose.active=!1,this.carImg.node.active=!0;var n=BCDUser.GetRaceCar();Util.LoadTexture_Car(this.carImg,n.model,Def.CarImageType_Side(),n.color,"")}var o=t-a,c=o<0;if(this.imgWin.active=i,this.imgLose.active=i,i){this.imgWin.active=c,this.imgLose.active=!c;var r=this.imgWin.getComponent(cc.Animation);void 0!=r&&r.play();var l=this.imgLose.getComponent(cc.Animation);void 0!=l&&l.play()}this.lbTimeCur.string=Util.FormatTime(t),a>0?(this.lbTimeDiff.string=Util.FormatTimeDiff(o),this.lbTimeDiff.node.active=!0,this.lbTimeDiff.node.color=c?new cc.Color(96,255,96,255):new cc.Color(255,96,96,255)):this.lbTimeDiff.node.active=!1},onClick_GotoHome:function(){cc.sys.openURL(Def.HomeURL())}});cc._RF.pop()},{}],UIPopupRaceResult2:[function(e,t,a){"use strict";cc._RF.push(t,"2b6793pETpMlb1t8gZlylUP","UIPopupRaceResult2");cc.Class({extends:cc.Component,properties:{panelMatch:{default:null,type:cc.Node},lbTitle:{default:null,type:cc.Label},panelPiece:{default:null,type:cc.Node},imgPieceGradeBox:{default:[],type:cc.Sprite},imgPiece:{default:null,type:cc.Sprite},lbPieceName:{default:null,type:cc.Label},imgFuel:{default:null,type:cc.Node},lbReward:{default:null,type:cc.Label},lbRewardFuel:{default:null,type:cc.Label},imgFuelBox:{default:null,type:cc.Sprite},imgCarTierBox:{default:[],type:cc.Sprite},lbCarName:{default:null,type:cc.Label},lbCarTier:{default:null,type:cc.Label},panelEvent:{default:null,type:cc.Node},lbTime:{default:null,type:cc.Label},lbRanking:{default:null,type:cc.Label},carImg:{default:null,type:cc.Sprite}},SetInfo_Ready:function(){this.panelMatch.active=!1,this.panelEvent.active=!1},SetInfo_Match:function(){this.panelMatch.active=!0,this.panelEvent.active=!1;for(var e=BCDUser.GetSavedPieceInfos(),t=0,a=0,i=0;i<BCDUser.GetPieceCount();i++){var n=BCDUser.GetPieceInfo(i),o=e.get(n.model);if(void 0==o){t=n.model,a=n.count;break}if(n.count!=o.count){t=n.model,a=n.count-o.count;break}}BCDUser.GetSelectedCarInfo();var c=BCDUser.GetFuelCount()-BCDUser.GetSavedFuelCount();if(NaN!=c&&void 0!=c||(c=0),this.panelPiece.active=0!=t,this.imgFuel.active=0!=c,this.lbReward.node.active=0!=t,this.lbRewardFuel.node.active=0!=c,this.lbCarName.node.active=0!=t,this.lbCarTier.node.active=0!=t,this.imgFuelBox.node.active=0!=c,0!=t){var r=Util.GetCarModelInfo(t),l=Util.ParseCarModel_Grade(t),s=String(r.name);this.lbTitle.string=LocalizeMng.GetText("txt_match_reward_piece"),Util.LoadTexture_CarPiece(this.imgPiece,t),Util.SetGradeRes(l,this.imgPieceGradeBox),Util.PadName(this.lbPieceName,s,17),Util.SetGradeRes(l,this.imgCarTierBox),this.lbCarName.string=String(r.name),this.lbCarTier.string=LocalizeMng.GetText("txt_tier_")+l,this.lbReward.string="+"+a}else 0!=c?(Util.SetGradeRes(-1,this.imgCarTierBox),this.lbTitle.string=LocalizeMng.GetText("txt_match_reward_fuel"),this.lbRewardFuel.string="+"+c):this.node.active=!1},SetInfo_Event:function(){this.panelMatch.active=!1,this.panelEvent.active=!0;for(var e=BCDUser.GetCurEventID(),t=BCDEvent.GetDataById(e),a=BCDUser.GetCurEventRaceRecord(),i=t.rankings.length+1,n=0;n<t.rankings.length;n++){if(a<t.rankings[n].value.timeFinal){i=n+1;break}}this.lbTime.string=Util.FormatTime(.001*a),this.lbRanking.string=String(i);var o=BCDUser.GetRaceCar();Util.LoadTexture_Car(this.carImg,o.model,Def.CarImageType_Side(),o.color,"")},onClick:function(){this.node.active=!1}});cc._RF.pop()},{}],UIPopupResource:[function(e,t,a){"use strict";cc._RF.push(t,"26eb1/6ed1EmZq2olUcL1uA","UIPopupResource");cc.Class({extends:cc.Component,properties:{progressCPU:{default:null,type:cc.ProgressBar},progressNET:{default:null,type:cc.ProgressBar},lbCPUUsage:{default:null,type:cc.Label},lbNETUsage:{default:null,type:cc.Label},lbCPUBalance:{default:null,type:cc.Label},lbNETBalance:{default:null,type:cc.Label},lbFullBalance:{default:null,type:cc.Label},progressUnstaked:{default:null,type:cc.ProgressBar},progressStaked:{default:null,type:cc.ProgressBar},progressRefunding:{default:null,type:cc.ProgressBar},lbUnstakedBalance:{default:null,type:cc.Label},lbStakedBalance:{default:null,type:cc.Label},lbRefundingBalance:{default:null,type:cc.Label}},UpdateDataToUI:function(){if(null!=BCDAccount.data&&void 0!=BCDAccount.data){var e=BCDAccount.data.cpu_limit,t=BCDAccount.data.net_limit;this.lbCPUUsage.string=(.001*e.used).toFixed(2)+" / "+(.001*e.max).toFixed(2)+" ms",this.lbNETUsage.string=(.001*t.used).toFixed(2)+" / "+(.001*t.max).toFixed(2)+" kb",this.progressCPU.progress=e.used/e.max,this.progressNET.progress=t.used/t.max;var a=BCDAccount.data.cpu_weight/1e4,i=BCDAccount.data.net_weight/1e4,n=Util.ParseTokenSymbol(BCDAccount.balance),o=0;null!=BCDAccount.data.refund_request&&(o=Util.ParseTokenSymbol(BCDAccount.data.refund_request.cpu_amount)+Util.ParseTokenSymbol(BCDAccount.data.refund_request.net_amount));var c=n+a+i+o,r=a+i;this.lbCPUBalance.string=Util.MakeTokenSymbol(a),this.lbNETBalance.string=Util.MakeTokenSymbol(i),this.lbFullBalance.string=Util.MakeTokenSymbol(c),this.progressUnstaked.progress=n/c,this.progressStaked.progress=r/c,this.progressRefunding.progress=o/c,this.lbUnstakedBalance.string=Util.MakeTokenSymbol(n),this.lbStakedBalance.string=Util.MakeTokenSymbol(r),this.lbRefundingBalance.string=Util.MakeTokenSymbol(o)}},update:function(e){},onClick_Close:function(){this.node.active=!1}});cc._RF.pop()},{}],UIPopupRewardResult:[function(e,t,a){"use strict";cc._RF.push(t,"c0c4cvnTgxIJaN3o+9zCg5f","UIPopupRewardResult");cc.Class({extends:cc.Component,properties:{imgTypes:{default:[],type:cc.Node},imgTiers:{default:[],type:cc.Node},lbTitle:{default:null,type:cc.Label},lbAmount:{default:null,type:cc.Label},lbDesc:{default:null,type:cc.Label}},SetInfo:function(e){for(var t=0;t<this.imgTypes.length;t++)this.imgTypes[t].active=t==e.type;this.lbTitle.string=e.title;var a=0,i="",n="";if(e.type==Def.RewardType_Token())n="",i=Util.FormatEventPrize(e.type,e.amount),a=4;else if(e.type==Def.RewardType_Piece()){var o=Util.GetCarModelInfo(e.model),c=this.imgTypes[e.type].getComponent(cc.Sprite);Util.LoadTexture_CarPiece(c,e.model),n="+"+e.amount,i=o.name,a=Util.ParseCarModel_Grade(e.model)-1}else if(e.type==Def.RewardType_Fuel())n="+"+e.amount,i="Fuel",a=0;else if(e.type==Def.RewardType_Car()){o=Util.GetCarModelInfo(e.model),c=this.imgTypes[e.type].getComponent(cc.Sprite);Util.LoadTexture_Car(c,e.model,Def.CarImageType_Side(),0,Def.CarImageShape_Normal()),n="",i=o.name,a=Util.ParseCarModel_Grade(e.model)-1}for(t=0;t<this.imgTiers.length;t++)this.imgTiers[t].active=t==a;this.lbAmount.string=n,this.lbDesc.string=i},onClick:function(){this.node.active=!1}});cc._RF.pop()},{}],UIPopupReward:[function(e,t,a){"use strict";cc._RF.push(t,"29210Q401xKwpdvx/jgz/+f","UIPopupReward");cc.Class({extends:cc.Component,properties:{panelRewardList:{default:null,type:cc.Node},srcItemEvent:{default:null,type:cc.Node}},UpdateRewardsToUI:function(){var e=this.panelRewardList.getComponent(cc.ScrollView),t=(e.content,BCDUser.GetRewardCount());Util.AdjustScrollViewItems(e.content,t,1,this.srcItemEvent);for(var a=0;a<t;a++){var i=e.content.children[a].getComponent("UIItemReward"),n=BCDUser.GetRewardInfo(a);i.SetInfo(a,n)}},onClick_Refresh:function(){},onClick_Cancel:function(){this.node.active=!1}});cc._RF.pop()},{}],UIPopupTradeFuel:[function(e,t,a){"use strict";cc._RF.push(t,"d4490WiDv1NYa8EFsywmYXH","UIPopupTradeFuel");cc.Class({extends:cc.Component,properties:{popupTitle:{default:null,type:cc.Label},panelFuelInfo:{default:null,type:cc.Node},infoQuantity:{default:null,type:cc.Label},panelBuy:{default:null,type:cc.Node},buyQuantity:{default:null,type:cc.Label},buyUnitPrice:{default:null,type:cc.Label},buyTotalPrice:{default:null,type:cc.Label},buySeller:{default:null,type:cc.Label},panelSale:{default:null,type:cc.Node},saleInfo:{default:null,type:cc.Label},saleQuantitySlider:{default:null,type:cc.Slider},saleQuantityEditBox:{default:null,type:cc.EditBox},saleMaxQuantityLabel:{default:null,type:cc.Label},salePriceEditBox:{default:null,type:cc.EditBox},saleTotalPrice:{default:null,type:cc.Label}},fuel:null,maxQuantity:null,regMarket_FuelQuantity:null,regMarket_FuelUnitPrice:null,regMarket_FuelTotalPrice:null,start:function(){},onClick_Cancel:function(){Def.uiMain.ShowPopupSaleFuel(!1)},ShowFuelBuyPanel:function(e){this.fuel=e,this.popupTitle.string=LocalizeMng.GetText("txt_buy_fuel");var t=Util.ParseTokenSymbol(e.price);this.buyQuantity.string=LocalizeMng.GetText("txt_amount")+" : "+e.count,this.buyUnitPrice.string="("+LocalizeMng.GetText("txt_unit_price")+" : "+parseFloat(t/e.count).toFixed(4)+" EOS)",this.buyTotalPrice.string=LocalizeMng.GetText("txt_price")+" : "+e.price,this.buySeller.string=LocalizeMng.GetText("txt_seller_info")+"\n"+e.account,this.panelBuy.active=!0,this.panelSale.active=!1},onClick_BuyFuel:function(){this.fuel.account!=BCDAccount.Name()&&Def.scatterMng.BuyFuelFromMarket(this.fuel.owner,this.fuel.key,this.fuel.price)},ShowFuelSalePanel:function(){var e=BCDUser.GetFuelCount();this.popupTitle.string=LocalizeMng.GetText("txt_fuel_sale"),this.maxQuantity=Number(e),this.infoQuantity.string="X "+e,this.saleMaxQuantityLabel.string="/ "+this.maxQuantity,this.saleQuantitySlider.progress=0,this.UpdateSliderBar(this.saleQuantitySlider.progress),this.saleTotalPrice.string=LocalizeMng.GetText("txt_initial_total_sale_price"),this.panelBuy.active=!1,this.panelSale.active=!0},onSliderHEvent:function(e,t){this.UpdateSliderBar(e.progress),this.UpdateTotalPrice()},UpdateSliderBar:function(e){var t=parseInt(e*this.maxQuantity);this.saleQuantityEditBox.string=String(t),this.regMarket_FuelQuantity=t},UpdateTotalPrice:function(){var e=this.regMarket_FuelUnitPrice*this.regMarket_FuelQuantity;e=isNaN(e)?0:e,this.regMarket_FuelTotalPrice=e,this.saleTotalPrice.string=LocalizeMng.GetText("txt_total_sale_price")+Util.MakeTokenSymbol(this.regMarket_FuelTotalPrice)},checkMaxQuantity:function(e){this.saleQuantityEditBox.string=e=e>this.maxQuantity?this.maxQuantity:e,this.saleQuantitySlider.progress=parseFloat(e/this.maxQuantity),this.regMarket_FuelQuantity=e},onEditBox_EditingReturn:function(e){var t=Util.IsStringInteger(e.string)?Number(e.string):0;this.checkMaxQuantity(t),this.UpdateTotalPrice()},onEditChange_RegMarketPieceQuantity:function(e){var t=Util.IsStringInteger(e)?Number(e):0;this.checkMaxQuantity(t),this.UpdateTotalPrice()},onEditChange_RegMarketPrice:function(e){var t=Util.IsStringInteger(e)?Number(e):0;this.regMarket_FuelUnitPrice=t,this.UpdateTotalPrice()},onClick_RegFuelMarket:function(){var e=Number(this.regMarket_FuelTotalPrice);Def.scatterMng.RegFuelToMarket(this.regMarket_FuelQuantity,e)}});cc._RF.pop()},{}],UIRace:[function(e,t,a){"use strict";cc._RF.push(t,"99ae99gMetNubrXsLaWZyD2","UIRace");cc.Class({extends:cc.Component,properties:{myCarNode:{default:null,type:cc.Node},mngNode:{default:null,type:cc.Node},btnMoveLeft:{default:null,type:cc.Node},btnMoveRight:{default:null,type:cc.Node},labelSpeed:{default:null,type:cc.Label},labelTime:{default:null,type:cc.Label},labelDist:{default:null,type:cc.Label},symbolDist:{default:null,type:cc.Node},symbolDistRival:{default:null,type:cc.Node},popupRaceResult:{default:null,type:cc.Node},imgDiffIndicator:{default:null,type:cc.Node},lbDiffDist:{default:null,type:cc.Label},imgStandby:{default:null,type:cc.Node},imgRPMNode:{default:null,type:cc.Node},panelReplay:{default:null,type:cc.Node},btnExit:{default:null,type:cc.Node},toastPopupMsg:{default:null,type:cc.Node},nodeCtrlBtns:{default:[],type:cc.Node}},myCar:null,raceMng:null,rpmGauges:null,onLoad:function(){Def.uiRace=this,cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP,this.onKeyUp,this),this.btnMoveLeft.on(cc.Node.EventType.TOUCH_START,this.moveMyCarLeft,this),this.btnMoveRight.on(cc.Node.EventType.TOUCH_START,this.moveMyCarRight,this),this.btnMoveLeft.on(cc.Node.EventType.TOUCH_END,this.moveMyCarStop,this),this.btnMoveRight.on(cc.Node.EventType.TOUCH_END,this.moveMyCarStop,this),this.btnMoveLeft.on(cc.Node.EventType.TOUCH_CANCEL,this.moveMyCarStop,this),this.btnMoveRight.on(cc.Node.EventType.TOUCH_CANCEL,this.moveMyCarStop,this)},start:function(){this.myCar=this.myCarNode.getComponent("MyCar"),this.raceMng=this.mngNode.getComponent("RaceMng"),this.popupRaceResult.position=cc.Vec2.ZERO,this.popupRaceResult.active=!1,this.rpmGauges=this.imgRPMNode.children,this.panelReplay.active=!1,this.btnExit.active=!1,this.toastPopupMsg.position=cc.Vec2.ZERO,this.toastPopupMsg.active=!1},update:function(e){this.labelSpeed.string=Math.floor(this.myCar.SpeedCur());for(var t=this.myCar.RPMRatio(),a=0;a<this.rpmGauges.length;a++)this.rpmGauges[a].active=t>a/this.rpmGauges.length;this.labelTime.string=Util.FormatTime(this.raceMng.RaceTimeCur());var i=this.raceMng.RaceDist(),n=this.raceMng.RaceDistCur(),o=.001*(i-n);this.labelDist.string=o.toFixed(3);var c=this.symbolDist.parent.height,r=n/i;r>1&&(r=1),this.symbolDist.y=r*c},onKeyDown:function(e){switch(e.keyCode){case cc.macro.KEY.left:this.myCar.SetSteer(-1);break;case cc.macro.KEY.right:this.myCar.SetSteer(1)}},onKeyUp:function(e){switch(e.keyCode){case cc.macro.KEY.left:case cc.macro.KEY.right:this.myCar.SetSteer(0)}},moveMyCarLeft:function(){this.myCar.SetSteer(-1)},moveMyCarRight:function(){this.myCar.SetSteer(1)},moveMyCarStop:function(){this.myCar.SetSteer(0)},ShowDistDiffIndicator:function(e){this.imgDiffIndicator.active=e,this.symbolDistRival.active=e},SetDistDiffIndicator:function(e){var t=1-this.myCar.SpeedMax()/150*.07,a=e;e<-5?a=-(5+Math.pow(Math.abs(e+5),.55*t)):e>2&&(a=2+Math.pow(e-2,.37*t));var i=-(a*Def.MeterToPixel()*.7+.197*Def.CanvasHeight()),n=.49*Def.CanvasHeight();i<-n?i=-n:i>n&&(i=n),this.imgDiffIndicator.y=i;var o=.5-i/Def.CanvasHeight(),c=Util.Lerp(1/Def.RoadRatioTopBottom(),1,o);this.imgDiffIndicator.scale=c,this.lbDiffDist.string=Math.floor(e)+"m";var r=this.symbolDistRival.parent.height,l=(this.raceMng.RaceDistCur()-e)/this.raceMng.RaceDist();l>1&&(l=1),this.symbolDistRival.y=l*r},ShowRaceStandby:function(e){if(this.imgStandby.active=e,e){var t=this.imgStandby.getComponent(cc.Animation);t.setCurrentTime(0),t.play()}},ShowRaceResult:function(e,t,a,i){(this.popupRaceResult.active=e,e)&&this.popupRaceResult.getComponent("UIPopupRaceResult1").SetInfo(t,a,i)},ShowReplayPanel:function(e){this.panelReplay.active=e},ShowExitBtn:function(e){this.btnExit.active=e},ShowToastPopupMsg:function(e){this.toastPopupMsg.getComponent("UIToastPopupMsg").OuputMsg(e,5)},HideAllCtrlBtns:function(){for(var e=0;e<this.nodeCtrlBtns.length;e++)this.nodeCtrlBtns[e].active=!1},onClick_ReportRace:function(){Def.raceMng.ReportRace()},onClick_ExitRace:function(){this.raceMng.EndRace(!1)},onClick_CopyURL:function(){var e=Def.ReplayURL()+"?"+Def.ReplayServerKeyHead()+"?"+this.raceMng.GetReplayUser()+"?"+this.raceMng.GetReplayRaceID(),t=document.createElement("textarea");t.value=e,document.body.appendChild(t),t.select(),t.setSelectionRange(0,9999),document.execCommand("copy"),document.body.removeChild(t)}});cc._RF.pop()},{}],UIStore:[function(e,t,a){"use strict";cc._RF.push(t,"e5d44UgR95My73fLK4lS+tT","UIStore");cc.Class({extends:cc.Component,properties:{lbPrices:{default:[],type:cc.Label}},UpdateQuotationsToUI:function(){for(var e=[1e13,1e13,1e13,1e13,1e13],t=0;t<BCDMarket.GetPieceCount();t++){var a=BCDMarket.GetPieceInfo(t),i=Util.ParseTokenSymbol(a.price),n=Util.ParseCarModel_Grade(a.model);i<e[n]&&(e[n]=i)}for(t=1;t<this.lbPrices.length;t++)e[t]>1e4&&(e[t]=0),this.lbPrices[t].string=Util.MakeTokenSymbol(e[t])}});cc._RF.pop()},{}],UIToastPopupMsg:[function(e,t,a){"use strict";cc._RF.push(t,"1dbffcoQYFIabrNHEyIVSlQ","UIToastPopupMsg");cc.Class({extends:cc.Component,properties:{oneLineToast:{default:null,type:cc.Node},oneLineMsg1:{default:null,type:cc.Label}},toastTimer:null,start:function(){},OuputMsg:function(e,t){var a=this;null!=this.toastTimer&&clearTimeout(this.toastTimer),this.oneLineMsg1.string=LocalizeMng.GetText(e),this.oneLineToast.active=!0;var i=void 0==t?1500:Math.floor(1e3*t);i<1500?i=1500:i>1e4&&(i=1e4),this.toastTimer=setTimeout(function(){a.oneLineToast.active=!1,a.toastTimer=null},i)}});cc._RF.pop()},{}],WindEffect:[function(e,t,a){"use strict";cc._RF.push(t,"2d9cbG+kedG64ssWZ0ZFXa7","WindEffect");cc.Class({extends:cc.Component,offsetX:null,ctor:function(){this.offsetX=0}});cc._RF.pop()},{}]},{},["BtnExpand","BtnHold","Car","CarMng","GameMng","MyCar","RaceMng","ReplayMng","ReplayRaceStarter","RoadMng","ScatterMng","SideObject","SoundMng","UICarAsset","UIEvent","UIGarage","UIInfo","UIItemCar","UIItemCarLarge","UIItemEvent","UIItemFuel","UIItemPiece","UIItemRace","UIItemReward","UIItemStore","UILogin","UIMain","UIMarket","UIMatch","UIMyCarList","UIOnSaleAsset","UIPopupAwardingRecord","UIPopupCar","UIPopupCarSelect","UIPopupEventInfo","UIPopupEventRaceReady","UIPopupExpandGarage","UIPopupFilterSort","UIPopupMarketCarInfo","UIPopupMenu","UIPopupNews","UIPopupPiece","UIPopupPurchasePiece","UIPopupRaceResult1","UIPopupRaceResult2","UIPopupResource","UIPopupReward","UIPopupRewardResult","UIPopupTradeFuel","UIRace","UIStore","UIToastPopupMsg","WindEffect"]);